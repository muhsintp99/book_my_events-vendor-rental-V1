import{r as i,j as e,B as l,T as a,t as S,a8 as E,S as f,ae as R,D as _,g as h,h as g}from"./index-ChH2LEDA.js";const I=()=>{try{const n=localStorage.getItem("user");if(!n)return null;const o=JSON.parse(n);return(o==null?void 0:o._id)||null}catch(n){return console.error("Error parsing user:",n),null}},T=n=>n?typeof n=="string"?n:Array.isArray(n)?n.map(o=>typeof o=="object"?o.label||o.time:o).join(", "):typeof n=="object"&&(n.label||n.time)||"N/A":"N/A",A=()=>{const[n,o]=i.useState([]),[j,m]=i.useState(!0),[y,b]=i.useState(null),[p,k]=i.useState(null);i.useEffect(()=>{k(I())},[]),i.useEffect(()=>{if(!p)return;(async()=>{var t;try{const B=(((t=(await g.get(`https://api.bookmyevent.ae/api/bookings/provider/${p}`)).data)==null?void 0:t.data)||[]).filter(u=>{const w=String(u.status||"").toLowerCase(),x=String(u.moduleType||"").toLowerCase();return w==="pending"&&(x==="ornament"||x==="ornaments")});o(B)}catch(s){console.error("Error fetching pending bookings:",s)}finally{m(!1)}})()},[p]);const v=r=>{b(t=>t===r?null:r)},C=async(r,t)=>{t.stopPropagation();try{await g.patch(`https://api.bookmyevent.ae/api/bookings/${r}/accept`),o(s=>s.filter(d=>d._id!==r)),alert("Booking Confirmed ✔️")}catch(s){console.error("Confirm error:",s),alert("Failed to confirm booking")}},P=async(r,t)=>{t.stopPropagation();try{await g.patch(`https://api.bookmyevent.ae/api/bookings/${r}/reject`),o(s=>s.filter(d=>d._id!==r)),alert("Booking Rejected ❌")}catch(s){console.error("Reject error:",s),alert("Failed to reject booking")}};return e.jsx(l,{p:2,sx:{background:"#f4f7fb",minHeight:"100vh"},children:e.jsxs(l,{sx:{maxWidth:"850px",margin:"0 auto"},children:[e.jsx(a,{variant:"h4",fontWeight:600,mb:3,children:"Pending Bookings"}),j?e.jsx(l,{display:"flex",justifyContent:"center",mt:4,children:e.jsx(S,{})}):n.length===0?e.jsx(a,{children:"No Pending Bookings Found"}):n.map(r=>e.jsxs(E,{elevation:2,sx:{p:2.5,mt:2,borderRadius:"16px",cursor:"pointer",transition:"0.2s",background:"#fff","&:hover":{boxShadow:"0px 4px 20px rgba(0,0,0,0.08)",transform:"translateY(-2px)"}},onClick:()=>v(r._id),children:[e.jsxs(f,{direction:"row",justifyContent:"space-between",alignItems:"center",children:[e.jsxs(l,{children:[e.jsxs(a,{fontWeight:700,fontSize:16,children:["Booking ID:"," ",e.jsxs("span",{style:{color:"#1976d2"},children:["#",r._id.slice(-6)]})]}),e.jsx(a,{color:"gray",fontSize:14,children:r.moduleType||"Event Booking"}),e.jsx(a,{color:"gray",fontSize:13,children:T(r.timeSlot)})]}),e.jsxs(a,{fontWeight:700,sx:{color:"#16a34a"},children:["₹",r.finalPrice]})]}),e.jsxs(R,{in:y===r._id,children:[e.jsx(_,{sx:{my:2}}),e.jsxs(l,{sx:{background:"#f9fafb",p:2,borderRadius:"12px",border:"1px solid #e5e7eb"},children:[e.jsx(c,{label:"Customer",value:r.fullName}),e.jsx(c,{label:"Guests",value:r.numberOfGuests}),e.jsx(c,{label:"Email",value:r.emailAddress}),e.jsx(c,{label:"Phone",value:r.contactNumber}),e.jsx(c,{label:"Booking Type",value:r.bookingType})]}),e.jsxs(f,{direction:"row",spacing:2,mt:2,justifyContent:"center",children:[e.jsx(h,{variant:"outlined",sx:{width:"130px",borderRadius:"30px",color:"#e11d48",borderColor:"#e11d48","&:hover":{background:"#ffe4e6"}},onClick:t=>P(r._id,t),children:"Reject"}),e.jsx(h,{variant:"contained",sx:{width:"130px",borderRadius:"30px",bgcolor:"#16a34a","&:hover":{bgcolor:"#15803d"}},onClick:t=>C(r._id,t),children:"Confirm"})]})]})]},r._id))]})})},c=({label:n,value:o})=>e.jsxs(a,{fontSize:14,sx:{mb:.5},children:[e.jsxs("strong",{children:[n,":"]})," ",o]});export{A as default};
