import{u as or,i as lr,aj as dr,w as cr,ai as ur,r as s,h as N,j as e,B as n,b as Oe,ak as hr,T as i,t as Wa,p as H,W as ee,s as x,am as gr,S as U,F as f,I as w,ag as k,$ as l,at as le,f as y,an as F,C as de,al as pr,g as ce,ao as xr,x as fr}from"./index-NmwXB4G_.js";import{D as mr}from"./DirectionsCar-DOH2_CnB.js";import{C as Ot}from"./CloudUpload-BGucVEUU.js";const Ut=gr(n)(({theme:h})=>({border:"2px dashed #e0e0e0",borderRadius:h.shape.borderRadius,padding:h.spacing(3),textAlign:"center",backgroundColor:h.palette.grey[50],cursor:"pointer",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:"150px","&:hover":{borderColor:h.palette.primary.main},'& input[type="file"]':{display:"none"}})),Br=()=>{const h=or(),I=lr(h.breakpoints.down("md")),te=dr(),Ue=cr(),{id:ue}=ur(),Ze=s.useRef(null),A=s.useRef(null),qe=s.useRef(null),[Ce,Ge]=s.useState(""),[Se,Zt]=s.useState(""),[Je,qt]=s.useState(""),[Ye,Gt]=s.useState(""),[Xe,Jt]=s.useState(""),[Qe,Yt]=s.useState(""),[we,et]=s.useState("normal"),[he,tt]=s.useState(""),[at,Xt]=s.useState("no"),[Ba,Fa]=s.useState("no"),[Qt,za]=s.useState(""),[ke,ea]=s.useState(""),[rt,ta]=s.useState(""),[st,aa]=s.useState(""),[nt,ra]=s.useState(""),[it,sa]=s.useState(""),[ot,na]=s.useState(""),[lt,ia]=s.useState(""),[dt,oa]=s.useState(""),[v,la]=s.useState({leatherSeats:!1,adjustableSeats:!1,armrest:!1,musicSystem:!1,bluetooth:!1,usbAux:!1,airbags:!1,abs:!1,rearCamera:!1,parkingSensors:!1,powerWindows:!1,centralLock:!1,keylessEntry:!1,wifi:!1,chargingPoints:!1}),[W,da]=s.useState({curtains:!1,readingLights:!1,musicSystem:!1,microphone:!1,fireExtinguisher:!1,firstAidKit:!1,luggageCarrier:!1,wifi:!1,chargingPoints:!1}),T="https://api.bookmyevent.ae/api",ct="AIzaSyAfLUm1kPmeMkHh1Hr5nbgNpQJOsNa7B78",ae=localStorage.getItem("moduleId");s.useMemo(()=>{var t;return(t=te.state)==null?void 0:t.vehicle},[te.state]);const ca=s.useMemo(()=>{var t,a;return(a=(t=te.state)==null?void 0:t.vehicle)==null?void 0:a._id},[te.state]),ge=s.useMemo(()=>{var t,a;return ue||((a=(t=te.state)==null?void 0:t.vehicle)==null?void 0:a._id)||""},[ue,ca]),La=s.useMemo(()=>ge?"edit":"create",[ge]),[pe,ut]=s.useState(La),[Ae,ht]=s.useState(""),[ua,gt]=s.useState(""),[X,pt]=s.useState(null),[Z,Pe]=s.useState([]),[Te,xt]=s.useState(""),[Ee,ft]=s.useState(""),[Ra,ha]=s.useState(""),[Ie,mt]=s.useState(""),[xe,bt]=s.useState(""),[We,jt]=s.useState(""),[fe,me]=s.useState("yes"),[be,yt]=s.useState(""),[ga,vt]=s.useState(""),[_,pa]=s.useState("hourly"),[Ct,xa]=s.useState(""),[St,fa]=s.useState(""),[wt,ma]=s.useState(""),[Be,kt]=s.useState(""),[z,je]=s.useState({driverIncluded:!1,sunroof:!1,decorationAvailable:!1}),[re,At]=s.useState(""),[L,q]=s.useState([{heading:"",points:[""]}]),[Pt,Fe]=s.useState([]),[ze,Tt]=s.useState(""),[Da,m]=s.useState(!1),[Ma,C]=s.useState(""),[ba,S]=s.useState("success"),[Et,It]=s.useState([]),[Wt,ja]=s.useState([]),[_a,$a]=s.useState([]),[Bt,Va]=s.useState({}),[br,jr]=s.useState(""),[yr,vr]=s.useState(""),[Cr,Sr]=s.useState(""),[wr,kr]=s.useState(""),[Ar,Pr]=s.useState(""),[Ft,Na]=s.useState(""),[Tr,Ha]=s.useState({}),[ya,zt]=s.useState([]),[$,Lt]=s.useState([]),[Ka,Q]=s.useState([]),[E,Le]=s.useState(""),[Re,ye]=s.useState(""),Rt=!!E,[se,Dt]=s.useState([]),[Mt,va]=s.useState(!1),[De,B]=s.useState(!1),[Me,_t]=s.useState(""),[ve,$t]=s.useState([]),[_e,ne]=s.useState(""),[R,ie]=s.useState(""),[D,oe]=s.useState(""),[$e,Vt]=s.useState(""),[K,Ca]=s.useState(!1),[b,Sa]=s.useState(null),O=s.useMemo(()=>{var a;if(!E||!$.length)return!1;const t=$.find(o=>o._id===E);return console.log("Category check (Bus):",t==null?void 0:t.title),(a=t==null?void 0:t.title)==null?void 0:a.toLowerCase().includes("bus")},[E,$]),Ve=s.useMemo(()=>{var a,o;if(!E||!$.length)return!1;const t=$.find(r=>r._id===E);return console.log("Category check (Car):",t==null?void 0:t.title),((a=t==null?void 0:t.title)==null?void 0:a.toLowerCase().includes("car"))||((o=t==null?void 0:t.title)==null?void 0:o.toLowerCase().includes("vehicle"))},[E,$]),Oa=t=>{const a=Array.from(t.target.files);zt(o=>[...o,...a])},Ua=t=>{t.preventDefault();const a=Array.from(t.dataTransfer.files);zt(o=>[...o,...a])};s.useEffect(()=>{if(window.google&&window.google.maps){Ca(!0);return}const t=document.createElement("script");return t.src=`https://maps.googleapis.com/maps/api/js?key=${ct}&libraries=places`,t.async=!0,t.defer=!0,t.onload=()=>{Ca(!0)},document.head.appendChild(t),()=>{document.head.contains(t)&&document.head.removeChild(t)}},[ct]),s.useEffect(()=>{K&&window.google&&window.google.maps&&Za()},[K]);const Za=s.useCallback(()=>{if(!window.google||!Ze.current||!K)return;const t=R&&D?parseFloat(R):20.5937,a=R&&D?parseFloat(D):78.9629,o={lat:t,lng:a},r=new window.google.maps.Map(Ze.current,{zoom:12,center:o});r.addListener("click",d=>{const p=d.latLng.lat(),c=d.latLng.lng();ie(p.toString()),oe(c.toString()),A.current&&A.current.setMap(null),A.current=new window.google.maps.Marker({position:{lat:p,lng:c},map:r}),new window.google.maps.Geocoder().geocode({location:{lat:p,lng:c}},(M,V)=>{V==="OK"&&M[0]?(ne(M[0].formatted_address),C("Location set and address auto-filled!"),S("success"),m(!0)):(C("Location set, but could not determine address."),S("info"),m(!0))})}),Sa(r)},[K,R,D]);s.useEffect(()=>{if(!K||!b||!qe.current||!window.google)return;const t=new window.google.maps.places.Autocomplete(qe.current,{fields:["place_id","geometry","name","formatted_address"]}),a=t.addListener("place_changed",()=>{const o=t.getPlace();if(!o.geometry||!o.geometry.location)return;const r=o.geometry.location;o.geometry.viewport?b.fitBounds(o.geometry.viewport):(b.setCenter(r),b.setZoom(17)),A.current&&A.current.setMap(null),A.current=new window.google.maps.Marker({position:r,map:b}),ie(r.lat().toString()),oe(r.lng().toString()),ne(o.formatted_address||o.name),C("Location selected!"),S("success"),m(!0)});return()=>{window.google&&window.google.maps.event&&window.google.maps.event.removeListener(a)}},[K,b]),s.useEffect(()=>{if(!b||!R||!D)return;const t={lat:parseFloat(R),lng:parseFloat(D)};b.setCenter(t),b.setZoom(12),A.current?A.current.setPosition(t):A.current=new window.google.maps.Marker({position:t,map:b})},[R,D,b]),s.useEffect(()=>{if(!xe||!K||!window.google||!window.google.maps)return;new window.google.maps.Geocoder().geocode({address:xe},(a,o)=>{if(o==="OK"&&a[0]){const r=a[0].geometry.location,d=r.lat().toString(),p=r.lng().toString();ie(d),oe(p),ne(a[0].formatted_address),b&&(b.setCenter({lat:r.lat(),lng:r.lng()}),b.setZoom(12),A.current&&A.current.setMap(null),A.current=new window.google.maps.Marker({position:{lat:r.lat(),lng:r.lng()},map:b})),C(`Location set for ${xe}!`),S("success"),m(!0)}else C(`Could not find location for ${xe}`),S("warning"),m(!0)})},[xe,K,b]);const Ne=s.useCallback(t=>{var d,p,c,P,M,V,G,J,Y,u,j,Ke,Aa,Pa,Ta,Ea,Ia;if(console.log("Setting vehicle data:",t),t.brand&&t.brand._id&&!Et.some(g=>g._id===t.brand._id)&&It(g=>[...g,{_id:t.brand._id,title:t.brand.title||t.brand.name||"Unknown Brand"}]),Na(((d=t.advanceBookingAmount)==null?void 0:d.toString())||""),(c=(p=t.category)==null?void 0:p.parentCategory)!=null&&c._id){const g=t.category.parentCategory._id;Le(g),ye(t.category._id),N.get(`${T}/categories/parents/${g}/subcategories`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}}).then(ir=>Q(ir.data.data||[])).catch(()=>Q([]))}t.termsAndConditions&&Array.isArray(t.termsAndConditions)&&t.termsAndConditions.length>0?q(t.termsAndConditions.map(g=>({heading:g.heading||"",points:Array.isArray(g.points)&&g.points.length>0?g.points:[""]}))):q([{heading:"",points:[""]}]);let a="";Array.isArray(t.category)&&t.category.length>0?(a=t.category[0]._id,Wt.some(g=>g._id===a)||ja(g=>[...g,{_id:a,title:t.category[0].title||"Unknown Category"}])):t.category&&typeof t.category=="object"&&t.category._id?(a=t.category._id,Wt.some(g=>g._id===a)||ja(g=>[...g,{_id:a,title:t.category.title||"Unknown Category"}])):typeof t.category=="string"&&(a=t.category),t.zone&&t.zone._id&&!se.some(g=>g._id===t.zone._id)&&Dt(g=>[...g,{_id:t.zone._id,name:t.zone.name||"Unknown Zone"}]),ht(t.name||""),gt(t.description||""),xt(((P=t.brand)==null?void 0:P._id)||""),ha(a),console.log("Category ID being set:",a);const o=((M=t.zone)==null?void 0:M._id)||"";mt(o);const r=se.find(g=>g._id===o)||t.zone&&{name:t.zone.name};bt(r?r.name:""),ft(t.model||""),jt(((V=t.seatingCapacity)==null?void 0:V.toString())||""),me(t.airCondition?"yes":"no"),yt(t.licensePlateNumber||""),Fe(t.searchTags||[]),ne(t.venueAddress||""),ie(((G=t.latitude)==null?void 0:G.toString())||""),oe(((J=t.longitude)==null?void 0:J.toString())||""),Vt(t.operatingHours||""),console.log("Operating hours being set:",t.operatingHours),t.pricing&&(pa(t.pricing.type||"hourly"),xa(((Y=t.pricing.hourly)==null?void 0:Y.toString())||""),fa(((u=t.pricing.perDay)==null?void 0:u.toString())||""),ma(((j=t.pricing.distanceWise)==null?void 0:j.toString())||"")),kt(((Ke=t.discount)==null?void 0:Ke.toString())||""),je({driverIncluded:((Aa=t.features)==null?void 0:Aa.driverIncluded)??!1,sunroof:((Pa=t.features)==null?void 0:Pa.sunroof)??!1,decorationAvailable:((Ta=t.features)==null?void 0:Ta.decorationAvailable)??!1}),At(((Ia=(Ea=t.features)==null?void 0:Ea.decorationPrice)==null?void 0:Ia.toString())||"")},[Et,Wt,se]);s.useEffect(()=>()=>{Z.forEach(t=>URL.revokeObjectURL(t))},[Z]),s.useEffect(()=>{(async()=>{var a,o,r,d,p;try{if(!ae)throw new Error("Module ID is not defined. Please log in or set moduleId in localStorage.");const c=localStorage.getItem("token"),[P,M,V]=await Promise.all([N.get(`${T}/brands/module/${ae}`,{headers:{Authorization:`Bearer ${c}`}}),N.get(`${T}/categories/parents/${ae}`,{headers:{Authorization:`Bearer ${c}`}}),N.get(`${T}/zones`,{headers:{Authorization:`Bearer ${c}`,Accept:"application/json"}})]);Lt(((a=M.data)==null?void 0:a.data)||[]);const G=Array.isArray(P.data)?P.data:P.data.data||[];It(G);const J=((o=M.data)==null?void 0:o.data)||[];Lt(J);const Y=V.data.data||V.data||[],u=Array.isArray(Y)?Y.filter(j=>j.isActive).map(j=>({_id:j._id,name:j.name})):[];Dt(u),console.log("Module ID:",ae),console.log("Brands:",G),console.log("Parent Categories:",J),console.log("Zones:",u),va(!0)}catch(c){console.error("Error fetching brands/categories/zones:",((r=c.response)==null?void 0:r.data)||c),It([]),Lt([]),Dt([]),va(!0),C(((p=(d=c.response)==null?void 0:d.data)==null?void 0:p.message)||"Failed to fetch brands, categories, or zones"),S("error"),m(!0)}})()},[ae,T]),s.useEffect(()=>{if($.length>0&&!E&&pe==="create"){const t=$[0];Le(t._id),N.get(`${T}/categories/parents/${t._id}/subcategories`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}}).then(a=>{const o=a.data.data||[];Q(o),o.length>0&&ye(o[0]._id)}).catch(a=>{console.error("Failed to fetch subcategories:",a),Q([])})}},[$,E,pe,T]),s.useEffect(()=>{(async()=>{var a;try{const d=(((a=(await N.get(`${T}/vehicle-attributes`)).data)==null?void 0:a.data)||[]).filter(c=>c.status),p={};d.forEach(c=>{p[c.title.toLowerCase()]=c.values||[]}),$a(d),Ha(p),console.log("âœ… Vehicle Attributes Loaded:",d)}catch(o){console.error("âŒ Failed to load vehicle attributes",o)}})()},[T]),s.useEffect(()=>{var a;if(!Mt)return;const t=(a=te.state)==null?void 0:a.vehicle;t?(Ne(t),_t(t.thumbnail||""),$t(t.images||[]),ut("edit")):ue&&(async()=>{var r,d,p;B(!0);try{const c=await N.get(`${T}/vehicles/${ue}`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}}),P=c.data.data||c.data;console.log("Vehicle data fetched for edit:",P),Ne(P),_t(P.thumbnail||""),$t(P.images||[]),ut("edit")}catch(c){C(((d=(r=c.response)==null?void 0:r.data)==null?void 0:d.message)||"Failed to fetch vehicle data"),S("error"),m(!0),console.error("Error fetching vehicle:",((p=c.response)==null?void 0:p.data)||c)}finally{B(!1)}})()},[Mt,ue,Ne]);const qa=async t=>{const a=t.target.value;if(Le(a),ye(""),Q([]),!!a)try{const o=await N.get(`${T}/categories/parents/${a}/subcategories`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});Q(o.data.data||[])}catch(o){console.error("Failed to fetch sub categories",o),Q([])}},Ga=s.useCallback(t=>{const a=t.target.files[0];a&&pt(a)},[]),wa=s.useCallback(t=>{t.preventDefault()},[]),Ja=s.useCallback(t=>{t.preventDefault();const a=t.dataTransfer.files[0];a&&pt(a)},[]),Ya=s.useCallback(t=>{const a=Array.from(t.target.files);Pe(o=>[...o,...a])},[]),Xa=s.useCallback(t=>{t.preventDefault();const a=Array.from(t.dataTransfer.files);Pe(o=>[...o,...a])},[]),Qa=s.useCallback(t=>{Tt(t.target.value)},[]),er=(t,a)=>{Va(o=>({...o,[t]:a}))},tr=s.useCallback(t=>{t.key==="Enter"&&ze.trim()&&(Fe(a=>[...a,ze.trim()]),Tt(""),t.preventDefault())},[ze]),ar=s.useCallback(t=>{Fe(a=>a.filter(o=>o!==t))},[]),Nt=s.useCallback(t=>/^[A-Z0-9]{6,8}$/.test(t)?(vt(""),!0):(vt("License plate must be 6-8 alphanumeric characters"),!1),[]),Ht=s.useCallback(()=>{ht(""),gt(""),ne(""),xt(""),ft(""),ha(""),mt(""),bt(""),Le(""),ye(""),pt(null),Pe([]),_t(""),$t([]),jt(""),me("yes"),yt(""),vt(""),Ge(""),Zt(""),qt(""),Gt(""),Jt(""),Yt(""),tt(""),Xt("no"),za(""),je({driverIncluded:!1,sunroof:!1,decorationAvailable:!1}),la({leatherSeats:!1,adjustableSeats:!1,armrest:!1,musicSystem:!1,bluetooth:!1,usbAux:!1,airbags:!1,abs:!1,rearCamera:!1,parkingSensors:!1,powerWindows:!1,centralLock:!1,keylessEntry:!1,wifi:!1,chargingPoints:!1}),da({curtains:!1,readingLights:!1,musicSystem:!1,microphone:!1,fireExtinguisher:!1,firstAidKit:!1,luggageCarrier:!1,wifi:!1,chargingPoints:!1}),ea(""),ta(""),aa(""),ra(""),sa(""),na(""),ia(""),oa(""),et("normal"),pa("hourly"),xa(""),fa(""),ma(""),kt(""),At(""),Fe([]),Tt(""),ie(""),oe(""),Vt(""),ut("create"),A.current&&(A.current.setMap(null),A.current=null),b&&Sa(null)},[b]),rr=s.useCallback(async t=>{var p,c,P,M,V,G,J,Y;t.preventDefault();const a=pe==="edit";if(B(!0),!Ae||!Te||!Ee||!E||!Re||!Ie||!We||!be||!_||!_e||!R||!D){C("Please fill all required fields."),S("error"),m(!0),B(!1);return}if(z.decorationAvailable&&(!re||parseFloat(re)<=0)){C("Please provide a valid decoration price when decoration is available."),S("error"),m(!0),B(!1);return}if(_==="hourly"&&!Ct||_==="perDay"&&!St||_==="distanceWise"&&!wt){C(`Please provide a price for ${_} trip type.`),S("error"),m(!0),B(!1);return}if(!X&&!Me&&!a){C("Please upload a thumbnail image."),S("error"),m(!0),B(!1);return}if(Z.length===0&&ve.length===0&&!a){C("Please upload at least one vehicle image."),S("error"),m(!0),B(!1);return}if(!Nt(be)){C("Invalid license plate number."),S("error"),m(!0),B(!1);return}if(!L.length||!L[0].heading){C("Please add at least one Terms & Conditions section."),S("error"),m(!0),B(!1);return}const o=localStorage.getItem("token");if(!o){C("No authentication token found. Please log in."),S("error"),m(!0),B(!1);return}const r=new FormData;r.append("transmissionType",Ce),r.append("enginePower",Se?parseInt(Se):""),r.append("name",Ae),r.append("description",ua),r.append("brand",Te),r.append("category",E),r.append("subCategories[]",Re),r.append("zone",Ie),r.append("model",Ee),r.append("seatingCapacity",parseInt(We)),r.append("airCondition",fe==="yes"),r.append("features[driverIncluded]",z.driverIncluded),r.append("features[sunroof]",z.sunroof),r.append("features[decorationAvailable]",z.decorationAvailable),z.decorationAvailable&&re&&r.append("decorationPrice",parseFloat(re)),Ve&&(r.append("vehicleType",Qe),r.append("engineCapacity",Je),r.append("torque",Ye),r.append("mileage",Xe),r.append("fuelType",he),r.append("interiorLighting",we),r.append("carFeatures[leatherSeats]",v.leatherSeats),r.append("carFeatures[adjustableSeats]",v.adjustableSeats),r.append("carFeatures[armrest]",v.armrest),r.append("carFeatures[musicSystem]",v.musicSystem),r.append("carFeatures[bluetooth]",v.bluetooth),r.append("carFeatures[usbAux]",v.usbAux),r.append("carFeatures[airbags]",v.airbags),r.append("carFeatures[abs]",v.abs),r.append("carFeatures[rearCamera]",v.rearCamera),r.append("carFeatures[parkingSensors]",v.parkingSensors),r.append("carFeatures[powerWindows]",v.powerWindows),r.append("carFeatures[centralLock]",v.centralLock),r.append("carFeatures[keylessEntry]",v.keylessEntry),r.append("carFeatures[wifi]",v.wifi),r.append("carFeatures[chargingPoints]",v.chargingPoints),r.append("basicPackagePrice",ke),r.append("hoursIncluded",rt),r.append("kmIncluded",st),r.append("additionalPricePerKm",nt),r.append("afterKilometer",it),r.append("discountType",ot),r.append("advanceType",lt),r.append("advanceAmount",dt)),O&&(r.append("pushbackSeats",at),r.append("airConditionZone",Qt),r.append("fuelType",he),r.append("busFeatures[curtains]",W.curtains),r.append("busFeatures[readingLights]",W.readingLights),r.append("busFeatures[musicSystem]",W.musicSystem),r.append("busFeatures[microphone]",W.microphone),r.append("busFeatures[fireExtinguisher]",W.fireExtinguisher),r.append("busFeatures[firstAidKit]",W.firstAidKit),r.append("busFeatures[luggageCarrier]",W.luggageCarrier),r.append("busFeatures[wifi]",W.wifi),r.append("busFeatures[chargingPoints]",W.chargingPoints)),r.append("attributes",JSON.stringify(Bt)),r.append("licensePlateNumber",be),r.append("termsAndConditions",JSON.stringify(L)),r.append("venueAddress",_e),r.append("latitude",parseFloat(R)),r.append("longitude",parseFloat(D)),$e&&r.append("operatingHours",$e),r.append("pricing[type]",_),r.append("pricing[hourly]",_==="hourly"&&parseFloat(Ct)||0),r.append("pricing[perDay]",_==="perDay"&&parseFloat(St)||0),r.append("pricing[distanceWise]",_==="distanceWise"&&parseFloat(wt)||0),Be&&r.append("discount",parseFloat(Be)),Ft&&r.append("advanceBookingAmount",parseFloat(Ft)),Pt.forEach(u=>r.append("searchTags[]",u)),X&&r.append("thumbnail",X),Z.forEach(u=>r.append("images",u));const d={};for(let[u,j]of r.entries())d[u]=j instanceof File?j.name:j;console.log("FormData:",d);try{let u,j;if(a){if(!ge)throw new Error("Invalid vehicle ID for update");u=await N.put(`${T}/vehicles/${ge}`,r,{headers:{Authorization:`Bearer ${o}`,"Content-Type":"multipart/form-data"}}),j=u.data.data||u.data}else u=await N.post(`${T}/vehicles`,r,{headers:{Authorization:`Bearer ${o}`,"Content-Type":"multipart/form-data"}}),j=u.data.data||u.data;console.log("API Response:",u.data),C(a?"Vehicle updated successfully!":"Vehicle added successfully!"),S("success"),m(!0),Ht(),a&&Ue("/vehicle-setup/lists",{state:{vehicle:j}})}catch(u){console.error("API Error:",{status:(p=u.response)==null?void 0:p.status,statusText:(c=u.response)==null?void 0:c.statusText,data:(P=u.response)==null?void 0:P.data,headers:(M=u.response)==null?void 0:M.headers,message:u.message});let j=((G=(V=u.response)==null?void 0:V.data)==null?void 0:G.message)||"Failed to save vehicle";(Y=(J=u.response)==null?void 0:J.data)!=null&&Y.errors&&(j=u.response.data.errors.map(Ke=>Ke.msg).join(", ")),C(j),S("error"),m(!0)}finally{B(!1)}},[pe,ge,Ae,Te,Ee,Ra,Ie,We,fe,z,re,be,_,Ct,St,wt,Be,Pt,X,Z,Me,ve,Nt,Ht,Ue,T,ae,Mt,ca,Ne,_e,R,D,$e,E,Re,Bt,Ft,L,Ve,O,Ce,Se,Je,Ye,Xe,Qe,we,he,at,Qt,v,W,ke,rt,st,nt,it,ot,lt,dt]),ka=s.useCallback((t,a)=>{a!=="clickaway"&&m(!1)},[]),He=pe==="edit",sr=s.useCallback(t=>{const a=t.target.value;mt(a);const o=se.find(r=>r._id===a);bt(o?o.name:"")},[se]),nr=t=>a=>{la(o=>({...o,[t]:a.target.checked}))},Kt=t=>a=>{da(o=>({...o,[t]:a.target.checked}))};return e.jsxs(n,{sx:{p:I?2:3,backgroundColor:h.palette.grey[100],minHeight:"100vh",width:"100%"},children:[e.jsxs(n,{sx:{maxWidth:"lg",margin:"auto",backgroundColor:"white",borderRadius:h.shape.borderRadius,boxShadow:h.shadows[1],p:I?2:3,overflowX:"hidden"},children:[e.jsx(n,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3},children:e.jsxs(n,{sx:{display:"flex",alignItems:"center",gap:2},children:[He&&e.jsx(Oe,{onClick:()=>Ue("/vehicle-setup/lists"),color:"primary",children:e.jsx(hr,{})}),e.jsx(mr,{sx:{fontSize:24,mr:1}}),e.jsx(i,{variant:"h5",component:"h1",children:He?"Edit Vehicle":"Add New Vehicle"})]})}),e.jsx(i,{variant:"subtitle1",color:"text.secondary",sx:{mb:4},children:"Insert the basic information of the vehicle"}),De&&e.jsx(n,{sx:{display:"flex",justifyContent:"center",mb:2},children:e.jsx(Wa,{})}),e.jsxs(n,{component:"form",onSubmit:rr,children:[e.jsxs(n,{sx:{display:"flex",flexDirection:I?"column":"row",gap:3,mb:4},children:[e.jsx(H,{sx:{flex:I?"auto":2,p:2,boxShadow:"none",border:`1px solid ${h.palette.grey[200]}`},children:e.jsxs(ee,{sx:{"&:last-child":{pb:2}},children:[e.jsx(i,{variant:"h6",gutterBottom:!0,children:"General Information"}),e.jsx(i,{variant:"body2",color:"text.secondary",sx:{mb:2},children:"Insert the basic information of the vehicle"}),e.jsx(x,{fullWidth:!0,label:"Vehicle Name*",variant:"outlined",value:Ae,onChange:t=>ht(t.target.value),placeholder:"Type vehicle name",sx:{mb:2},required:!0}),e.jsx(x,{fullWidth:!0,label:"Short Description",variant:"outlined",multiline:!0,rows:4,value:ua,onChange:t=>gt(t.target.value),placeholder:"Type short description",sx:{mb:2}})]})}),e.jsx(H,{sx:{flex:I?"auto":1,p:2,boxShadow:"none",border:`1px solid ${h.palette.grey[200]}`},children:e.jsxs(ee,{sx:{"&:last-child":{pb:2}},children:[e.jsx(i,{variant:"h6",gutterBottom:!0,children:"Vehicle Thumbnail*"}),e.jsx(i,{variant:"body2",color:"text.secondary",sx:{mb:2},children:"JPG, JPEG, PNG Less Than 1MB (Ratio 2:1)"}),e.jsxs(Ut,{onDragOver:wa,onDrop:Ja,onClick:()=>document.getElementById("thumbnail-upload").click(),children:[X?e.jsxs(n,{children:[e.jsx("img",{src:URL.createObjectURL(X),alt:"Thumbnail preview",style:{maxWidth:"100%",maxHeight:100,objectFit:"contain",marginBottom:h.spacing(1)}}),e.jsx(i,{variant:"body2",color:"text.secondary",children:X.name})]}):Me?e.jsxs(n,{children:[e.jsx("img",{src:Me,alt:"Existing thumbnail",style:{maxWidth:"100%",maxHeight:100,objectFit:"contain",marginBottom:h.spacing(1),borderColor:"#E15B65"}}),e.jsx(i,{variant:"body2",color:"text.secondary",children:"Existing thumbnail. Upload to replace."})]}):e.jsxs(n,{children:[e.jsx(Ot,{sx:{fontSize:40,color:"#E15B65",mb:1}}),e.jsx(i,{variant:"body2",color:"#E15B65",sx:{mb:.5,fontWeight:"medium"},children:"Click to upload"}),e.jsx(i,{variant:"body2",color:"#E15B65",children:"Or drag and drop"})]}),e.jsx("input",{type:"file",id:"thumbnail-upload",hidden:!0,accept:"image/jpeg,image/png,image/jpg",onChange:Ga})]})]})})]}),e.jsx(n,{sx:{mb:4},children:e.jsx(H,{sx:{p:2,boxShadow:"none",border:`1px solid ${h.palette.grey[200]}`},children:e.jsxs(ee,{sx:{"&:last-child":{pb:2}},children:[e.jsxs(i,{variant:"h6",gutterBottom:!0,children:["Images",e.jsx("span",{style:{color:"#E15B65"},children:"*"})]}),e.jsx(i,{variant:"body2",color:"text.secondary",sx:{mb:3},children:"Upload high quality images (JPG, JPEG, PNG â€¢ Max 1MB â€¢ Ratio 2:1)"}),e.jsxs(Ut,{onDragOver:wa,onDrop:Xa,onClick:()=>document.getElementById("images-upload").click(),sx:{backgroundColor:"#fafafa",border:"2px dashed #E15B65",borderRadius:2,p:3,transition:"0.3s","&:hover":{backgroundColor:"#fff1f2"}},children:[ve.length>0||Z.length>0?e.jsxs(n,{sx:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(90px, 1fr))",gap:2,width:"100%"},children:[ve.map((t,a)=>e.jsxs(n,{sx:{position:"relative",borderRadius:1.5,overflow:"hidden",border:"1px solid #e5e7eb"},children:[e.jsx("img",{src:t,alt:`Existing ${a}`,style:{width:"100%",height:90,objectFit:"cover"}}),e.jsx(n,{sx:{position:"absolute",top:6,left:6,backgroundColor:"#000",color:"#fff",fontSize:10,px:.8,py:.2,borderRadius:1,opacity:.75},children:"Existing"})]},`existing-${a}`)),Z.map((t,a)=>e.jsxs(n,{sx:{position:"relative",borderRadius:1.5,overflow:"hidden",border:"1px solid #e5e7eb"},children:[e.jsx("img",{src:URL.createObjectURL(t),alt:`New ${a}`,style:{width:"100%",height:90,objectFit:"cover"}}),e.jsx(Oe,{size:"small",onClick:()=>Pe(o=>o.filter((r,d)=>d!==a)),sx:{position:"absolute",top:4,right:4,backgroundColor:"#fff",boxShadow:1,"&:hover":{backgroundColor:"#fee2e2"}},children:"âœ•"})]},`new-${a}`))]}):e.jsxs(n,{sx:{textAlign:"center"},children:[e.jsx(Ot,{sx:{fontSize:46,color:"#E15B65",mb:1}}),e.jsx(i,{fontWeight:600,color:"#E15B65",children:"Click to upload images"}),e.jsx(i,{variant:"body2",color:"text.secondary",children:"or drag & drop files here"})]}),e.jsxs(i,{variant:"caption",color:"text.secondary",sx:{mt:2,display:"block",textAlign:"center"},children:[ve.length+Z.length," image(s) selected"]}),e.jsx("input",{type:"file",id:"images-upload",hidden:!0,accept:"image/jpeg,image/png,image/jpg",multiple:!0,onChange:Ya})]})]})})}),e.jsx(n,{sx:{mb:4},children:e.jsx(H,{sx:{p:2,boxShadow:"none",border:`1px solid ${h.palette.grey[200]}`},children:e.jsxs(ee,{sx:{"&:last-child":{pb:2}},children:[e.jsx(i,{variant:"h6",gutterBottom:!0,children:"Vehicle Information"}),e.jsx(i,{variant:"body2",color:"text.secondary",sx:{mb:3},children:"Insert the vehicle's general information"}),e.jsxs(n,{sx:{display:"grid",gridTemplateColumns:I?"1fr":"repeat(3, 1fr)",gap:h.spacing(3),mb:4},children:[e.jsxs(U,{spacing:2,children:[e.jsx(i,{variant:"subtitle2",sx:{fontWeight:700,mb:1},children:"Basic Info"}),e.jsxs(f,{fullWidth:!0,variant:"outlined",required:!0,children:[e.jsx(w,{id:"brand-label",children:"Select Brand / Manufacturer"}),e.jsxs(k,{labelId:"brand-label",id:"brand-select",value:Te,label:"Select Brand / Manufacturer",onChange:t=>xt(t.target.value),children:[e.jsx(l,{value:"",children:"Select vehicle brand"}),Et.map(t=>e.jsx(l,{value:t._id,children:t.title},t._id))]})]}),e.jsx(x,{fullWidth:!0,label:"Enter Model Name",variant:"outlined",value:Ee,onChange:t=>ft(t.target.value),placeholder:"e.g. Camry, Bus X",required:!0}),!O&&e.jsx(x,{fullWidth:!0,label:"Year of Manufacture",variant:"outlined",placeholder:"e.g. 2023"})]}),e.jsxs(U,{spacing:2,children:[e.jsx(i,{variant:"subtitle2",sx:{fontWeight:700,mb:1},children:"Capacity & Comfort"}),e.jsx(x,{fullWidth:!0,label:"Seating Capacity",variant:"outlined",value:We,onChange:t=>jt(t.target.value),placeholder:"Number of seats",type:"number",inputProps:{min:1},required:!0}),O&&e.jsxs(f,{fullWidth:!0,variant:"outlined",children:[e.jsx(w,{children:"Select Legroom Type"}),e.jsxs(k,{value:"",label:"Select Legroom Type",onChange:t=>{},children:[e.jsx(l,{value:"",children:"Select Legroom"}),e.jsx(l,{value:"standard",children:"Standard"}),e.jsx(l,{value:"extra",children:"Extra"}),e.jsx(l,{value:"premium",children:"Premium"})]})]}),O&&e.jsxs(n,{sx:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:2},children:[e.jsxs(n,{children:[e.jsx(i,{variant:"body2",color:"text.secondary",sx:{mb:1},children:"Pushback seats"}),e.jsxs(le,{row:!0,value:at,onChange:t=>Xt(t.target.value),children:[e.jsx(y,{value:"yes",control:e.jsx(F,{size:"small"}),label:e.jsx(i,{variant:"body2",children:"Yes"})}),e.jsx(y,{value:"no",control:e.jsx(F,{size:"small"}),label:e.jsx(i,{variant:"body2",children:"No"})})]})]}),e.jsxs(n,{children:[e.jsx(i,{variant:"body2",color:"text.secondary",sx:{mb:1},children:"Recliner Seats"}),e.jsxs(le,{row:!0,value:Ba,onChange:t=>Fa(t.target.value),children:[e.jsx(y,{value:"yes",control:e.jsx(F,{size:"small"}),label:e.jsx(i,{variant:"body2",children:"Yes"})}),e.jsx(y,{value:"no",control:e.jsx(F,{size:"small"}),label:e.jsx(i,{variant:"body2",children:"No"})})]})]})]}),!O&&e.jsxs(f,{component:"fieldset",fullWidth:!0,sx:{mt:1},children:[e.jsx(i,{variant:"body2",color:"text.secondary",sx:{mb:1},children:"Air Conditioning"}),e.jsxs(le,{row:!0,value:fe,onChange:t=>me(t.target.value),children:[e.jsx(y,{value:"yes",control:e.jsx(F,{size:"small"}),label:e.jsx(i,{variant:"body2",children:"Yes"})}),e.jsx(y,{value:"no",control:e.jsx(F,{size:"small"}),label:e.jsx(i,{variant:"body2",children:"No"})})]})]})]}),e.jsxs(U,{spacing:2,children:[e.jsx(i,{variant:"subtitle2",sx:{fontWeight:700,mb:1},children:"Zone & Location"}),e.jsxs(f,{fullWidth:!0,variant:"outlined",required:!0,children:[e.jsx(w,{id:"zone-label",children:"Zone*"}),e.jsxs(k,{labelId:"zone-label",value:Ie,label:"Zone",onChange:sr,children:[e.jsx(l,{value:"",children:"Select zone"}),se.map(t=>e.jsx(l,{value:t._id,children:t.name},t._id))]})]}),e.jsxs(f,{fullWidth:!0,required:!0,children:[e.jsx(w,{children:"Parent Category"}),e.jsxs(k,{value:E,label:"Parent Category",onChange:qa,children:[e.jsx(l,{value:"",children:"Select Parent Category"}),$.map(t=>e.jsx(l,{value:t._id,children:t.title},t._id))]})]}),e.jsxs(f,{fullWidth:!0,required:!0,disabled:!E,children:[e.jsx(w,{children:"Sub Category"}),e.jsxs(k,{value:Re,label:"Sub Category",onChange:t=>ye(t.target.value),children:[e.jsx(l,{value:"",children:"Select Sub Category"}),Ka.map(t=>e.jsx(l,{value:t._id,children:t.title},t._id))]})]})]})]}),e.jsxs(n,{children:[e.jsx(i,{variant:"subtitle1",sx:{fontWeight:700,mb:3},children:"Engine & Performance"}),O?e.jsxs(U,{spacing:3,children:[e.jsxs(n,{sx:{display:"grid",gridTemplateColumns:I?"1fr":"repeat(3, 1fr)",gap:h.spacing(3)},children:[e.jsxs(f,{fullWidth:!0,size:"small",children:[e.jsx(w,{children:"Select Fuel Type"}),e.jsxs(k,{value:he,label:"Select Fuel Type",onChange:t=>tt(t.target.value),children:[e.jsx(l,{value:"",children:"Select Fuel"}),e.jsx(l,{value:"petrol",children:"Petrol"}),e.jsx(l,{value:"diesel",children:"Diesel"}),e.jsx(l,{value:"electric",children:"Electric"}),e.jsx(l,{value:"hybrid",children:"Hybrid"}),e.jsx(l,{value:"cng",children:"CNG"})]})]}),e.jsxs(f,{fullWidth:!0,size:"small",children:[e.jsx(w,{children:"Transmission"}),e.jsxs(k,{value:Ce,label:"Transmission",onChange:t=>Ge(t.target.value),children:[e.jsx(l,{value:"",children:"Select Transmission"}),e.jsx(l,{value:"manual",children:"Manual"}),e.jsx(l,{value:"automatic",children:"Automatic"}),e.jsx(l,{value:"semi-automatic",children:"Semi-Automatic"})]})]}),e.jsxs(f,{fullWidth:!0,size:"small",children:[e.jsx(w,{children:"Climate Control"}),e.jsxs(k,{value:fe,label:"Climate Control",onChange:t=>me(t.target.value),children:[e.jsx(l,{value:"yes",children:"AC"}),e.jsx(l,{value:"no",children:"Non-AC"})]})]})]}),e.jsxs(f,{component:"fieldset",fullWidth:!0,children:[e.jsx(i,{variant:"body2",color:"text.secondary",sx:{mb:1},children:"Air Conditioning"}),e.jsxs(le,{row:!0,value:fe,onChange:t=>me(t.target.value),children:[e.jsx(y,{value:"yes",control:e.jsx(F,{size:"small"}),label:e.jsx(i,{variant:"body2",children:"Yes"})}),e.jsx(y,{value:"no",control:e.jsx(F,{size:"small"}),label:e.jsx(i,{variant:"body2",children:"No"})})]})]})]}):e.jsxs(n,{sx:{display:"grid",gridTemplateColumns:I?"1fr":"repeat(3, 1fr)",gap:h.spacing(3)},children:[e.jsxs(f,{fullWidth:!0,children:[e.jsx(w,{children:"Select Fuel Type"}),e.jsxs(k,{value:he,label:"Select Fuel Type",onChange:t=>tt(t.target.value),children:[e.jsx(l,{value:"",children:"Select Fuel"}),e.jsx(l,{value:"petrol",children:"Petrol"}),e.jsx(l,{value:"diesel",children:"Diesel"}),e.jsx(l,{value:"electric",children:"Electric"}),e.jsx(l,{value:"hybrid",children:"Hybrid"}),e.jsx(l,{value:"cng",children:"CNG"})]})]}),e.jsxs(f,{fullWidth:!0,required:!0,children:[e.jsx(w,{children:"Transmission"}),e.jsxs(k,{value:Ce,label:"Transmission",onChange:t=>Ge(t.target.value),children:[e.jsx(l,{value:"",children:"Select Transmission"}),e.jsx(l,{value:"manual",children:"Manual"}),e.jsx(l,{value:"automatic",children:"Automatic"}),e.jsx(l,{value:"semi-automatic",children:"Semi-Automatic"})]})]}),e.jsxs(f,{fullWidth:!0,children:[e.jsx(w,{children:"Vehicle Class"}),e.jsxs(k,{value:Qe,label:"Vehicle Class",onChange:t=>Yt(t.target.value),children:[e.jsx(l,{value:"standard",children:"Standard"}),e.jsx(l,{value:"luxury",children:"Luxury"}),e.jsx(l,{value:"vintage",children:"Vintage"})]})]}),e.jsx(x,{fullWidth:!0,label:"Engine Capacity (CC)",variant:"outlined",type:"number",value:Je,onChange:t=>qt(t.target.value),placeholder:"e.g. 2000",inputProps:{min:0}}),e.jsx(x,{fullWidth:!0,label:"Engine Power (HP)",variant:"outlined",type:"number",value:Se,onChange:t=>Zt(t.target.value),placeholder:"e.g. 180",inputProps:{min:0}}),e.jsx(x,{fullWidth:!0,label:"Torque",variant:"outlined",value:Ye,onChange:t=>Gt(t.target.value),placeholder:"e.g. 250 Nm"}),e.jsx(x,{fullWidth:!0,label:"Mileage",variant:"outlined",value:Xe,onChange:t=>Jt(t.target.value),placeholder:"e.g. 15 km/l"})]})]}),e.jsx(n,{sx:{mt:3},children:e.jsx(x,{fullWidth:!0,label:"Vihicles Address*",variant:"outlined",value:_e,onChange:t=>ne(t.target.value),placeholder:"Enter venue address",required:!0})}),e.jsxs(n,{sx:{mt:3},children:[e.jsx(i,{variant:"h6",gutterBottom:!0,children:"Location and Operating Hours"}),e.jsx(x,{fullWidth:!0,label:"Search Location",inputRef:qe,variant:"outlined",placeholder:"Enter a location",sx:{mb:2}}),e.jsxs(n,{sx:{display:"flex",gap:2,mb:2},children:[e.jsx(x,{sx:{flex:1},label:"Latitude*",variant:"outlined",value:R,onChange:t=>ie(t.target.value),placeholder:"e.g., 25.2048",required:!0}),e.jsx(x,{sx:{flex:1},label:"Longitude*",variant:"outlined",value:D,onChange:t=>oe(t.target.value),placeholder:"e.g., 55.2708",required:!0})]}),K&&ct?e.jsxs(e.Fragment,{children:[e.jsx(i,{variant:"body2",color:"text.secondary",sx:{mb:1},children:"Click on the map below to select a location"}),e.jsx(n,{ref:Ze,sx:{height:300,width:"100%",borderRadius:h.shape.borderRadius,border:`1px solid ${h.palette.grey[300]}`,mb:2}})]}):e.jsx(n,{sx:{height:300,display:"flex",alignItems:"center",justifyContent:"center",border:`1px solid ${h.palette.grey[300]}`,borderRadius:h.shape.borderRadius,mb:2},children:e.jsx(i,{variant:"body2",color:"text.secondary",children:"Map loading..."})}),e.jsx(x,{fullWidth:!0,label:"Operating Hours",variant:"outlined",value:$e,onChange:t=>Vt(t.target.value),placeholder:"e.g., 9:00 AM - 6:00 PM",multiline:!0,rows:2})]})]})})}),e.jsx(n,{sx:{mb:4},children:e.jsx(H,{sx:{p:2,boxShadow:"none",border:`1px solid ${h.palette.grey[200]}`},children:e.jsxs(ee,{children:[e.jsx(i,{variant:"h6",gutterBottom:!0,children:"Vehicle Attributes"}),e.jsx(i,{variant:"body2",color:"text.secondary",sx:{mb:2},children:"Select additional attributes for the vehicle"}),e.jsx(n,{sx:{display:"grid",gridTemplateColumns:I?"1fr":"repeat(3, 1fr)",gap:3},children:_a.map(t=>e.jsxs(f,{fullWidth:!0,children:[e.jsx(w,{children:t.title}),e.jsxs(k,{value:Bt[t._id]||"",label:t.title,onChange:a=>er(t._id,a.target.value),children:[e.jsxs(l,{value:"",children:["Select ",t.title]}),t.values.map(a=>e.jsx(l,{value:a,children:a},a))]})]},t._id))})]})})}),e.jsx(n,{sx:{mb:4},children:e.jsxs(ee,{sx:{"&:last-child":{pb:2}},children:[e.jsx(i,{variant:"h6",gutterBottom:!0,children:"Vehicle Identity"}),e.jsx(i,{variant:"body2",color:"text.secondary",sx:{mb:2},children:"Insert the vehicle number and driver availability"}),e.jsxs(n,{sx:{display:"grid",gridTemplateColumns:I?"1fr":"2fr 1fr",gap:3,alignItems:"center"},children:[e.jsx(x,{fullWidth:!0,label:"Vehicle Number*",variant:"outlined",value:be,onChange:t=>{yt(t.target.value),Nt(t.target.value)},placeholder:"Enter vehicle number",required:!0,error:!!ga,helperText:ga}),e.jsxs(n,{children:[e.jsx(i,{variant:"body2",fontWeight:600,sx:{mb:1},children:"Driver Included"}),e.jsxs(n,{sx:{display:"flex",gap:3},children:[e.jsx(y,{control:e.jsx(de,{checked:z.driverIncluded===!0,onChange:()=>je(t=>({...t,driverIncluded:!0}))}),label:"Yes"}),e.jsx(y,{control:e.jsx(de,{checked:z.driverIncluded===!1,onChange:()=>je(t=>({...t,driverIncluded:!1}))}),label:"No"})]})]})]})]})}),Rt&&Ve&&e.jsxs(H,{sx:{mt:6,mb:6,borderRadius:3,border:"1px solid #e5e7eb",backgroundColor:"#fafafa"},children:[e.jsxs(n,{sx:{px:4,py:3,borderBottom:"1px solid #e5e7eb",background:"linear-gradient(135deg, #f9fafb, #ffffff)"},children:[e.jsx(i,{variant:"h6",fontWeight:700,children:"ðŸš— Vehicle Features"}),e.jsx(i,{variant:"body2",color:"text.secondary",children:"Select features available in this vehicle"})]}),e.jsx(n,{sx:{px:4,py:4},children:e.jsx(U,{spacing:4,children:[{title:"Interior Comfort",items:[["Leather Seats","leatherSeats"],["Adjustable Seats","adjustableSeats"],["Armrest","armrest"]]},{title:"Entertainment",items:[["Music System","musicSystem"],["Bluetooth","bluetooth"],["USB / AUX","usbAux"]]},{title:"Safety & Compliance",items:[["Airbags","airbags"],["ABS","abs"],["Rear Camera","rearCamera"],["Parking Sensors","parkingSensors"]]},{title:"Convenience",items:[["Power Windows","powerWindows"],["Central Lock","centralLock"],["Keyless Entry","keylessEntry"]]},{title:"Extra Addons",items:[["Wifi","wifi"],["Charging Points","chargingPoints"]]}].map(t=>e.jsxs(n,{sx:{p:3,backgroundColor:t.title==="Extra Addons"?"#e7f0f5":"#ffffff",borderRadius:2,border:"1px solid #e5e7eb"},children:[e.jsx(i,{fontWeight:600,mb:2,children:t.title}),e.jsx(n,{sx:{display:"grid",gridTemplateColumns:I?"1fr":"repeat(3, 1fr)",gap:1.5},children:t.items.map(([a,o])=>e.jsx(y,{control:e.jsx(de,{checked:v[o],onChange:nr(o)}),label:a},o))}),t.title==="Extra Addons"&&e.jsxs(n,{sx:{mt:3},children:[e.jsx(i,{fontWeight:600,mb:1,children:"Interior Lighting"}),e.jsxs(le,{row:!0,value:we,onChange:a=>et(a.target.value),children:[e.jsx(y,{value:"normal",control:e.jsx(F,{}),label:"Normal"}),e.jsx(y,{value:"premium",control:e.jsx(F,{}),label:"Premium"})]})]})]},t.title))})})]}),Rt&&O&&e.jsxs(H,{sx:{mt:6,mb:6,borderRadius:3,border:"1px solid #e5e7eb",backgroundColor:"#fafafa"},children:[e.jsxs(n,{sx:{px:4,py:3,borderBottom:"1px solid #e5e7eb",background:"linear-gradient(135deg, #f9fafb, #ffffff)"},children:[e.jsx(i,{variant:"h6",fontWeight:700,children:"ðŸšŒ Bus Features"}),e.jsx(i,{variant:"body2",color:"text.secondary",children:"Select features available in this bus"})]}),e.jsx(n,{sx:{px:4,py:4},children:e.jsx(U,{spacing:4,children:[{title:"Interior Features",items:[["Curtains","curtains"],["Reading Lights","readingLights"]]},{title:"Entertainment & Communication",items:[["Music System","musicSystem"],["Microphone","microphone"]]},{title:"Safety & Compliance",items:[["Fire Extinguisher","fireExtinguisher"],["First Aid Kit","firstAidKit"]]},{title:"Storage",items:[["Luggage Carrier","luggageCarrier"]]},{title:"Extra Addons",items:[["Wifi","wifi"],["Charging Points","chargingPoints"]]}].map(t=>e.jsxs(n,{sx:{p:3,backgroundColor:t.title==="Extra Addons"?"#e5edf6":"#ffffff",borderRadius:2,border:"1px solid #e5e7eb"},children:[e.jsx(i,{fontWeight:600,mb:2,children:t.title}),t.title==="Extra Addons"?e.jsxs(e.Fragment,{children:[e.jsxs(n,{sx:{display:"grid",gridTemplateColumns:I?"1fr":"1fr 1fr",gap:2,mb:3},children:[e.jsx(y,{control:e.jsx(de,{checked:W.wifi,onChange:Kt("wifi")}),label:"Wifi"}),e.jsx(y,{control:e.jsx(de,{checked:W.chargingPoints,onChange:Kt("chargingPoints")}),label:"Charging Points"})]}),e.jsxs(n,{children:[e.jsx(i,{sx:{fontSize:"0.875rem",fontWeight:600,mb:1},children:"Interior Lighting"}),e.jsxs(le,{row:!0,value:we,onChange:a=>et(a.target.value),children:[e.jsx(y,{value:"normal",control:e.jsx(F,{}),label:"Normal"}),e.jsx(y,{value:"premium",control:e.jsx(F,{}),label:"Premium"})]})]})]}):e.jsx(n,{sx:{display:"grid",gridTemplateColumns:I?"1fr":"repeat(3, 1fr)",gap:1.5},children:t.items.map(([a,o])=>e.jsx(y,{control:e.jsx(de,{checked:W[o],onChange:Kt(o)}),label:a},o))})]},t.title))})})]}),Rt&&(Ve||O)&&e.jsx(n,{sx:{mb:4},children:e.jsxs(H,{sx:{mt:6,mb:6,borderRadius:3,border:"none",boxShadow:"0 4px 20px rgba(0,0,0,0.08)",overflow:"hidden"},children:[e.jsxs(n,{sx:{px:4,py:3,background:"linear-gradient(135deg, #f5efef 0%, #efdfe1 100%)",color:"white"},children:[e.jsx(i,{variant:"h5",sx:{fontWeight:700,mb:.5},children:"Package Pricing"}),e.jsx(i,{variant:"body2",sx:{opacity:.95},children:"Set base price, discount & advance booking options"})]}),e.jsx(n,{sx:{p:4,backgroundColor:"#fafbfc"},children:e.jsxs(U,{spacing:3,children:[e.jsxs(n,{sx:{p:3,borderRadius:2,backgroundColor:"#ffffff",border:"2px solid #e5e7eb",transition:"all 0.3s ease","&:hover":{boxShadow:"0 8px 24px rgba(225, 91, 101, 0.15)",borderColor:"#E15B65"}},children:[e.jsxs(n,{sx:{display:"flex",alignItems:"center",mb:3},children:[e.jsx(n,{sx:{width:40,height:40,borderRadius:"50%",backgroundColor:"#E15B65",display:"flex",alignItems:"center",justifyContent:"center",mr:2},children:e.jsx(i,{sx:{color:"white",fontSize:20,fontWeight:700},children:"â‚¹"})}),e.jsx(i,{variant:"subtitle1",fontWeight:700,sx:{color:"#1f2937"},children:"Package Details"})]}),e.jsxs(n,{sx:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:2},children:[e.jsxs(n,{sx:{p:2.5,borderRadius:2,backgroundColor:"#fef3f2",border:"1px solid #fecaca",display:"flex",flexDirection:"column"},children:[e.jsx(i,{variant:"body2",fontWeight:600,sx:{color:"#991b1b",mb:2},children:"Basic Package"}),e.jsxs(U,{spacing:2,sx:{flexGrow:1},children:[e.jsx(x,{fullWidth:!0,label:"Base Package Price",type:"number",value:ke,onChange:t=>ea(t.target.value),placeholder:"0",InputProps:{startAdornment:e.jsx(i,{sx:{mr:.5,color:"#E15B65",fontWeight:600},children:"â‚¹"})},size:"small"}),e.jsxs(n,{sx:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:5,mt:3},children:[e.jsxs(f,{fullWidth:!0,size:"small",children:[e.jsx(w,{children:"Hours Included"}),e.jsxs(k,{value:rt,label:"Hours Included",onChange:t=>ta(t.target.value),children:[e.jsx(l,{value:"",children:"Select"}),e.jsx(l,{value:"4",children:"4 Hrs"}),e.jsx(l,{value:"6",children:"6 Hrs"}),e.jsx(l,{value:"8",children:"8 Hrs"}),e.jsx(l,{value:"10",children:"10 Hrs"}),e.jsx(l,{value:"12",children:"12 Hrs"})]})]}),e.jsxs(f,{fullWidth:!0,size:"small",children:[e.jsx(w,{children:"KM Included"}),e.jsxs(k,{value:st,label:"KM Included",onChange:t=>aa(t.target.value),children:[e.jsx(l,{value:"",children:"Select"}),e.jsx(l,{value:"50",children:"50 KM"}),e.jsx(l,{value:"100",children:"100 KM"}),e.jsx(l,{value:"150",children:"150 KM"})]})]})]})]})]}),e.jsxs(n,{sx:{p:2.5,borderRadius:2,backgroundColor:"#f0fdf4",border:"1px solid #bbf7d0",display:"flex",flexDirection:"column"},children:[e.jsx(i,{variant:"body2",fontWeight:600,sx:{color:"#15803d",mb:2},children:"Apply Discount"}),e.jsxs(n,{sx:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:2,mb:3},children:[e.jsxs(f,{fullWidth:!0,size:"small",children:[e.jsx(w,{children:"Type"}),e.jsxs(k,{value:ot,label:"Type",onChange:t=>na(t.target.value),children:[e.jsx(l,{value:"percentage",children:"Percentage (%)"}),e.jsx(l,{value:"flat",children:"Flat Rate (â‚¹)"})]})]}),e.jsx(x,{fullWidth:!0,label:"Value",type:"number",value:Be,onChange:t=>kt(t.target.value),size:"small"})]}),e.jsxs(n,{sx:{p:2,borderRadius:2,background:"linear-gradient(135deg, #e3dedf 0%, #ceaaad 100%)",textAlign:"center",boxShadow:"0 4px 14px rgba(225, 91, 101, 0.25)",display:"flex",flexDirection:"column",justifyContent:"center",minHeight:160},children:[e.jsxs(n,{sx:{display:"flex",alignItems:"center",justifyContent:"center",mb:.5},children:[e.jsx(n,{sx:{width:24,height:24,borderRadius:"50%",backgroundColor:"rgba(255,255,255,0.35)",display:"flex",alignItems:"center",justifyContent:"center",mr:1},children:e.jsx(i,{sx:{fontSize:13,fontWeight:700,color:"#000"},children:"Î£"})}),e.jsx(i,{variant:"caption",sx:{fontWeight:700,color:"#000"},children:"GRAND TOTAL"})]}),e.jsxs(i,{sx:{fontWeight:800,fontSize:"1.6rem",lineHeight:1.2,mb:.5,color:"#000"},children:["â‚¹ ",ke||"0"]}),e.jsx(i,{variant:"caption",sx:{fontSize:"0.7rem",fontWeight:600,color:"#000"},children:"Base Price + Taxes"}),e.jsxs(n,{sx:{mt:2,pt:1.5,borderTop:"1px solid rgba(255, 255, 255, 0.2)",display:"flex",alignItems:"center",justifyContent:"center",gap:.5},children:[e.jsx(i,{sx:{fontSize:"0.9rem"},children:"ðŸ’¡"}),e.jsx(i,{variant:"caption",sx:{fontSize:"0.7rem",lineHeight:1.3},children:"Final amount based on base price and discounts"})]})]})]})]})]}),e.jsxs(n,{sx:{p:3,borderRadius:2,backgroundColor:"#ffffff",border:"2px solid #e5e7eb",transition:"all 0.3s ease","&:hover":{boxShadow:"0 8px 24px rgba(225, 91, 101, 0.15)",borderColor:"#E15B65"}},children:[e.jsxs(n,{sx:{display:"flex",alignItems:"center",mb:3},children:[e.jsx(n,{sx:{width:40,height:40,borderRadius:"50%",backgroundColor:"#10b981",display:"flex",alignItems:"center",justifyContent:"center",mr:2},children:e.jsx(i,{sx:{color:"white",fontSize:20,fontWeight:700},children:"%"})}),e.jsx(i,{variant:"subtitle1",fontWeight:700,sx:{color:"#1f2937"},children:"Offers & Advance"})]}),e.jsxs(n,{sx:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:3},children:[e.jsxs(n,{sx:{p:2.5,borderRadius:2,backgroundColor:"#fff7ed",border:"1px solid #fed7aa",height:"100%"},children:[e.jsx(i,{variant:"body2",fontWeight:600,sx:{color:"#9a3412",mb:2},children:"Extra Charges"}),e.jsxs(n,{sx:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:2},children:[e.jsx(x,{fullWidth:!0,label:"Price/KM",type:"number",value:nt,onChange:t=>ra(t.target.value),placeholder:"0",InputProps:{startAdornment:e.jsx(i,{sx:{mr:.5,color:"text.secondary",fontSize:14},children:"â‚¹"})},size:"small"}),e.jsxs(f,{fullWidth:!0,size:"small",children:[e.jsx(w,{children:"After KM"}),e.jsxs(k,{value:it,label:"After KM",onChange:t=>sa(t.target.value),children:[e.jsx(l,{value:"",children:"Select"}),e.jsx(l,{value:"1",children:"Per KM"})]})]})]})]}),e.jsxs(n,{sx:{p:2.5,borderRadius:2,backgroundColor:"#eff6ff",border:"1px solid #bfdbfe",height:"100%"},children:[e.jsx(i,{variant:"body2",fontWeight:600,sx:{color:"#1e40af",mb:2},children:"Advance Booking"}),e.jsxs(n,{sx:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:2},children:[e.jsxs(f,{fullWidth:!0,size:"small",children:[e.jsx(w,{children:"Type"}),e.jsxs(k,{value:lt,label:"Type",onChange:t=>ia(t.target.value),children:[e.jsx(l,{value:"percentage",children:"Percentage (%)"}),e.jsx(l,{value:"flat",children:"Flat (â‚¹)"})]})]}),e.jsx(x,{fullWidth:!0,label:"Amount",type:"number",value:dt,onChange:t=>oa(t.target.value),InputProps:{startAdornment:e.jsx(i,{sx:{mr:.5,color:"text.secondary",fontSize:14},children:"â‚¹"})},size:"small"})]})]})]})]})]})})]})}),e.jsxs(n,{sx:{mt:3,p:2,border:"1px solid",borderColor:"grey.300",borderRadius:2,backgroundColor:"#fafafa"},children:[e.jsx(i,{variant:"subtitle1",gutterBottom:!0,children:"Vehicle Features"}),e.jsxs(n,{sx:{display:"grid",gridTemplateColumns:z.decorationAvailable?{xs:"1fr",md:"1fr 1fr"}:"max-content",gap:3,alignItems:"center"},children:[e.jsxs(n,{sx:{display:"flex",alignItems:"center",gap:3,px:3,py:2,border:"1px solid",borderColor:"grey.300",borderRadius:2,backgroundColor:"white",width:"fit-content",minWidth:260},children:[e.jsx(i,{fontSize:14,fontWeight:500,children:"Decoration Available"}),e.jsx(pr,{checked:z.decorationAvailable,onChange:t=>je(a=>({...a,decorationAvailable:t.target.checked})),sx:{"& .MuiSwitch-switchBase.Mui-checked":{color:"#E15B65"},"& .MuiSwitch-switchBase.Mui-checked + .MuiSwitch-track":{backgroundColor:"#E15B65"}}})]}),z.decorationAvailable&&e.jsx(n,{sx:{px:3,py:2,border:"1px solid",borderColor:"grey.300",borderRadius:2,backgroundColor:"white",minWidth:260},children:e.jsx(x,{fullWidth:!0,label:"Decoration Price (â‚¹)",type:"number",value:re,onChange:t=>At(t.target.value),inputProps:{min:0},placeholder:"e.g. 5000"})})]})]}),e.jsxs(n,{sx:{mt:4,p:3,border:"1px solid",borderColor:"grey.300",borderRadius:2,backgroundColor:"#fafafa"},children:[e.jsx(i,{variant:"subtitle1",fontWeight:600,gutterBottom:!0,children:"Upload Vehicle Documents"}),e.jsx(i,{variant:"body2",color:"text.secondary",sx:{mb:2},children:"Upload RC, Insurance, Permit or any supporting vehicle documents"}),e.jsxs(Ut,{onDragOver:t=>t.preventDefault(),onDrop:Ua,onClick:()=>document.getElementById("vehicle-documents-upload").click(),sx:{minHeight:160},children:[ya.length>0?e.jsx(U,{spacing:1,sx:{width:"100%"},children:ya.map((t,a)=>e.jsxs(n,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",px:2,py:1,border:"1px solid #e5e7eb",borderRadius:1,backgroundColor:"#ffffff"},children:[e.jsxs(i,{variant:"body2",noWrap:!0,children:["ðŸ“„ ",t.name]}),e.jsx(Oe,{size:"small",onClick:()=>zt(o=>o.filter((r,d)=>d!==a)),children:"âœ•"})]},a))}):e.jsxs(e.Fragment,{children:[e.jsx(Ot,{sx:{fontSize:42,color:"#E15B65",mb:1}}),e.jsx(i,{fontWeight:600,color:"#E15B65",children:"Click to upload documents"}),e.jsx(i,{variant:"body2",color:"text.secondary",children:"Or drag & drop files here (PDF, JPG, PNG)"})]}),e.jsx("input",{id:"vehicle-documents-upload",type:"file",hidden:!0,multiple:!0,accept:".pdf,image/png,image/jpeg,image/jpg",onChange:Oa})]})]}),e.jsx(n,{sx:{mb:4},children:e.jsxs(H,{sx:{p:3,borderRadius:3,background:"linear-gradient(135deg, #ffffff, #fafafa)",border:"1px solid #eee"},children:[e.jsx(i,{variant:"h6",fontWeight:600,sx:{mb:.5},children:"Terms & Conditions"}),e.jsx(i,{variant:"body2",color:"text.secondary",sx:{mb:3},children:"Define rules & policies shown to customers during booking"}),L.map((t,a)=>e.jsxs(n,{sx:{mb:3,p:2,borderRadius:2,border:"1px solid #e5e7eb",backgroundColor:"#fff"},children:[e.jsxs(n,{sx:{display:"flex",alignItems:"center",mb:2},children:[e.jsx(x,{fullWidth:!0,label:"Section Heading",placeholder:"e.g. Booking & Confirmation",value:t.heading,onChange:o=>{const r=[...L];r[a].heading=o.target.value,q(r)}}),L.length>1&&e.jsx(ce,{onClick:()=>q(o=>o.filter((r,d)=>d!==a)),sx:{ml:1,color:"error.main"},children:"âœ•"})]}),t.points.map((o,r)=>e.jsxs(n,{sx:{display:"flex",alignItems:"center",mb:1},children:[e.jsx(x,{fullWidth:!0,label:`Point ${r+1}`,placeholder:"Enter policy detail",value:o,onChange:d=>{const p=[...L];p[a].points[r]=d.target.value,q(p)}}),t.points.length>1&&e.jsx(ce,{onClick:()=>{const d=[...L];d[a].points.splice(r,1),q(d)},sx:{ml:1,color:"error.main"},children:"âœ•"})]},r)),e.jsx(ce,{size:"small",onClick:()=>{const o=[...L];o[a].points.push(""),q(o)},sx:{mt:1,color:"#E15B65"},children:"+ Add Point"})]},a)),e.jsx(ce,{variant:"outlined",onClick:()=>q([...L,{heading:"",points:[""]}]),sx:{mt:2,borderRadius:2,borderColor:"#E15B65",color:"#E15B65"},children:"+ Add Section"})]})}),e.jsx(n,{sx:{mb:4},children:e.jsx(H,{sx:{p:2,boxShadow:"none",border:`1px solid ${h.palette.grey[200]}`},children:e.jsxs(ee,{sx:{"&:last-child":{pb:2}},children:[e.jsx(i,{variant:"h6",gutterBottom:!0,children:"Search Tags"}),e.jsx(i,{variant:"body2",color:"text.secondary",sx:{mb:2},children:"Insert tags for appearing in user search results"}),e.jsx(x,{fullWidth:!0,label:"Type and press Enter",variant:"outlined",value:ze,onChange:Qa,onKeyPress:tr,placeholder:"Type and press Enter",sx:{mb:2}}),e.jsx(n,{sx:{display:"flex",flexWrap:"wrap",gap:1},children:Pt.map((t,a)=>e.jsxs(n,{sx:{display:"flex",alignItems:"center",backgroundColor:h.palette.grey[200],borderRadius:h.shape.borderRadius,px:1,py:.5},children:[e.jsx(i,{variant:"body2",children:t}),e.jsx(Oe,{size:"small",onClick:()=>ar(t),children:e.jsx(i,{sx:{fontSize:14},children:"Ã—"})})]},a))})]})})}),e.jsxs(n,{sx:{mt:4,display:"flex",justifyContent:"flex-end",gap:2},children:[e.jsx(ce,{variant:"outlined",color:"#E15B65",size:"large",onClick:Ht,sx:{color:"#E15B65"},children:He?"Cancel":"Reset"}),e.jsx(ce,{variant:"contained",type:"submit",size:"large",disabled:De,startIcon:De?e.jsx(Wa,{size:20,color:"inherit"}):null,sx:{color:"white",bgcolor:"#E15B65"},children:De?"Submitting...":He?"Update":"Submit"})]})]})]}),e.jsx(xr,{open:Da,autoHideDuration:6e3,onClose:ka,anchorOrigin:{vertical:"top",horizontal:"center"},sx:{"& .MuiSnackbarContent-root":{minWidth:"600px",maxWidth:"600px",width:"auto"}},children:e.jsx(fr,{onClose:ka,severity:ba,sx:{width:"100%",backgroundColor:ba==="success"?"#1976d2":"#d32f2f",color:"white","& .MuiAlert-message":{whiteSpace:"pre-line",wordBreak:"break-word",fontSize:"1rem",lineHeight:1.5}},children:Ma})})]})};export{Br as default};
