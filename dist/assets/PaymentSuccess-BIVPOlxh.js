import{u as g,d as m,r as n,j as e,B as d,c as x,e as v,T as c,f as h}from"./index-BaH8rYCR.js";const I="https://api.bookmyevent.ae";function P(){const[f]=g();m();const s=f.get("orderId"),o=JSON.parse(localStorage.getItem("user")||"{}"),p=o==null?void 0:o._id,y=localStorage.getItem("moduleId"),[i,t]=n.useState("verifying"),[l,a]=n.useState("Verifying payment...");return n.useRef(p),n.useRef(y),n.useEffect(()=>{if(!s){t("error"),a("Invalid payment reference.");return}(async()=>{var u;try{const r=await h.post(`${I}/api/payment/verify-subscription-payment`,{orderId:s});if(r.data.success&&((u=r.data.subscription)==null?void 0:u.status)==="active"){t("success"),a("ðŸŽ‰ Subscription activated successfully!"),setTimeout(()=>{window.location.replace("/login")},2e3);return}if(r.data.status==="pending"){t("verifying"),a("Payment is being processed. Please wait...");return}t("error"),a(r.data.message||"Payment failed")}catch{t("error"),a("Unable to verify payment. Please contact support.")}})()},[s]),e.jsxs(d,{sx:{minHeight:"100vh",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",gap:3,p:3,bgcolor:"#f9fafc"},children:[i==="verifying"&&e.jsx(x,{size:60,sx:{color:"#c62828"}}),i==="success"&&e.jsx(d,{sx:{fontSize:80},children:"âœ…"}),i==="error"&&e.jsx(v,{severity:"error",sx:{maxWidth:600},children:l}),e.jsx(c,{variant:"h5",fontWeight:600,textAlign:"center",children:l}),i==="verifying"&&e.jsx(c,{variant:"body2",color:"text.secondary",textAlign:"center",children:"Please do not close this page. This usually takes 5-10 seconds..."}),s&&e.jsxs(c,{variant:"caption",color:"text.secondary",sx:{mt:2,opacity:.6},children:["Order ID: ",s]})]})}export{P as default};
