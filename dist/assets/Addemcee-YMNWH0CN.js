import{r as i,l as K,d as Q,j as e,aF as X,aG as _,aH as ee,B as n,T as p,A as L,aI as re,s as F,Y as v,a as C,Z as ae,o as te,y as se,w as oe,b as N,N as ie,e as ne}from"./index-CWJg_lwt.js";import{C as le}from"./Close-D09zOr9j.js";import{A as ce}from"./AddPhotoAlternate-CAThx31o.js";import{A as de,R as pe}from"./RotateLeft-nZlTPbGJ.js";const E={},me=_({palette:{primary:{main:"#dd666eff",dark:"#A33A43",light:"#FF8A92",contrastText:"#fff"},secondary:{main:"#ad2430ff"},background:{default:"#f8fafc",paper:"#fff"},text:{primary:"#0f172a",secondary:"#475569"}},typography:{fontFamily:"'DM Sans', sans-serif",h4:{fontFamily:"'Playfair Display', serif"}},shape:{borderRadius:14},components:{MuiCssBaseline:{styleOverrides:"@import url('https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,700;1,500&family=DM+Sans:wght@300;400;500;600&display=swap');"},MuiOutlinedInput:{styleOverrides:{root:{borderRadius:12,backgroundColor:"#FFFBF7",fontFamily:"'DM Sans', sans-serif",fontSize:"14.5px","& fieldset":{borderColor:"rgba(196,87,42,0.2)"},"&:hover fieldset":{borderColor:"rgba(196,87,42,0.5) !important"},"&.Mui-focused fieldset":{borderColor:"#C4572A !important",borderWidth:"2px"}},input:{padding:"15px 16px"}}},MuiInputLabel:{styleOverrides:{root:{fontFamily:"'DM Sans', sans-serif",fontSize:"14px",color:"#0f172a","&.Mui-focused":{color:"#0f172a"}}}},MuiButton:{styleOverrides:{root:{textTransform:"none",fontFamily:"'DM Sans', sans-serif",fontWeight:600,borderRadius:12}}}}}),S=({children:s})=>e.jsx(p,{sx:{fontSize:"10.5px",fontWeight:700,letterSpacing:"0.13em",textTransform:"uppercase",color:"#0f172a",mb:1.25},children:s}),j={bgcolor:"#fff",border:"1px solid rgba(15,23,42,0.11)",borderRadius:"16px",p:{xs:2.5,sm:3},boxShadow:"0 2px 14px rgba(15,23,42,0.05)"};function Se(){const[s,b]=i.useState({name:"",description:"",price:"",advance:""}),[U,k]=i.useState([]),[ge,H]=i.useState([]),[xe,V]=i.useState(!0),[fe,z]=i.useState(null),[w,y]=i.useState(null),[R,g]=i.useState(null),[c,x]=i.useState({}),[P,f]=i.useState({open:!1,msg:"",severity:"success"}),[A,B]=i.useState(!1),[M,I]=i.useState(!1),{id:u}=K();Q();const h=!!u,T=(E==null?void 0:E.VITE_API_BASE_URL)||"https://api.bookmyevent.ae";i.useEffect(()=>{(async()=>{try{const a=localStorage.getItem("moduleId");if(!a)throw new Error("Module ID not found");const t=await fetch(`${T}/api/categories/modules/${a}`);if(!t.ok)throw new Error(`HTTP error! ${t.status}`);const l=await t.json();if(l.success&&Array.isArray(l.data)){const o=l.data.filter(d=>d.isActive).map(d=>({id:d.categoryId||d._id,label:d.title,image:d.image?`${T}${d.image}`:null}));H(o)}else z("No services found")}catch(a){z(a.message)}finally{V(!1)}})()},[]),i.useEffect(()=>{if(!u)return;(async()=>{try{const a=localStorage.getItem("token"),l=await(await fetch(`https://api.bookmyevent.ae/api/emcee/${u}`,{headers:{Authorization:`Bearer ${a}`}})).json();if(l.success){const o=l.data;b({name:o.packageName||"",description:o.description||"",price:o.packagePrice!=null?String(o.packagePrice):"",advance:o.advanceBookingAmount!=null?String(o.advanceBookingAmount):""}),k(o.services||[]),o.image&&g(`https://api.bookmyevent.ae${o.image.startsWith("/")?"":"/"}${o.image}`)}}catch(a){console.error(a)}})()},[u]);const D=(r,a)=>{b(t=>({...t,[r]:a})),c[r]&&x(t=>({...t,[r]:""}))},W=r=>{if(!(r!=null&&r.type.startsWith("image/")))return;y(r);const a=new FileReader;a.onload=t=>{g(t.target.result),x(l=>({...l,image:""}))},a.readAsDataURL(r)},q=()=>{const r={};return s.name.trim()||(r.name="Required"),s.description.trim()||(r.description="Required"),(!s.price||+s.price<=0)&&(r.price="Enter a valid price"),(s.advance===""||+s.advance<0)&&(r.advance="Enter a valid amount"),!h&&!w&&(r.image="Please upload a package image"),r},G=async r=>{r.preventDefault();const a=q();if(Object.keys(a).length){x(a),f({open:!0,msg:"Please fix the highlighted fields.",severity:"error"});return}try{B(!0);const t=localStorage.getItem("moduleId"),l=localStorage.getItem("user");if(!t||!l)throw new Error("Module ID or Vendor ID missing in localStorage");const d=JSON.parse(l)._id,O=localStorage.getItem("token");if(!t||!d)throw new Error("Module ID or Vendor ID missing in localStorage");const m=new FormData;m.append("module",t),m.append("providerId",d),m.append("packageName",s.name),m.append("description",s.description),m.append("packagePrice",s.price),m.append("advanceBookingAmount",s.advance),m.append("services",JSON.stringify(U)),w&&m.append("image",w);const Y=h?`https://api.bookmyevent.ae/api/emcee/${u}`:"https://api.bookmyevent.ae/api/emcee/create",$=await fetch(Y,{method:h?"PUT":"POST",headers:O?{Authorization:`Bearer ${O}`}:void 0,body:m}),Z=await $.json();if(!$.ok)throw new Error(Z.message||"Something went wrong");f({open:!0,msg:"Package published successfully ðŸŽ‰",severity:"success"}),b({name:"",description:"",price:"",advance:""}),k([]),y(null),g(null),x({})}catch(t){f({open:!0,msg:t.message,severity:"error"})}finally{B(!1)}},J=()=>{b({name:"",description:"",price:"",advance:""}),k([]),y(null),g(null),x({})};return e.jsxs(X,{theme:me,children:[e.jsx(ee,{}),e.jsxs(n,{sx:{width:"100%",bgcolor:"#FDF6EE",minHeight:"100%",py:{xs:3,sm:4},px:{xs:2,sm:3,md:4}},children:[e.jsxs(n,{sx:{mb:3.5},children:[e.jsxs(p,{variant:"h4",fontWeight:700,sx:{fontSize:{xs:"1.65rem",sm:"2rem"},lineHeight:1.2},children:["Add"," ",e.jsx(n,{component:"em",sx:{color:"primary.main",fontStyle:"italic"},children:"Emcee"})," ","Package"]}),e.jsx(p,{variant:"body2",color:"text.secondary",mt:.75,fontSize:"13.5px",children:"Fill in the details below to create and publish a new package."})]}),e.jsxs(n,{sx:{bgcolor:"#1A0A00",px:{xs:2.5,sm:3.5},py:2.25,borderRadius:"16px 16px 0 0",display:"flex",alignItems:"center",gap:2},children:[e.jsx(L,{sx:{bgcolor:"rgba(196,87,42,0.3)",borderRadius:"10px",width:38,height:38,fontSize:"15px"},children:"âœ¦"}),e.jsxs(n,{children:[e.jsx(p,{sx:{color:"#F7EDE0",fontFamily:"'Playfair Display', serif",fontSize:"1.05rem"},children:"Package Details"}),e.jsx(p,{sx:{color:"rgba(255,255,255,0.3)",fontSize:"11.5px"},children:"All * fields are required"})]})]}),A&&e.jsx(re,{color:"primary"}),e.jsx(n,{component:"form",onSubmit:G,noValidate:!0,sx:{border:"1px solid rgba(196,87,42,0.11)",borderTop:"none",borderRadius:"0 0 16px 16px",bgcolor:"#FDF6EE",p:{xs:2,sm:3},boxShadow:"0 4px 24px rgba(196,87,42,0.06)"},children:e.jsxs(F,{spacing:2.5,children:[e.jsxs(v,{elevation:0,sx:j,children:[e.jsx(S,{children:"Package Name"}),e.jsx(C,{label:"Package Name *",placeholder:"e.g. Wedding Emcee Package",fullWidth:!0,value:s.name,onChange:r=>D("name",r.target.value),error:!!c.name,helperText:c.name})]}),e.jsxs(v,{elevation:0,sx:j,children:[e.jsx(S,{children:"Description"}),e.jsx(C,{label:"Description *",placeholder:"Describe your hosting style, experience, and the events you cover...",fullWidth:!0,multiline:!0,rows:4,value:s.description,onChange:r=>D("description",r.target.value),error:!!c.description,helperText:c.description,sx:{"& .MuiOutlinedInput-root .MuiOutlinedInput-input":{padding:"4px 2px"}}})]}),e.jsxs(v,{elevation:0,sx:j,children:[e.jsx(S,{children:"Pricing"}),e.jsx(n,{sx:{display:"flex",flexDirection:{xs:"column",sm:"row"},gap:2.5},children:e.jsx(n,{sx:{flex:1},children:e.jsx(C,{label:"Package Price *",placeholder:"0",fullWidth:!0,type:"number",value:s.price,onChange:r=>D("price",r.target.value),error:!!c.price,helperText:c.price,InputProps:{startAdornment:e.jsx(ae,{position:"start",children:e.jsx(p,{sx:{color:"primary.main",fontWeight:700,fontSize:"17px"},children:"â‚¹"})})}})})})]}),e.jsxs(v,{elevation:0,sx:j,children:[e.jsx(S,{children:"Package Image"}),R?e.jsxs(n,{sx:{position:"relative",borderRadius:"12px",overflow:"hidden"},children:[e.jsx(n,{component:"img",src:R,alt:"preview",sx:{width:"100%",height:{xs:200,sm:260,md:300},objectFit:"cover",display:"block",borderRadius:"12px",border:"1.5px solid rgba(196,87,42,0.15)"}}),e.jsx(te,{onClick:()=>{y(null),g(null)},size:"small",sx:{position:"absolute",top:10,right:10,bgcolor:"rgba(0,0,0,0.6)",color:"#fff","&:hover":{bgcolor:"primary.main"}},children:e.jsx(le,{fontSize:"small"})}),e.jsxs(n,{sx:{position:"absolute",bottom:10,left:10,bgcolor:"rgba(0,0,0,0.55)",borderRadius:"8px",px:1.5,py:.5,backdropFilter:"blur(6px)",display:"flex",alignItems:"center",gap:.75},children:[e.jsx(ce,{sx:{color:"#fff",fontSize:13}}),e.jsx(p,{sx:{color:"#fff",fontSize:"11.5px"},children:"Package Image"})]})]}):e.jsxs(n,{component:"label",htmlFor:"pkg-img",onDragOver:r=>{r.preventDefault(),I(!0)},onDragLeave:()=>I(!1),onDrop:r=>{r.preventDefault(),I(!1),W(r.dataTransfer.files[0])},sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",border:`2px dashed ${c.image?"#d32f2f":M?"#C4572A":"rgba(196,87,42,0.28)"}`,borderRadius:"12px",py:{xs:4.5,sm:5.5},px:3,cursor:"pointer",bgcolor:M?"rgba(196,87,42,0.04)":"#FFFBF7",textAlign:"center",transition:"all 0.2s","&:hover":{borderColor:"#C4572A",bgcolor:"rgba(196,87,42,0.03)"}},children:[e.jsx("input",{id:"pkg-img",type:"file",accept:"image/*",hidden:!0,onChange:r=>W(r.target.files[0])}),e.jsx(L,{sx:{bgcolor:"rgba(196,87,42,0.1)",width:52,height:52,mb:1.75,borderRadius:"13px"},children:e.jsx(se,{sx:{color:"#C4572A",fontSize:24}})}),e.jsx(p,{fontWeight:600,fontSize:"15px",color:"text.primary",mb:.5,children:"Click to upload image"}),e.jsx(p,{fontSize:"13px",color:"text.secondary",mb:2,children:"Drag & drop also supported"}),e.jsx(F,{direction:"row",spacing:.75,flexWrap:"wrap",justifyContent:"center",children:["JPG","PNG","WEBP","Max 5MB"].map(r=>e.jsx(oe,{label:r,size:"small",sx:{bgcolor:"rgba(196,87,42,0.08)",color:"#8B3A0F",fontSize:"11px",height:24}},r))})]}),c.image&&e.jsx(p,{sx:{color:"error.main",fontSize:"12px",mt:.75},children:c.image})]}),e.jsxs(F,{direction:{xs:"column",sm:"row"},spacing:1.5,alignItems:{sm:"center"},pt:.5,children:[e.jsx(N,{type:"submit",variant:"contained",size:"large",disabled:A,startIcon:e.jsx(de,{}),sx:{flex:{sm:1},py:1.65,fontSize:"15px",background:"linear-gradient(135deg, #dd666eff 0%, #ad2430ff 100%)",boxShadow:"0 4px 18px rgba(221, 102, 110, 0.32)","&:hover":{boxShadow:"0 6px 24px rgba(221, 102, 110, 0.44)",transform:"translateY(-1px)"},transition:"all 0.2s"},children:A?h?"Updatingâ€¦":"Publishingâ€¦":h?"Update Package":"Add Package"}),e.jsx(N,{type:"button",variant:"outlined",size:"large",onClick:J,startIcon:e.jsx(pe,{}),sx:{flex:{sm:1},py:1.65,fontSize:"15px",borderColor:"rgba(196,87,42,0.28)",color:"primary.dark","&:hover":{borderColor:"primary.main",bgcolor:"rgba(196,87,42,0.04)"}},children:"Reset"})]})]})})]}),e.jsx(ie,{open:P.open,autoHideDuration:3500,onClose:()=>f(r=>({...r,open:!1})),anchorOrigin:{vertical:"top",horizontal:"right"},children:e.jsx(ne,{severity:P.severity,variant:"filled",onClose:()=>f(r=>({...r,open:!1})),sx:{borderRadius:"12px",fontFamily:"'DM Sans', sans-serif",minWidth:280},children:P.msg})})]})}export{Se as default};
