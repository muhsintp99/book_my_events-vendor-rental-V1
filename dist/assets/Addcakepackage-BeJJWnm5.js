import{c as ko,j as e,w as Wo,r as l,h as B,B as i,t as we,x as Ot,H as W,S as z,T as n,G as S,F as he,W as C,C as ve,a2 as Qe,a4 as O,a3 as c,g as oe,b as P,ae as Ht,s as Vt,D as Fo,ac as Xe,bj as Io,aw as Eo,f as Nt,af as Gt,ag as Ao,aq as Ro,aa as Kt,ah as Bo,ai as zo,al as $o,ab as To,bk as Do}from"./index-D2YhpxGZ.js";import{S as Ut}from"./Star-Ca8uc0Yb.js";import{C as Ze}from"./CloudUpload-C-x1CoRA.js";import{C as ge}from"./Close-CZQCMVB0.js";import{S as Po}from"./Settings-CRHBHbCt.js";import{T as Lo,a as Jt,b as ne,c as _o}from"./TableRow-UKvzcC6U.js";import{T as Mo}from"./TableHead-DoGjGFcg.js";import{C as Oo}from"./Cake-D3FxiBGL.js";import{L as No}from"./LocalShipping-DjyaccUa.js";import{S as Go}from"./Storefront-COGt2hz_.js";import{I as Ko}from"./Info-hoKEmifo.js";import{L as Uo}from"./Label-dtS65wXT.js";import{T as Ho}from"./TableContainer-BHSZlWkF.js";const Vo=ko(e.jsx("path",{d:"M19 14V6c0-1.1-.9-2-2-2H3c-1.1 0-2 .9-2 2v8c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2m-9-1c-1.66 0-3-1.34-3-3s1.34-3 3-3 3 1.34 3 3-1.34 3-3 3m13-6v11c0 1.1-.9 2-2 2H4v-2h17V7z"})),r="#E91E63",k=window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1"?"http://localhost:5000":"https://api.bookmyevent.ae",et="68e5fc09651cc12c1fc0f9c9",q=W($o)(({theme:b})=>({borderRadius:"24px",padding:"40px",marginBottom:"40px",border:"1px solid rgba(0, 0, 0, 0.06)",boxShadow:"0px 15px 50px rgba(0, 0, 0, 0.02)",transition:"all 0.4s cubic-bezier(0.4, 0, 0.2, 1)",backgroundColor:"#ffffff","&:hover":{boxShadow:"0px 25px 70px rgba(0, 0, 0, 0.05)"}}));W(i)(({theme:b})=>({width:80,height:80,borderRadius:"12px",overflow:"hidden",position:"relative",border:"1px solid #E5E7EB",backgroundColor:"#fff",boxShadow:"0 4px 12px rgba(0,0,0,0.06)",transition:"0.2s ease","&:hover":{transform:"translateY(-2px)",boxShadow:"0 6px 18px rgba(0,0,0,0.12)"}}));const re=W(n)(({theme:b})=>({fontSize:"26px",fontWeight:900,color:"#111827",marginBottom:"10px",letterSpacing:"-1px"})),ie=W(n)(({theme:b})=>({fontSize:"15px",color:"#6B7280",marginBottom:"40px",fontWeight:500,lineHeight:1.6})),E=W(Vt)(({theme:b})=>({width:"100%","& .MuiOutlinedInput-root":{borderRadius:"16px",backgroundColor:"#F9FAFB",border:"1px solid #E5E7EB",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)","& fieldset":{borderColor:"transparent"},"&:hover":{backgroundColor:"#f3f4f6",borderColor:"#D1D5DB"},"&.Mui-focused":{backgroundColor:"#ffffff",borderColor:r,boxShadow:`0px 0px 0px 4px ${c(r,.1)}`,"& fieldset":{borderColor:r,borderWidth:"2px"}}},"& .MuiInputBase-input":{padding:"18px 20px",fontSize:"15px",fontWeight:600,color:"#1F2937"}})),se=W(To)(({theme:b})=>({width:"100%",borderRadius:"16px",backgroundColor:"#F9FAFB",border:"1px solid #E5E7EB",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)","& .MuiOutlinedInput-notchedOutline":{borderColor:"transparent"},"&:hover":{backgroundColor:"#f3f4f6",borderColor:"#D1D5DB"},"&.Mui-focused":{backgroundColor:"#ffffff",borderColor:r,boxShadow:`0px 0px 0px 4px ${c(r,.1)}`,"& .MuiOutlinedInput-notchedOutline":{borderColor:r,borderWidth:"2px"}},"& .MuiSelect-select":{padding:"18px 20px",fontSize:"15px",fontWeight:600,color:"#1F2937"}})),Jo=W(i)(({theme:b,hasImage:F})=>({width:"100%",height:"250px",borderRadius:"28px",border:F?"none":`3px dashed ${c(r,.15)}`,backgroundColor:F?"transparent":"#FAFAFA",backgroundImage:F?"none":`linear-gradient(180deg, rgba(255,255,255,0) 0%, ${c(r,.02)} 100%)`,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",cursor:"pointer",transition:"all 0.4s cubic-bezier(0.4, 0, 0.2, 1)",position:"relative",overflow:"hidden",boxShadow:F?"0 20px 40px rgba(0,0,0,0.1)":"none","&:hover":{borderColor:r,backgroundColor:c(r,.03),transform:"translateY(-4px)",boxShadow:"0 12px 28px rgba(233, 30, 99, 0.15)"}})),Yo=W(i)(({theme:b})=>({width:"100%",minHeight:"200px",borderRadius:"24px",border:`2px dashed ${c(r,.3)}`,backgroundColor:"#FAFAFA",backgroundImage:`linear-gradient(135deg, ${c(r,.01)} 0%, rgba(255,255,255,1) 100%)`,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",cursor:"pointer",transition:"all 0.3s ease","&:hover":{borderColor:r,backgroundColor:c(r,.04),boxShadow:`0 10px 40px ${c(r,.1)}`}}));W(i)(({theme:b})=>({width:"100%",aspectRatio:"1/1",borderRadius:"20px",overflow:"hidden",position:"relative",boxShadow:"0 8px 20px rgba(0,0,0,0.08)",transition:"all 0.3s ease",group:"slot","&:hover":{transform:"translateY(-4px)",boxShadow:"0 15px 30px rgba(0,0,0,0.12)"}}));W(i)(({theme:b})=>({padding:"20px",borderRadius:"24px",backgroundColor:"#FFFFFF",border:"1px solid rgba(0, 0, 0, 0.06)",position:"relative",transition:"all 0.3s ease",height:"100%",display:"flex",flexDirection:"column",justifyContent:"flex-start","&:hover":{borderColor:r,boxShadow:"0px 10px 30px rgba(233, 30, 99, 0.05)"}}));W(i)(({theme:b})=>({position:"absolute",top:"20px",right:"25px",fontSize:"48px",fontWeight:900,opacity:.06,color:r,pointerEvents:"none"}));W(O)(({theme:b,selected:F})=>({borderRadius:"14px",fontWeight:800,fontSize:"14px",height:"46px",padding:"0 10px",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",backgroundColor:F?r:"#F3F4F6",color:F?"#ffffff":"#4B5563",border:`2px solid ${F?r:"transparent"}`,"&:hover":{backgroundColor:F?"#D81B60":"#E5E7EB",transform:"translateY(-2px)"}}));const qo=W(Ho)(({theme:b})=>({borderRadius:"24px",border:"1px solid rgba(0, 0, 0, 0.05)",backgroundColor:"#ffffff",marginTop:"32px",overflow:"hidden",boxShadow:"0px 10px 40px rgba(0,0,0,0.03)"})),Qo=({variation:b,onChange:F,onImageUpload:L,onDelete:Q})=>e.jsxs(Jt,{sx:{"&:last-child td, &:last-child th":{border:0}},children:[e.jsx(ne,{sx:{py:3,pl:4},children:e.jsx(n,{sx:{fontWeight:800,color:"#1F2937",fontSize:"15px"},children:b.name})}),e.jsx(ne,{sx:{py:3},children:e.jsx(E,{size:"small",placeholder:"0.00",value:b.price,onChange:ae=>F("price",ae.target.value),sx:{maxWidth:"180px"},InputProps:{startAdornment:e.jsx(n,{sx:{mr:1,fontWeight:700,color:"#9CA3AF"},children:"â‚¹"})}})}),e.jsx(ne,{sx:{py:3,pr:4},children:e.jsxs(z,{direction:"row",spacing:2,alignItems:"center",children:[e.jsx(P,{onClick:()=>document.getElementById(`var-img-${b.id}`).click(),sx:{bgcolor:c(r,.05),color:r,"&:hover":{bgcolor:r,color:"white"}},children:e.jsx(Do,{fontSize:"small"})}),e.jsx("input",{id:`var-img-${b.id}`,type:"file",hidden:!0,onChange:ae=>L(ae.target.files[0])}),b.image&&e.jsx(i,{sx:{position:"relative",width:45,height:45,borderRadius:"10px",overflow:"hidden",border:`2px solid ${r}`},children:e.jsx("img",{src:typeof b.image=="string"?b.image:URL.createObjectURL(b.image),alt:"variant",style:{width:"100%",height:"100%",objectFit:"cover"}})}),e.jsx(P,{onClick:Q,sx:{bgcolor:c("#EF4444",.1),color:"#EF4444","&:hover":{bgcolor:"#EF4444",color:"#fff"}},children:e.jsx(Ht,{fontSize:"small"})})]})})]}),pr=()=>{const b=Wo(),L=new URLSearchParams(window.location.search).get("id"),Q=!!L,ae=["Marriage","Engagement","Birthday","Anniversary","Promotion","Other"],ke=["Weight","Ingredient"],tt={Weight:["0.5Kg","1 Kg","2 Kg","3 Kg","5 Kg+"],Ingredient:["Egg","Eggless"]},Yt=["0.5Kg","1 Kg","2 Kg","3 Kg","5 Kg+"],[qt,Qt]=l.useState(!0),[ot,rt]=l.useState(!1),[it,Xt]=l.useState(""),[st,We]=l.useState(""),[nt,Zt]=l.useState([]),[at,eo]=l.useState([]),[j,to]=l.useState(null),[N,lt]=l.useState("product"),[_,G]=l.useState([]),[oo,K]=l.useState([]),[ro,ue]=l.useState(!1),[A,fe]=l.useState(null),Fe=l.useRef(null),$=l.useRef(null),Ie=l.useRef(null),[Ee,dt]=l.useState(!1),[me,io]=l.useState(null),so="AIzaSyAfLUm1kPmeMkHh1Hr5nbgNpQJOsNa7B78",[y,T]=l.useState({latitude:"",longitude:"",address:""}),[M,ct]=l.useState(26),le=l.useRef(null),[xt,no]=l.useState([]),[Ae,Re]=l.useState(""),[pt,Be]=l.useState(""),[U,ze]=l.useState(""),[$e,Te]=l.useState([]),[De,Pe]=l.useState([]),[ao,ht]=l.useState("Eggless"),[gt,Le]=l.useState(""),[lo,Xo]=l.useState(""),[ut,_e]=l.useState("Kg"),[ft,Me]=l.useState(""),[mt,Oe]=l.useState(!1),[Ne,de]=l.useState([]),[co,be]=l.useState(!1),[bt,jt]=l.useState(""),[yt,St]=l.useState(tt.Weight),[ce,xo]=l.useState(""),[H,po]=l.useState("no_discount"),[Ge,ho]=l.useState(""),[w,je]=l.useState({Weight:[],Ingredient:[]}),[Ke,D]=l.useState([]),[ye,go]=l.useState(["Weight","Ingredient"]),[Ct,wt]=l.useState([]),[u,R]=l.useState({free:!1,flatRate:!1,takeaway:!1,takeawayLocation:"",price:""}),[V,Ue]=l.useState(null),[Se,vt]=l.useState(""),[J,He]=l.useState([]),[X,kt]=l.useState([]),[Wt,uo]=l.useState([]);l.useEffect(()=>{(async()=>{var o,s,a,p,g,h,d,f,Y,Ce,At,Rt,Bt,zt,$t,Tt,Dt,Pt,Lt,_t;try{const Ye=localStorage.getItem("vendor")||localStorage.getItem("user");let m=null;if(Ye&&(m=JSON.parse(Ye),to(m),!Q&&!L))try{const xe=localStorage.getItem("user"),x=xe?JSON.parse(xe):null,I=(x==null?void 0:x._id)||(x==null?void 0:x.id)||(m==null?void 0:m.user)||(m==null?void 0:m._id)||(m==null?void 0:m.id),pe=localStorage.getItem("token");console.log("ðŸ” Fetching vendor profile for userId:",I);const v=(o=(await B.get(`${k}/api/vendorprofiles/find/${I}`,{headers:{Authorization:`Bearer ${pe}`}})).data)==null?void 0:o.data;v!=null&&v.latitude&&(v!=null&&v.longitude)?(T({latitude:v.latitude.toString(),longitude:v.longitude.toString(),address:((s=v.storeAddress)==null?void 0:s.fullAddress)||""}),(a=v.storeAddress)!=null&&a.fullAddress&&R(qe=>({...qe,takeawayLocation:v.storeAddress.fullAddress})),console.log("âœ… Loaded vendor location from profile:",v.latitude,v.longitude)):m.latitude&&m.longitude&&(T({latitude:m.latitude,longitude:m.longitude,address:((p=m.storeAddress)==null?void 0:p.fullAddress)||""}),(g=m.storeAddress)!=null&&g.fullAddress&&R(qe=>({...qe,takeawayLocation:m.storeAddress.fullAddress})))}catch(xe){console.error("Failed to fetch vendor profile for location:",xe),m.latitude&&m.longitude&&(T({latitude:m.latitude,longitude:m.longitude,address:((h=m.storeAddress)==null?void 0:h.fullAddress)||""}),(d=m.storeAddress)!=null&&d.fullAddress&&R(x=>({...x,takeawayLocation:m.storeAddress.fullAddress})))}const Mt=localStorage.getItem("token"),vo=await B.get(`${k}/api/categories/parents/${et}`,{headers:{Authorization:`Bearer ${Mt}`}});if(Zt(((f=vo.data)==null?void 0:f.data)||[]),Q&&L){const x=(Y=(await B.get(`${k}/api/cakes/${L}`,{headers:{Authorization:`Bearer ${Mt}`}})).data)==null?void 0:Y.data;if(x&&(Re(x.name||""),Be(x.shortDescription||""),ze(((Ce=x.category)==null?void 0:Ce._id)||x.category||""),Te((x.subCategories||[]).map(I=>I._id||I)),Pe(x.occasions||[]),ht(x.itemType||"Eggless"),Le((x.searchTags||[]).join(", ")),vt(x.thumbnail||""),kt(x.images||[]),R({free:((At=x.shipping)==null?void 0:At.free)||!1,flatRate:((Rt=x.shipping)==null?void 0:Rt.flatRate)||!1,takeaway:((Bt=x.shipping)==null?void 0:Bt.takeaway)||!1,takeawayLocation:((zt=x.shipping)==null?void 0:zt.takeawayLocation)||"",price:(($t=x.shipping)==null?void 0:$t.price)||""}),(Tt=x.shipping)!=null&&Tt.pickupLatitude&&((Dt=x.shipping)!=null&&Dt.pickupLongitude)&&(T({latitude:x.shipping.pickupLatitude.toString(),longitude:x.shipping.pickupLongitude.toString(),address:x.shipping.takeawayLocation||""}),x.shipping.deliveryRadius&&ct(Number(x.shipping.deliveryRadius))),(Pt=x.variations)!=null&&Pt.length&&D(x.variations.map((I,pe)=>({id:I._id||`old-${pe}`,name:I.name,price:I.price,image:I.image}))),wt(x.addons||[]),_e(x.unit||"Kg"),Me(x.weight||""),(_t=(Lt=x.relatedItems)==null?void 0:Lt.items)!=null&&_t.length)){const I=x.relatedItems.items.map(te=>te._id||te);G(I);const pe=x.relatedItems.items.filter(te=>typeof te=="object"&&te!==null);K(pe),lt(x.relatedItems.linkBy||"product")}}}catch{We("Failed to load initial data")}finally{Qt(!1)}})()},[L,Q]),l.useEffect(()=>{var o;if((o=window.google)!=null&&o.maps){dt(!0);return}const t=document.createElement("script");return t.src=`https://maps.googleapis.com/maps/api/js?key=${so}&libraries=places`,t.async=!0,t.defer=!0,t.onload=()=>dt(!0),document.head.appendChild(t),()=>{if(document.head.contains(t))try{document.head.removeChild(t)}catch{console.error("Error removing map script")}}},[]),l.useEffect(()=>{var t;Ee&&u.free&&((t=window.google)!=null&&t.maps)&&fo()},[Ee,u.free]);const fo=l.useCallback(()=>{if(!window.google||!Fe.current)return;const t={lat:y.latitude?parseFloat(y.latitude):25.2048,lng:y.longitude?parseFloat(y.longitude):55.2708},o=new window.google.maps.Map(Fe.current,{zoom:14,center:t,mapTypeControl:!1,streetViewControl:!1,fullscreenControl:!1});if(o.addListener("click",s=>{const a=s.latLng.lat(),p=s.latLng.lng();T(h=>({...h,latitude:a.toString(),longitude:p.toString()})),$.current&&$.current.setMap(null),$.current=new window.google.maps.Marker({position:{lat:a,lng:p},map:o,animation:window.google.maps.Animation.DROP}),new window.google.maps.Geocoder().geocode({location:{lat:a,lng:p}},(h,d)=>{d==="OK"&&h[0]&&(T(f=>({...f,address:h[0].formatted_address})),R(f=>({...f,takeawayLocation:h[0].formatted_address})))})}),le.current=new window.google.maps.Circle({strokeColor:"#2563EB",strokeOpacity:.8,strokeWeight:2,fillColor:"#2563EB",fillOpacity:.15,map:o,center:t,radius:M*1e3}),io(o),Ie.current&&!window.autocompleteInstance){const s=new window.google.maps.places.Autocomplete(Ie.current,{fields:["geometry","formatted_address"]});window.autocompleteInstance=s,s.addListener("place_changed",()=>{var g;const a=s.getPlace();if(!((g=a.geometry)!=null&&g.location))return;const p=a.geometry.location;$.current&&$.current.setMap(null),$.current=new window.google.maps.Marker({position:p,map:o,animation:window.google.maps.Animation.DROP}),T({latitude:p.lat().toString(),longitude:p.lng().toString(),address:a.formatted_address}),R(h=>({...h,takeawayLocation:a.formatted_address})),o.setCenter(p),o.setZoom(14)})}},[y.latitude,y.longitude,u.takeaway]),Ve=l.useRef(null),Ft=l.useCallback(async()=>{!y.latitude||!y.longitude||(Ve.current&&clearTimeout(Ve.current),Ve.current=setTimeout(async()=>{try{const t=localStorage.getItem("token"),o=await B.get(`${k}/api/pincodes/radius`,{params:{lat:y.latitude,lng:y.longitude,radius:M},headers:{Authorization:`Bearer ${t}`}});o.data.success&&no(o.data.data)}catch(t){console.error("Error fetching pincodes:",t)}},500))},[y.latitude,y.longitude,M]);l.useEffect(()=>{if(me&&le.current&&y.latitude&&y.longitude){const t=parseFloat(y.latitude),o=parseFloat(y.longitude),s={lat:t,lng:o};le.current.setCenter(s),le.current.setRadius(M*1e3),$.current?$.current.setPosition(s):$.current=new window.google.maps.Marker({position:s,map:me,animation:window.google.maps.Animation.DROP});const a=le.current.getBounds();a&&me.fitBounds(a),Ft()}},[y.latitude,y.longitude,M,me,Ft]),l.useEffect(()=>{(async()=>{const o=(j==null?void 0:j._id)||(j==null?void 0:j.id);if(o)try{const s=localStorage.getItem("token"),a=await B.get(`${k}/api/cake-addons/provider/${o}`,{headers:{Authorization:`Bearer ${s}`}});a.data.success&&uo(a.data.data||[])}catch(s){console.error("Error fetching addons:",s)}})()},[j]),l.useEffect(()=>{(async()=>{var o;if(U)try{const s=localStorage.getItem("token"),a=await B.get(`${k}/api/categories/parents/${U}/subcategories`,{headers:{Authorization:`Bearer ${s}`}});eo(((o=a.data)==null?void 0:o.data)||[])}catch(s){console.error(s)}})()},[U]);const Je=(t,o)=>{const s={...w,[t]:o};je(s);const a=ke.filter(g=>{var h;return((h=s[g])==null?void 0:h.length)>0});if(!a.length){D([]);return}const p=a.reduce((g,h)=>g.length===0?s[h].map(d=>[d]):g.flatMap(d=>s[h].map(f=>[...d,f])),[]);D(p.map((g,h)=>({id:`new-${h}`,name:g.join(" - "),price:ce||"",image:null,attributeValues:g})))},It=async()=>{var t;try{be(!0),fe(null);const o=localStorage.getItem("token"),s=(j==null?void 0:j._id)||(j==null?void 0:j.id);let a="";if(N==="product"){if(!s){console.error("Provider ID missing");return}a=`${k}/api/cakes/provider/${s}`}else a=`${k}/api/categories/parents/${et}`;const g=((t=(await B.get(a,{headers:{Authorization:`Bearer ${o}`}})).data)==null?void 0:t.data)||[];de(g),K(h=>{const d=[...h];return g.forEach(f=>{const Y=d.findIndex(Ce=>Ce._id===f._id);Y!==-1&&(d[Y]=f)}),d})}catch(o){console.error("Failed to load related items",o),de([])}finally{be(!1)}},mo=async t=>{var o;try{be(!0),fe(t);const s=localStorage.getItem("token"),p=((o=(await B.get(`${k}/api/cakes/category/${t._id}?limit=100`,{headers:{Authorization:`Bearer ${s}`}})).data)==null?void 0:o.data)||[];de(p),K(g=>{const h=[...g];return p.forEach(d=>{const f=h.findIndex(Y=>Y._id===d._id);f!==-1&&(h[f]=d)}),h})}catch(s){console.error("Failed to load cakes for category",s),de([])}finally{be(!1)}},bo=()=>{fe(null),It()},jo=t=>{St(o=>o.filter(s=>s!==t)),je(o=>{const s={...o,Weight:o.Weight.filter(g=>g!==t)},a=ke.filter(g=>{var h;return((h=s[g])==null?void 0:h.length)>0});if(!a.length)return D([]),s;const p=a.reduce((g,h)=>g.length===0?s[h].map(d=>[d]):g.flatMap(d=>s[h].map(f=>[...d,f])),[]);return D(p.map((g,h)=>({id:`new-${h}`,name:g.join(" - "),price:ce||"",image:null}))),s})},Z=Number(ce||0),Et=Number(Ge||0);let ee=Z;H==="percentage"&&(ee=Z-Z*Et/100),H==="flat"&&(ee=Z-Et),ee=Math.max(ee,0);const yo=t=>{wt(o=>o.find(a=>a.addonId===t)?o.filter(a=>a.addonId!==t):[...o,{addonId:t,selectedItems:[]}])},So=()=>{Re(""),Be(""),ze(""),Te([]),Pe([]),_e("Kg"),Me(""),ht("Eggless"),Le(""),Ue(null),He([]),D([]),je({Weight:[],Ingredient:[]}),G([]),K([]),fe(null),window.scrollTo({top:0,behavior:"smooth"})},Co=async()=>{var g,h;const t=(j==null?void 0:j._id)||(j==null?void 0:j.id);if(!t||!Ae||!U||!V&&!Se){We("Missing required fields");return}const o=new FormData;o.append("name",Ae),o.append("shortDescription",pt),o.append("category",U),o.append("module",et),o.append("uom",ut),o.append("weight",ft),o.append("itemType",ao),o.append("provider",t),o.append("subCategories",JSON.stringify($e)),o.append("occasions",JSON.stringify(De)),o.append("searchTags",JSON.stringify(gt.split(",").map(d=>d.trim()).filter(Boolean))),o.append("addons",JSON.stringify(Ct)),o.append("shipping",JSON.stringify({...u,pickupLatitude:y.latitude,pickupLongitude:y.longitude,deliveryRadius:M})),o.append("prepTime",lo),o.append("basePrice",ce||0),o.append("discountType",H),o.append("discountValue",Ge||0);const s=Object.keys(w).filter(d=>w[d]&&w[d].length>0).map(d=>({name:d,values:w[d]}));o.append("attributes",JSON.stringify(s)),o.append("relatedItems",JSON.stringify({linkBy:N,items:_,linkByRef:N==="product"?"Cake":"Category"}));let a=0;const p=Ke.filter(d=>d.price).map(d=>{const f={name:d.name,price:Number(d.price),attributeValues:d.attributeValues||[]};return d.image&&(typeof d.image=="string"?f.image=d.image:d.image instanceof File&&(f.image=`VAR_FILE_${a}`,o.append("variationImages",d.image),a++)),f});p.length&&o.append("variations",JSON.stringify(p)),V&&o.append("thumbnail",V),J.forEach(d=>o.append("images",d));try{rt(!0);const d=localStorage.getItem("token");(Q?await B.put(`${k}/api/cakes/${L}`,o,{headers:{Authorization:`Bearer ${d}`}}):await B.post(`${k}/api/cakes`,o,{headers:{Authorization:`Bearer ${d}`}})).data.success&&(Xt("Saved successfully!"),setTimeout(()=>b("/cake/packagelist"),2e3))}catch(d){We(((h=(g=d.response)==null?void 0:g.data)==null?void 0:h.message)||"Error saving cake")}finally{rt(!1),window.scrollTo({top:0,behavior:"smooth"})}},wo=t=>{let o=u.takeawayLocation;if(t&&!o&&j){const s=j.storeAddress||j.address;s&&(typeof s=="string"?o=s:o=s.fullAddress||`${s.street?s.street+", ":""}${s.city?s.city+", ":""}${s.state||""}`.trim().replace(/, *$/,""))}R({...u,takeaway:t,takeawayLocation:o})};return qt?e.jsx(i,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:"80vh"},children:e.jsx(we,{color:"inherit",sx:{color:r}})}):e.jsxs(i,{sx:{bgcolor:"#FDFDFF",minHeight:"100vh",pb:10},children:[e.jsx(i,{children:e.jsx(i,{sx:{maxWidth:"1400px",margin:"0 auto",display:"flex",justifyContent:"space-between",alignItems:"center"}})}),e.jsxs(i,{sx:{width:"100%",margin:"48px auto",px:{xs:2,md:4}},children:[it&&e.jsx(Ot,{severity:"success",sx:{mb:4,borderRadius:"20px",fontWeight:800,border:"none",boxShadow:"0px 10px 30px rgba(76, 175, 80, 0.1)"},children:it}),st&&e.jsx(Ot,{severity:"error",sx:{mb:4,borderRadius:"20px",fontWeight:800,border:"none",boxShadow:"0px 10px 30px rgba(244, 67, 54, 0.1)"},children:st}),e.jsxs(q,{children:[e.jsx(re,{children:"General Information"}),e.jsx(ie,{children:"Define the fundamental details that describe your cake creation."}),e.jsxs(z,{spacing:4,children:[e.jsxs(i,{children:[e.jsx(n,{variant:"body2",sx:{mb:1.5,fontWeight:800,color:"#374151",textTransform:"uppercase",fontSize:"12px",letterSpacing:"1px"},children:"Product Name"}),e.jsx(E,{fullWidth:!0,placeholder:"e.g. Midnight Chocolate Ganache Cake",value:Ae,onChange:t=>Re(t.target.value)})]}),e.jsxs(i,{children:[e.jsx(n,{variant:"body2",sx:{mb:1.5,fontWeight:800,color:"#374151",textTransform:"uppercase",fontSize:"12px",letterSpacing:"1px"},children:"Full Description"}),e.jsx(E,{fullWidth:!0,multiline:!0,rows:4,placeholder:"Describe the rich textures, premium ingredients, and the flavor experience...",value:pt,onChange:t=>Be(t.target.value)})]}),e.jsx(i,{sx:{width:"100%"},children:e.jsxs(S,{container:!0,spacing:3,children:[e.jsxs(S,{item:!0,xs:12,md:3,children:[e.jsx(n,{variant:"body2",sx:{mb:1.5,fontWeight:800,color:"#374151",textTransform:"uppercase",fontSize:"11px",letterSpacing:"1px"},children:"Parent Category"}),e.jsx(he,{fullWidth:!0,children:e.jsxs(se,{fullWidth:!0,value:U,onChange:t=>ze(t.target.value),displayEmpty:!0,children:[e.jsx(C,{disabled:!0,value:"",children:"Select the primary category"}),nt.map(t=>e.jsx(C,{value:t._id,children:t.title},t._id))]})})]}),e.jsxs(S,{item:!0,xs:12,md:4,children:[e.jsx(n,{variant:"body2",sx:{mb:1.5,fontWeight:800,color:"#374151",textTransform:"uppercase",fontSize:"11px",letterSpacing:"1px"},children:"Subcategories"}),e.jsx(he,{fullWidth:!0,disabled:!U,children:e.jsxs(se,{fullWidth:!0,multiple:!0,value:$e,onChange:t=>Te(t.target.value),renderValue:t=>t.length===0?e.jsx(n,{sx:{color:"#9CA3AF",fontWeight:600,fontSize:"15px"},children:"Choose related tags"}):e.jsx(i,{sx:{display:"flex",flexWrap:"wrap",gap:1},children:t.map(o=>{var s;return e.jsx(O,{label:((s=at.find(a=>a._id===o))==null?void 0:s.title)||o,size:"small",sx:{borderRadius:"10px",fontWeight:800,bgcolor:"white",border:"1px solid #E5E7EB",color:r}},o)})}),displayEmpty:!0,children:[e.jsx(C,{disabled:!0,value:"",children:"Choose related tags"}),at.map(t=>e.jsxs(C,{value:t._id,children:[e.jsx(ve,{checked:$e.includes(t._id),size:"small",sx:{color:r,"&.Mui-checked":{color:r}}}),e.jsx(Qe,{primary:t.title,primaryTypographyProps:{fontSize:"14px",fontWeight:700}})]},t._id))]})})]}),e.jsxs(S,{item:!0,xs:12,md:3,children:[e.jsx(n,{variant:"body2",sx:{mb:1.5,fontWeight:800,color:"#374151",textTransform:"uppercase",fontSize:"11px",letterSpacing:"1px"},children:"Select Unit"}),e.jsx(he,{fullWidth:!0,children:e.jsxs(se,{fullWidth:!0,value:ut,onChange:t=>_e(t.target.value),displayEmpty:!0,renderValue:t=>t||e.jsx(n,{sx:{color:"#9CA3AF",fontWeight:600},children:"Select unit"}),children:[e.jsx(C,{disabled:!0,value:"",children:"Select unit"}),e.jsx(C,{value:"Kg",children:"Kg"}),e.jsx(C,{value:"Gm",children:"Gm"}),e.jsx(C,{value:"Piece",children:"Piece"}),e.jsx(C,{value:"Litre",children:"Litre"})]})})]}),e.jsxs(S,{item:!0,xs:12,md:4,children:[e.jsx(n,{variant:"body2",sx:{mb:1.5,fontWeight:800,color:"#374151",textTransform:"uppercase",fontSize:"11px",letterSpacing:"1px"},children:"Weight"}),e.jsx(E,{fullWidth:!0,placeholder:"e.g. 1.5",value:ft,onChange:t=>Me(t.target.value)})]})]})}),e.jsxs(i,{children:[e.jsx(n,{variant:"body2",sx:{mb:1.5,fontWeight:800,color:"#374151",textTransform:"uppercase",fontSize:"12px",letterSpacing:"1px"},children:"Perfect for Occasions"}),e.jsx(he,{fullWidth:!0,children:e.jsxs(se,{multiple:!0,value:De,onChange:t=>Pe(t.target.value),displayEmpty:!0,renderValue:t=>t.length===0?e.jsx(n,{sx:{color:"#9CA3AF",fontWeight:600,fontSize:"15px"},children:"Select one or many occasions"}):e.jsx(i,{sx:{display:"flex",flexWrap:"wrap",gap:1},children:t.map(o=>e.jsx(O,{label:o,size:"small",sx:{borderRadius:"10px",fontWeight:800,bgcolor:c(r,.05),color:r,border:`1px solid ${c(r,.1)}`}},o))}),children:[e.jsx(C,{disabled:!0,value:"",children:"Select one or many occasions"}),ae.map(t=>e.jsxs(C,{value:t,children:[e.jsx(ve,{checked:De.includes(t),size:"small",sx:{color:r,"&.Mui-checked":{color:r}}}),e.jsx(Qe,{primary:t,primaryTypographyProps:{fontSize:"14px",fontWeight:700}})]},t))]})})]})]})]}),e.jsxs(q,{children:[e.jsx(re,{children:"Gallery "}),e.jsx(ie,{children:"High-resolution captures significantly increase conversion rates."}),e.jsxs(z,{spacing:5,children:[e.jsxs(i,{children:[e.jsxs(n,{variant:"body2",sx:{mb:2,fontWeight:800,color:"#374151",textTransform:"uppercase",fontSize:"12px",letterSpacing:"1px",display:"flex",alignItems:"center",gap:1},children:[e.jsx(Ut,{sx:{fontSize:16,color:"#F59E0B"}})," Thumbnail"]}),e.jsxs(Jo,{hasImage:V||Se,onClick:()=>document.getElementById("thumb-in").click(),children:[e.jsx("input",{id:"thumb-in",type:"file",hidden:!0,onChange:t=>Ue(t.target.files[0])}),V||Se?e.jsxs(i,{sx:{position:"relative",width:"100%",height:"100%"},children:[e.jsx("img",{src:V?URL.createObjectURL(V):Se,alt:"Main Cover",style:{width:"100%",height:"100%",objectFit:"cover"}}),e.jsxs(i,{sx:{position:"absolute",inset:0,bgcolor:"rgba(0,0,0,0.3)",opacity:0,transition:"0.3s",display:"flex",alignItems:"center",justifyContent:"center",gap:2,".MuiBox-root:hover &":{opacity:1}},children:[e.jsx(oe,{variant:"contained",sx:{bgcolor:"white",color:"black","&:hover":{bgcolor:"#f0f0f0"}},children:"Change Cover"}),e.jsx(P,{onClick:t=>{t.stopPropagation(),Ue(null),vt("")},sx:{bgcolor:"rgba(255,255,255,0.2)",color:"white","&:hover":{bgcolor:"#ef4444"}},children:e.jsx(Ht,{})})]})]}):e.jsxs(z,{alignItems:"center",spacing:3,children:[e.jsx(i,{sx:{width:80,height:80,borderRadius:"50%",bgcolor:"white",display:"flex",alignItems:"center",justifyContent:"center",boxShadow:"0 10px 30px rgba(0,0,0,0.06)"},children:e.jsx(Ze,{sx:{color:r,fontSize:36}})}),e.jsxs(i,{textAlign:"center",children:[e.jsx(n,{variant:"h5",sx:{fontWeight:800,color:"#111827",mb:.5},children:"Drop your main image here"}),e.jsx(n,{variant:"body2",sx:{color:"#6B7280",maxWidth:"300px"},children:"Supports JPG, PNG, WEBP. High resolution (1600x1200) recommended for best results."})]}),e.jsx(oe,{variant:"outlined",sx:{borderColor:"#E5E7EB",color:"#374151",borderRadius:"12px",textTransform:"none",fontWeight:700,"&:hover":{borderColor:r,color:r,bgcolor:"transparent"}},children:"Browse Files"})]})]})]}),e.jsx(i,{children:e.jsxs(i,{sx:{mt:2},children:[e.jsx(n,{variant:"body2",sx:{mb:2.5,fontWeight:800,color:"#374151",textTransform:"uppercase",fontSize:"12px",letterSpacing:"1px"},children:"Gallery Collection (Max 10)"}),e.jsxs(Yo,{onClick:t=>{document.getElementById("gall-in").click()},sx:{p:3,alignItems:X.length+J.length>0?"flex-start":"center",justifyContent:X.length+J.length>0?"flex-start":"center"},children:[e.jsx("input",{id:"gall-in",type:"file",hidden:!0,multiple:!0,accept:"image/*",onChange:t=>{const o=Array.from(t.target.files);if(X.length+J.length+o.length>10){alert("You can only upload a maximum of 10 images.");return}He(a=>[...a,...o]),t.target.value=null}}),X.length===0&&J.length===0?e.jsxs(e.Fragment,{children:[e.jsx(i,{sx:{width:70,height:70,borderRadius:"50%",bgcolor:"#E3F2FD",display:"flex",alignItems:"center",justifyContent:"center",mb:2},children:e.jsx(Ze,{sx:{color:"#2196F3",fontSize:36}})}),e.jsx(n,{variant:"h6",sx:{color:r,fontWeight:800},children:"Click to Upload Images"}),e.jsx(n,{variant:"caption",sx:{color:"#9CA3AF",fontWeight:600,mt:1},children:"Supported: JPG, PNG, WEBP"})]}):e.jsxs(i,{sx:{display:"flex",flexWrap:"wrap",gap:2},onClick:t=>t.stopPropagation(),children:[X.map((t,o)=>e.jsxs(i,{sx:{width:80,height:80,borderRadius:"12px",overflow:"hidden",position:"relative",border:"1px solid #E5E7EB"},children:[e.jsx("img",{src:t,alt:`gallery-${o}`,style:{width:"100%",height:"100%",objectFit:"cover"}}),e.jsx(P,{size:"small",onClick:()=>kt(s=>s.filter((a,p)=>p!==o)),sx:{position:"absolute",top:2,right:2,bgcolor:"rgba(0,0,0,0.6)",color:"white",p:.5,"&:hover":{bgcolor:"#ef4444"}},children:e.jsx(ge,{sx:{fontSize:14}})})]},`exist-${o}`)),J.map((t,o)=>e.jsxs(i,{sx:{width:80,height:80,borderRadius:"12px",overflow:"hidden",position:"relative",border:"1px solid #E5E7EB"},children:[e.jsx("img",{src:URL.createObjectURL(t),alt:`preview-${o}`,style:{width:"100%",height:"100%",objectFit:"cover"}}),e.jsx(P,{size:"small",onClick:()=>He(s=>s.filter((a,p)=>p!==o)),sx:{position:"absolute",top:2,right:2,bgcolor:"rgba(0,0,0,0.6)",color:"white",p:.5,"&:hover":{bgcolor:"#ef4444"}},children:e.jsx(ge,{sx:{fontSize:14}})})]},`new-${o}`)),X.length+J.length<10&&e.jsx(i,{onClick:()=>document.getElementById("gall-in").click(),sx:{width:80,height:80,borderRadius:"12px",border:`2px dashed ${c(r,.3)}`,display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer"},children:e.jsx(Ze,{sx:{color:r}})})]})]})]})})]})]}),e.jsxs(q,{children:[e.jsx(re,{children:"Pricing & Intelligent Variations"}),e.jsx(ie,{children:"Configure smart pricing tiers based on user-selected preferences."}),e.jsxs(i,{sx:{mb:5,p:5,borderRadius:"32px",bgcolor:c(r,.01),border:`2.5px solid ${c(r,.05)}`,position:"relative",overflow:"hidden"},children:[e.jsx(i,{sx:{position:"absolute",top:0,right:0,width:"200px",height:"100%",background:`linear-gradient(to left, ${c(r,.03)}, transparent)`,pointerEvents:"none"}}),e.jsxs(n,{variant:"h6",sx:{mb:4,fontWeight:900,color:"#111827",display:"flex",alignItems:"center",justifyContent:"center",gap:2,fontSize:"20px",textAlign:"center"},children:[e.jsx(Po,{sx:{color:r}}),"Variant Configuration"]}),e.jsxs(i,{sx:{p:4,borderRadius:2,border:"1px solid #E5E7EB",bgcolor:"#FFFFFF"},children:[e.jsx(n,{sx:{fontWeight:700,fontSize:18,mb:1},children:"Variant Details"}),e.jsx(n,{sx:{color:"#6B7280",fontSize:14,mb:3},children:"Choose the Attributes & Input Values Of Each Attribute"}),e.jsx(he,{fullWidth:!0,children:e.jsx(se,{multiple:!0,value:ye,onChange:t=>{const o=t.target.value;go(o),je(s=>({Weight:o.includes("Weight")?s.Weight:[],Ingredient:o.includes("Ingredient")?s.Ingredient:[]}))},renderValue:t=>e.jsx(i,{sx:{display:"flex",gap:1,flexWrap:"wrap"},children:t.map(o=>e.jsx(O,{label:o,sx:{fontWeight:700}},o))}),children:ke.map(t=>e.jsxs(C,{value:t,children:[e.jsx(ve,{checked:ye.includes(t)}),e.jsx(Qe,{primary:t})]},t))})}),e.jsxs(i,{sx:{mt:4},children:[e.jsx(n,{sx:{fontWeight:600,mb:2},children:"Values of Each Attribute"}),ye.includes("Weight")&&e.jsxs(i,{sx:{display:"flex",alignItems:"flex-start",border:"1px solid #E5E7EB",borderRadius:2,mb:2,overflow:"hidden"},children:[e.jsx(i,{sx:{px:2.5,py:2,bgcolor:"#E5E7EB",fontWeight:700,minWidth:160},children:"Select Weight"}),e.jsxs(i,{sx:{p:2,flex:1},children:[e.jsxs(i,{sx:{display:"flex",gap:1,flexWrap:"wrap"},children:[yt.map(t=>{const o=w.Weight.includes(t),s=!Yt.includes(t);return e.jsx(O,{label:t,onClick:()=>Je("Weight",o?w.Weight.filter(a=>a!==t):[...w.Weight,t]),onDelete:s?()=>jo(t):void 0,variant:o?"filled":"outlined",sx:{fontWeight:700,bgcolor:o?c(r,.15):void 0,color:o?r:void 0,borderColor:o?r:void 0}},t)}),!mt&&e.jsx(O,{label:"+ Add Weight",onClick:()=>Oe(!0),sx:{fontWeight:800,color:r,border:`2px dashed ${c(r,.4)}`,bgcolor:c(r,.05),cursor:"pointer"}})]}),mt&&e.jsxs(i,{sx:{mt:2,p:2,borderRadius:2,border:`1.5px solid ${c(r,.3)}`,background:`linear-gradient(135deg, ${c(r,.05)}, #fff)`,display:"flex",alignItems:"center",gap:1.5,maxWidth:320},children:[e.jsx(Vt,{size:"small",autoFocus:!0,placeholder:"e.g. 6 Kg",value:bt,onChange:t=>jt(t.target.value),sx:{flex:1}}),e.jsx(oe,{variant:"contained",sx:{bgcolor:r,fontWeight:800},onClick:()=>{const t=bt.trim();!t||yt.includes(t)||(St(o=>[...o,t]),Je("Weight",[...w.Weight,t]),jt(""),Oe(!1))},children:"Add"}),e.jsx(P,{onClick:()=>Oe(!1),children:e.jsx(ge,{})})]})]})]}),ye.includes("Ingredient")&&e.jsxs(i,{sx:{display:"flex",alignItems:"center",border:"1px solid #E5E7EB",borderRadius:1,overflow:"hidden"},children:[e.jsx(i,{sx:{px:2.5,py:1.5,bgcolor:"#E5E7EB",fontWeight:600,minWidth:160},children:"Select Ingredient"}),e.jsx(i,{sx:{p:1.5,display:"flex",gap:1,flexWrap:"wrap"},children:tt.Ingredient.map(t=>e.jsx(O,{label:t,onClick:()=>Je("Ingredient",w.Ingredient.includes(t)?w.Ingredient.filter(o=>o!==t):[...w.Ingredient,t]),variant:w.Ingredient.includes(t)?"filled":"outlined",sx:{fontWeight:600}},t))})]})]})]})]}),e.jsxs(i,{sx:{mb:6,p:5,borderRadius:"32px",background:`linear-gradient(180deg, #ffffff, ${c(r,.04)})`,border:`1.5px solid ${c(r,.15)}`,boxShadow:"0 20px 60px rgba(0,0,0,0.04)"},children:[e.jsxs(S,{container:!0,spacing:4,children:[e.jsxs(S,{item:!0,xs:12,md:4,children:[e.jsx(n,{sx:{mb:1.5,fontWeight:800,fontSize:"13px",textTransform:"uppercase",color:"#374151"},children:"Base Price"}),e.jsx(E,{fullWidth:!0,placeholder:"0.00",value:ce,onChange:t=>xo(t.target.value),InputProps:{startAdornment:e.jsx(n,{sx:{mr:1,fontWeight:900,color:"#9CA3AF"},children:"â‚¹"})}})]}),e.jsxs(S,{item:!0,xs:12,md:4,children:[e.jsx(n,{sx:{mb:1.5,fontWeight:800,fontSize:"13px",textTransform:"uppercase",color:"#374151"},children:"Discount Type"}),e.jsxs(se,{fullWidth:!0,value:H,onChange:t=>po(t.target.value),children:[e.jsx(C,{value:"no_discount",children:"No Discount"}),e.jsx(C,{value:"percentage",children:"Percentage (%)"}),e.jsx(C,{value:"flat",children:"Flat Amount (â‚¹)"})]})]}),e.jsxs(S,{item:!0,xs:12,md:4,children:[e.jsx(n,{sx:{mb:1.5,fontWeight:800,fontSize:"13px",textTransform:"uppercase",color:"#374151"},children:"Discount Value"}),e.jsx(E,{fullWidth:!0,placeholder:H==="percentage"?"e.g. 10%":"e.g. 50",value:Ge,onChange:t=>ho(t.target.value)})]})]}),e.jsx(Fo,{sx:{my:5}}),e.jsxs(i,{sx:{p:4,borderRadius:"24px",bgcolor:"#ffffff",border:`2px dashed ${c(r,.3)}`,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs(i,{children:[e.jsx(n,{sx:{fontWeight:900,fontSize:"18px",color:"#111827"},children:"Billing Summary"}),e.jsx(n,{sx:{mt:.5,fontSize:"14px",color:"#6B7280"},children:"Final amount after discount"})]}),e.jsxs(i,{textAlign:"right",children:[H!=="no_discount"&&e.jsxs(n,{sx:{fontSize:"14px",fontWeight:700,color:"#6B7280",textDecoration:"line-through"},children:["â‚¹ ",Z.toFixed(2)]}),e.jsxs(n,{sx:{fontSize:"32px",fontWeight:900,color:r,lineHeight:1.1},children:["â‚¹ ",ee.toFixed(2)]}),H!=="no_discount"&&e.jsxs(n,{sx:{fontSize:"13px",fontWeight:700,color:"#16A34A"},children:["You save â‚¹ ",(Z-ee).toFixed(2)]})]})]})]}),Ke.length>0&&e.jsx(qo,{children:e.jsxs(Lo,{children:[e.jsx(Mo,{children:e.jsxs(Jt,{sx:{bgcolor:c(r,.02)},children:[e.jsx(ne,{sx:{fontWeight:900,color:"#111827",fontSize:"14px",py:3,pl:4},children:"Variation Details"}),e.jsx(ne,{sx:{fontWeight:900,color:"#111827",fontSize:"14px",py:3},children:"Market Listing Price"}),e.jsx(ne,{sx:{fontWeight:900,color:"#111827",fontSize:"14px",py:3,pr:4},children:"Display Media"})]})}),e.jsx(_o,{children:Ke.map(t=>e.jsx(Qo,{variation:t,onChange:(o,s)=>D(a=>a.map(p=>p.id===t.id?{...p,[o]:s}:p)),onImageUpload:o=>D(s=>s.map(a=>a.id===t.id?{...a,image:o}:a)),onDelete:()=>D(o=>o.filter(s=>s.id!==t.id))},t.id))})]})})]}),e.jsxs(q,{children:[e.jsxs(i,{sx:{mb:6,textAlign:"center"},children:[e.jsx(re,{sx:{fontSize:28},children:"Curated Boosters & Add-ons"}),e.jsx(ie,{sx:{maxWidth:720,mx:"auto",mt:1},children:"Group related extras to enhance the customer's celebration experience"})]}),Wt.length===0?e.jsxs(i,{sx:{textAlign:"center",p:4,bgcolor:"#F9FAFB",borderRadius:"20px",border:"1px dashed #E5E7EB"},children:[e.jsx(n,{variant:"h6",sx:{color:"#6B7280",fontWeight:700},children:"No Add-ons Available"}),e.jsx(n,{variant:"body2",sx:{color:"#9CA3AF",mt:1},children:'Create add-ons in the "Add-ons" management section to see them here.'})]}):e.jsx(i,{sx:{display:"flex",flexWrap:"wrap",gap:3,justifyContent:"flex-start"},children:Wt.map(t=>{const o=Ct.some(s=>s.addonId===t._id);return e.jsxs(i,{onClick:()=>yo(t._id),sx:{width:"330px",flexShrink:0,position:"relative",borderRadius:"24px",cursor:"pointer",bgcolor:o?c(r,.04):"#ffffff",border:"2px solid",borderColor:o?r:"#F1F5F9",boxShadow:o?`0 12px 28px ${c(r,.15)}`:"0 8px 24px rgba(17,24,39,0.04)",transition:"all 0.4s cubic-bezier(0.4, 0, 0.2, 1)",overflow:"hidden",display:"flex",flexDirection:"column","&:hover":{transform:"translateY(-10px)",borderColor:o?r:c(r,.4),boxShadow:o?`0 25px 50px ${c(r,.25)}`:"0 20px 45px rgba(17,24,39,0.1)","& .addon-img":{transform:"scale(1.1)"}}},children:[o&&e.jsx(i,{sx:{position:"absolute",top:14,right:14,width:32,height:32,bgcolor:r,borderRadius:"12px",display:"flex",alignItems:"center",justifyContent:"center",color:"white",zIndex:2,boxShadow:`0 8px 16px ${c(r,.4)}`,animation:"scaleIn 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)"},children:e.jsx(Ut,{sx:{fontSize:18}})}),e.jsxs(i,{sx:{width:"100%",height:180,bgcolor:"#F9FAFB",overflow:"hidden",position:"relative"},children:[t.image?e.jsx("img",{src:t.image,alt:t.title,className:"addon-img",style:{width:"100%",height:"100%",objectFit:"cover",transition:"transform 0.6s cubic-bezier(0.4, 0, 0.2, 1)"}}):e.jsx(i,{sx:{display:"flex",alignItems:"center",justifyContent:"center",height:"100%",color:"#CBD5E1"},children:e.jsx(Oo,{sx:{fontSize:48}})}),e.jsx(i,{sx:{position:"absolute",inset:0,background:o?c(r,.1):"transparent",transition:"0.3s"}})]}),e.jsxs(i,{sx:{p:2.5,textAlign:"center",flexGrow:1,display:"flex",flexDirection:"column",justifyContent:"space-between"},children:[e.jsx(n,{sx:{fontWeight:900,fontSize:"15px",color:o?r:"#111827",mb:1,lineHeight:1.3,letterSpacing:"-0.01em",minHeight:"40px",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden"},children:t.title}),e.jsx(i,{sx:{display:"flex",justifyContent:"center",alignItems:"center"},children:e.jsxs(n,{variant:"h6",sx:{fontWeight:900,color:o?r:"#6B7280",fontSize:"18px",letterSpacing:"-0.02em",position:"relative","&::after":o?{content:'""',position:"absolute",bottom:-2,left:"50%",transform:"translateX(-50%)",width:"20px",height:"2px",bgcolor:r,borderRadius:"2px"}:{}},children:["â‚¹",t.price]})})]})]},t._id)})})]}),e.jsxs(q,{children:[e.jsx(re,{children:"Shipping"}),e.jsx(ie,{children:"Ensure your cake arrives safely with precise delivery controls."}),e.jsxs(S,{container:!0,spacing:4,children:[e.jsxs(S,{item:!0,xs:12,children:[e.jsxs(i,{sx:{p:3.5,borderRadius:"24px",border:`2px solid ${u.free?r:"#F3F4F6"}`,display:"flex",justifyContent:"space-between",alignItems:"center",transition:"all 0.3s ease","&:hover":{borderColor:r,bgcolor:c(r,.01)}},children:[e.jsxs(z,{direction:"row",spacing:2.5,alignItems:"center",children:[e.jsx(i,{sx:{bgcolor:c(r,.1),p:1.5,borderRadius:"14px"},children:e.jsx(No,{sx:{color:r}})}),e.jsxs(i,{children:[e.jsx(n,{sx:{fontWeight:900,fontSize:"15px"},children:"Home Delivery"}),e.jsx(n,{variant:"caption",sx:{color:"#6B7280"},children:u.free?u.flatRate?"Paid Delivery Enabled":"Complimentary Delivery Enabled":"Enable Doorstep Delivery"})]})]}),e.jsx(Xe,{checked:u.free,onChange:t=>R({...u,free:t.target.checked})})]}),u.free&&e.jsxs(z,{spacing:3,sx:{mt:3},children:[e.jsxs(i,{sx:{p:3,borderRadius:"22px",border:`2px solid ${u.flatRate?r:"#F3F4F6"}`,display:"flex",justifyContent:"space-between",alignItems:"center",bgcolor:u.flatRate?c(r,.02):"#fff"},children:[e.jsxs(z,{direction:"row",spacing:2,alignItems:"center",children:[e.jsx(Vo,{sx:{color:r,fontSize:20}}),e.jsxs(i,{children:[e.jsx(n,{sx:{fontWeight:800,fontSize:"14px"},children:"Standard Flat Rate"}),e.jsx(n,{variant:"caption",children:"Charge customer for delivery"})]})]}),e.jsx(Xe,{size:"small",checked:u.flatRate,onChange:t=>R({...u,flatRate:t.target.checked,price:t.target.checked?u.price:0})})]}),u.flatRate&&e.jsx(E,{fullWidth:!0,label:"Flat Rate amount",placeholder:"0.00",value:u.price,onChange:t=>R({...u,price:t.target.value}),InputProps:{startAdornment:e.jsx(n,{sx:{mr:1,fontWeight:700,color:"#9CA3AF"},children:"â‚¹"})}})]})]}),e.jsx(S,{item:!0,xs:12,children:e.jsxs(i,{sx:{p:3.5,borderRadius:"24px",border:`2px solid ${u.takeaway?r:"#F3F4F6"}`,display:"flex",justifyContent:"space-between",alignItems:"center",transition:"all 0.3s ease","&:hover":{borderColor:r,bgcolor:c(r,.01)}},children:[e.jsxs(z,{direction:"row",spacing:2.5,alignItems:"center",children:[e.jsx(i,{sx:{bgcolor:c(r,.1),p:1.5,borderRadius:"14px"},children:e.jsx(Go,{sx:{color:r}})}),e.jsxs(i,{children:[e.jsx(n,{sx:{fontWeight:900,fontSize:"15px"},children:"Takeaway / Pickup"}),e.jsx(n,{variant:"caption",sx:{color:"#6B7280"},children:"Allow customer to collect from store"})]})]}),e.jsx(Xe,{checked:u.takeaway,onChange:t=>wo(t.target.checked)})]})}),u.free&&e.jsx(S,{item:!0,xs:12,children:e.jsxs(i,{sx:{mt:3,p:0,borderRadius:"24px",bgcolor:"#FFFFFF",border:"1px solid #E5E7EB",boxShadow:"0 10px 40px rgba(0,0,0,0.03)",overflow:"hidden"},children:[e.jsx(i,{sx:{p:{xs:2,md:4},pb:2},children:e.jsxs(z,{spacing:3,children:[e.jsxs(i,{children:[e.jsx(n,{sx:{mb:1.5,fontWeight:800,color:"#374151",textTransform:"uppercase",fontSize:"11px",letterSpacing:"1px"},children:"Search Pickup Location"}),e.jsx(E,{fullWidth:!0,inputRef:Ie,placeholder:"Search for your store location or landmark..."})]}),e.jsxs(n,{variant:"body2",sx:{color:"#6B7280",fontWeight:600,display:"flex",alignItems:"center",gap:1},children:[e.jsx(Ko,{fontSize:"small",sx:{color:r}}),"Click on the map to pin the exact pickup location for customers"]})]})}),Ee?e.jsxs(i,{sx:{position:"relative",width:"100%",height:500,borderRadius:"20px",overflow:"hidden",border:"1px solid #E5E7EB"},children:[e.jsx(i,{ref:Fe,sx:{width:"100%",height:"100%"}}),e.jsxs(i,{sx:{position:"absolute",bottom:20,left:20,right:20,zIndex:10,bgcolor:"rgba(255, 255, 255, 0.95)",backdropFilter:"blur(10px)",borderRadius:"16px",p:2.5,boxShadow:"0 8px 32px rgba(0,0,0,0.1)",display:"flex",alignItems:"center",gap:3,maxWidth:"500px",margin:"0 auto"},children:[e.jsxs(n,{sx:{fontWeight:800,color:"#1F2937",minWidth:"80px"},children:["Radius: ",M," km"]}),e.jsx(Io,{value:M,min:1,max:100,onChange:(t,o)=>ct(o),sx:{color:"#2563EB",height:6,"& .MuiSlider-thumb":{width:20,height:20,backgroundColor:"#fff",border:"2px solid currentColor","&:hover":{boxShadow:"0 0 0 8px rgba(37, 99, 235, 0.16)"}},"& .MuiSlider-track":{border:"none"},"& .MuiSlider-rail":{opacity:.3,backgroundColor:"#bfbfbf"}}}),xt.length>0&&e.jsx(O,{label:`${xt.length} Pincodes`,size:"small",color:"primary",sx:{fontWeight:700,borderRadius:"8px"}})]})]}):e.jsxs(i,{sx:{height:400,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",border:"1px solid #E5E7EB",borderRadius:"20px",bgcolor:"#F9FAFB"},children:[e.jsx(we,{sx:{color:r,mb:2}}),e.jsx(n,{sx:{fontWeight:700,color:"#6B7280"},children:"Initializing Map Engine..."})]}),e.jsx(i,{sx:{p:{xs:2,md:4},pt:2},children:e.jsxs(S,{container:!0,spacing:3,children:[e.jsx(S,{item:!0,xs:12,children:e.jsxs(z,{direction:"row",spacing:2,children:[e.jsxs(i,{sx:{flex:1},children:[e.jsx(n,{sx:{mb:1,fontWeight:800,color:"#374151",textTransform:"uppercase",fontSize:"11px"},children:"Latitude"}),e.jsx(E,{value:y.latitude,onChange:t=>T(o=>({...o,latitude:t.target.value})),placeholder:"0.0000",disabled:!0})]}),e.jsxs(i,{sx:{flex:1},children:[e.jsx(n,{sx:{mb:1,fontWeight:800,color:"#374151",textTransform:"uppercase",fontSize:"11px"},children:"Longitude"}),e.jsx(E,{value:y.longitude,onChange:t=>T(o=>({...o,longitude:t.target.value})),placeholder:"0.0000",disabled:!0})]})]})}),e.jsxs(S,{item:!0,xs:12,children:[e.jsx(n,{sx:{mb:1,fontWeight:800,color:"#374151",textTransform:"uppercase",fontSize:"11px",letterSpacing:"1px"},children:"Final Pickup Address"}),e.jsx(E,{multiline:!0,rows:2,value:u.takeawayLocation,onChange:t=>R({...u,takeawayLocation:t.target.value}),placeholder:"Pin on map or type full address here..."})]})]})})]})})]})]}),e.jsxs(q,{children:[e.jsx(re,{children:"Tags"}),e.jsx(ie,{children:"Boost discoverability with targeted keywords and meta-tags."}),e.jsxs(i,{children:[e.jsxs(n,{variant:"body2",sx:{mb:2,fontWeight:800,display:"flex",alignItems:"center",gap:1.5},children:[e.jsx(Uo,{sx:{color:r}})," Dynamic Search Tags (Use comma as separator)"]}),e.jsx(E,{fullWidth:!0,placeholder:"e.g. Birthday, Luxury Cake, Eggless, Anniversary Surprise",value:gt,onChange:t=>Le(t.target.value)})]})]}),e.jsxs(q,{sx:{mb:8},children:[e.jsxs(i,{sx:{mb:4},children:[e.jsxs(n,{sx:{fontSize:"22px",fontWeight:900,color:"#111827"},children:["Frequently Bought Together",e.jsx(n,{component:"span",sx:{ml:1,fontWeight:600,color:"#6B7280",fontSize:"14px"},children:"(Related Products)"})]}),e.jsx(n,{sx:{mt:1,fontSize:"14px",color:"#6B7280"},children:"Suggest complementary items to increase order value."})]}),e.jsxs(i,{sx:{p:3,mb:4,borderRadius:"16px",bgcolor:"#F9FAFB",display:"flex",alignItems:"center",gap:4},children:[e.jsx(n,{sx:{fontWeight:800,color:"#374151"},children:"Link by:"}),e.jsxs(Eo,{row:!0,value:N,onChange:t=>{lt(t.target.value),G([]),de([])},children:[e.jsx(Nt,{value:"product",control:e.jsx(Gt,{sx:{"&.Mui-checked":{color:r}}}),label:e.jsx(n,{sx:{fontWeight:700},children:"Product"})}),e.jsx(Nt,{value:"category",control:e.jsx(Gt,{sx:{"&.Mui-checked":{color:r}}}),label:e.jsx(n,{sx:{fontWeight:700},children:"Category"})})]})]}),e.jsxs(i,{onClick:()=>{It(),ue(!0)},sx:{p:6,borderRadius:"20px",border:`2px dashed ${c(r,.35)}`,bgcolor:"#FFFFFF",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",cursor:"pointer",transition:"all 0.3s ease","&:hover":{bgcolor:c(r,.03),borderColor:r,transform:"translateY(-2px)"}},children:[e.jsx(i,{sx:{width:56,height:56,borderRadius:"50%",bgcolor:c(r,.12),display:"flex",alignItems:"center",justifyContent:"center",mb:2},children:e.jsx(n,{sx:{fontSize:"28px",fontWeight:900,color:r},children:"+"})}),e.jsx(n,{sx:{fontSize:"18px",fontWeight:800,color:"#111827"},children:"Add Related Item"}),e.jsx(n,{sx:{mt:.5,fontSize:"13px",color:"#6B7280"},children:"Choose products or categories frequently bought together"})]}),_.length>0&&e.jsxs(i,{sx:{mt:4,display:"flex",flexDirection:"column",gap:2},children:[e.jsxs(n,{variant:"body2",sx:{fontWeight:800,color:"#374151",textTransform:"uppercase",fontSize:"11px",letterSpacing:"1px"},children:["Selected Items (",_.length,")"]}),e.jsx(S,{container:!0,spacing:2,children:_.map(t=>{var s;const o=oo.find(a=>a._id===t)||Ne.find(a=>a._id===t)||nt.find(a=>a._id===t);return o?e.jsx(S,{item:!0,xs:12,sm:6,md:4,children:e.jsxs(i,{sx:{display:"flex",alignItems:"center",p:1.5,borderRadius:"16px",bgcolor:"#F9FAFB",border:"1px solid #E5E7EB",position:"relative",transition:"all 0.2s","&:hover":{borderColor:r,bgcolor:"#fff",boxShadow:"0 4px 12px rgba(0,0,0,0.05)"}},children:[e.jsx(i,{sx:{width:50,height:50,borderRadius:"10px",overflow:"hidden",flexShrink:0,bgcolor:"#fff",border:"1px solid #eee"},children:e.jsx("img",{src:o.thumbnail||(o.image?o.image.startsWith("http")?o.image:`${k}${o.image}`:"/placeholder.png"),alt:"",style:{width:"100%",height:"100%",objectFit:"cover"}})}),e.jsxs(i,{sx:{ml:2,flex:1,minWidth:0},children:[e.jsx(n,{noWrap:!0,sx:{fontWeight:800,fontSize:"13px",color:"#111827"},children:o.name||o.title}),e.jsx(n,{variant:"caption",sx:{color:"#6B7280"},children:o.price?`â‚¹${o.price}`:((s=o.module)==null?void 0:s.title)||"Related"})]}),e.jsx(P,{size:"small",onClick:()=>{G(a=>a.filter(p=>p!==t)),K(a=>a.filter(p=>p._id!==t))},sx:{ml:1,color:"#9CA3AF","&:hover":{color:"#EF4444",bgcolor:c("#EF4444",.1)}},children:e.jsx(ge,{sx:{fontSize:16}})})]})},t):null})})]}),e.jsxs(i,{sx:{mt:6,pt:4,borderTop:"1px solid #E5E7EB",display:"flex",justifyContent:"flex-end",gap:2.5},children:[e.jsx(oe,{variant:"outlined",onClick:So,sx:{px:6,py:1.8,borderRadius:"18px",textTransform:"none",fontWeight:900,fontSize:"15px",color:"#374151",borderColor:"#D1D5DB","&:hover":{borderColor:r,color:r,bgcolor:c(r,.04)}},children:"Reset Form"}),e.jsx(oe,{variant:"contained",onClick:Co,disabled:ot,sx:{bgcolor:r,borderRadius:"18px",px:7,py:1.9,textTransform:"none",fontWeight:900,fontSize:"16px",boxShadow:`0px 18px 40px ${c(r,.4)}`,"&:hover":{bgcolor:"#D81B60",boxShadow:`0px 22px 50px ${c(r,.5)}`}},children:ot?e.jsx(we,{size:24,color:"inherit"}):"Publish Package"})]})]})]}),e.jsxs(Ao,{open:ro,onClose:()=>ue(!1),maxWidth:"sm",fullWidth:!0,children:[e.jsxs(Ro,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsxs(i,{sx:{display:"flex",alignItems:"center",gap:1},children:[A&&e.jsx(P,{size:"small",onClick:bo,sx:{mr:1},children:e.jsx(Kt,{})}),e.jsx(n,{variant:"h6",sx:{fontWeight:800},children:A?`Packages in ${A.title}`:`Select ${N==="product"?"Products":"Categories"}`})]}),e.jsx(P,{onClick:()=>ue(!1),size:"small",children:e.jsx(ge,{})})]}),e.jsx(Bo,{dividers:!0,children:co?e.jsx(i,{sx:{display:"flex",justifyContent:"center",py:4},children:e.jsx(we,{color:"inherit",sx:{color:r}})}):e.jsxs(e.Fragment,{children:[A&&e.jsxs(i,{sx:{mb:3,p:2,borderRadius:"16px",bgcolor:c(r,.03),border:`1px dashed ${r}`,display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsxs(i,{children:[e.jsx(n,{sx:{fontWeight:800,color:"#111827"},children:"Link Entire Category"}),e.jsxs(n,{variant:"caption",sx:{color:"#6B7280"},children:['Add "',A.title,'" to related items']})]}),e.jsx(ve,{checked:_.includes(A._id),onChange:()=>G(t=>t.includes(A._id)?t.filter(o=>o!==A._id):[...t,A._id]),sx:{color:r,"&.Mui-checked":{color:r}}})]}),Ne.length===0?e.jsx(i,{sx:{py:4,textAlign:"center"},children:e.jsx(n,{sx:{color:"#6B7280",fontWeight:600},children:A?"No packages found in this category":`No ${N}s found`})}):e.jsx(S,{container:!0,spacing:2,children:Ne.map(t=>{var p,g;const o=t._id,s=N==="category"&&!A,a=_.includes(o);return e.jsx(S,{item:!0,xs:12,children:e.jsxs(i,{onClick:()=>{s?mo(t):_.includes(o)?(G(d=>d.filter(f=>f!==o)),K(d=>d.filter(f=>f._id!==o))):(G(d=>[...d,o]),K(d=>[...d,t]))},sx:{display:"flex",gap:2,p:2,borderRadius:"14px",cursor:"pointer",border:a?`2px solid ${r}`:"1px solid #E5E7EB",bgcolor:a?c(r,.06):"#FFFFFF",transition:"all 0.25s ease","&:hover":{borderColor:r,boxShadow:`0 4px 12px ${c(r,.1)}`}},children:[e.jsx(i,{sx:{width:60,height:60,borderRadius:"10px",overflow:"hidden",flexShrink:0,bgcolor:"#F3F4F6"},children:e.jsx("img",{src:s?t.image?`${k}${t.image}`:"/placeholder.png":t.thumbnail||"/placeholder.png",alt:t.title||t.name,style:{width:"100%",height:"100%",objectFit:"cover"}})}),e.jsxs(i,{sx:{flex:1,minWidth:0},children:[e.jsx(n,{noWrap:!0,sx:{fontWeight:800,fontSize:"14px",color:"#111827",mb:.5},children:t.title||t.name}),e.jsx(n,{noWrap:!0,sx:{fontSize:"12px",color:"#6B7280"},children:s?((p=t.module)==null?void 0:p.title)||"Category":((g=t.category)==null?void 0:g.title)||"Package"})]}),e.jsxs(i,{sx:{display:"flex",alignItems:"center",gap:1},children:[t.price&&e.jsxs(n,{sx:{fontWeight:900,color:r,mr:1},children:["â‚¹",t.price]}),s?e.jsx(Kt,{sx:{transform:"rotate(180deg)",color:"#CBD5E1",fontSize:20}}):e.jsx(i,{sx:{width:22,height:22,borderRadius:"6px",border:`2px solid ${a?r:"#D1D5DB"}`,bgcolor:a?r:"transparent",display:"flex",alignItems:"center",justifyContent:"center",color:"#fff",fontSize:14},children:a&&"âœ“"})]})]})},o)})})]})}),e.jsx(zo,{sx:{p:2,bgcolor:"#F9FAFB"},children:e.jsxs(oe,{fullWidth:!0,variant:"contained",onClick:()=>ue(!1),sx:{bgcolor:r,color:"#fff",borderRadius:"14px",py:1.5,fontWeight:900,textTransform:"none",boxShadow:`0 8px 20px ${c(r,.3)}`,"&:hover":{bgcolor:"#D81B60",boxShadow:`0 10px 25px ${c(r,.4)}`}},children:["Confirm Selection (",_.length,")"]})})]})]})};export{pr as default};
