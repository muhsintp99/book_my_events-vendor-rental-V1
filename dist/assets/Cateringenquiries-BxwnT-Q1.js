import{w as G,r as n,j as e,B as c,T as r,x as _,am as H,q as J,t as K,S as U,ap as p,b as u,V as $,af as Q,ah as X,as as Y,ai as Z,G as C,n as L,K as B,p as ee,at as te,au as se,aj as oe,g as A,h as ie}from"./index-BaHW6ngD.js";import{C as F}from"./Chat-BsAdHpmG.js";import{C as ne}from"./Close-DGg8Eddr.js";import{E as le}from"./Event-CGr9I5OB.js";import{C as re}from"./Category-MrdCOE05.js";import{A as ae}from"./AccessTime-CZ0ElgmR.js";import{T as ce}from"./TableContainer-B69mpSmz.js";import{T as de,a as j,b as s,c as xe}from"./TableRow-Cb9zE8V_.js";import{T as he}from"./TableHead-BOFE__Cx.js";var i="#2E7D32";const Ee=()=>{var D;const b=G(),[d,N]=n.useState(""),[P,v]=n.useState([]),[m,E]=n.useState(!0),[S,f]=n.useState(null),[g,R]=n.useState(null),[M,I]=n.useState(!1),[l,y]=n.useState(null);n.useEffect(()=>{const t=localStorage.getItem("user");if(t){const o=JSON.parse(t);R(o.providerId||o._id)}},[]),n.useEffect(()=>{(async()=>{if(!g){f("Provider ID not found"),E(!1);return}try{const O=((await ie.get(`https://api.bookmyevent.ae/api/enquiries/provider/${g}`)).data.data||[]).filter(q=>{var z,k;const T=(((z=q.moduleId)==null?void 0:z.moduleType)||"").toLowerCase(),W=(((k=q.moduleId)==null?void 0:k.title)||"").toLowerCase();return T==="catering"||T==="food"||W.includes("catering")||W.includes("food")});v(O),f(null)}catch{f("Failed to fetch enquiries"),v([])}finally{E(!1)}})()},[g]);const w=P.filter(t=>{var o;return(t.fullName||"").toLowerCase().includes(d.toLowerCase())||(t.email||"").toLowerCase().includes(d.toLowerCase())||(t.contact||"").includes(d)||(((o=t.moduleId)==null?void 0:o.title)||"").toLowerCase().includes(d.toLowerCase())}),V=t=>{y(t),I(!0)},h=()=>{I(!1),y(null)},a=({icon:t,label:o,value:x})=>e.jsxs(c,{display:"flex",alignItems:"center",gap:2,py:1.5,sx:{borderBottom:"1px solid",borderColor:"divider","&:last-child":{borderBottom:"none"}},children:[e.jsx(c,{sx:{width:40,height:40,borderRadius:"50%",bgcolor:"#E8F5E9",color:i,display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},children:t}),e.jsxs(c,{children:[e.jsx(r,{variant:"caption",color:"text.secondary",children:o}),e.jsx(r,{fontWeight:500,children:x||"N/A"})]})]});return e.jsxs(c,{p:2,children:[e.jsx(r,{variant:"h4",gutterBottom:!0,sx:{color:i,fontWeight:700},children:"Catering Enquiries"}),S&&e.jsx(_,{severity:"error",sx:{mb:2},children:S}),e.jsxs(H,{sx:{mt:2,borderRadius:"12px",overflow:"hidden"},children:[e.jsx(c,{p:2,bgcolor:"#F1F8E9",children:e.jsx(J,{label:"Search catering enquiries",size:"small",value:d,onChange:t=>N(t.target.value),fullWidth:!0,sx:{bgcolor:"white",borderRadius:"8px"}})}),e.jsx(ce,{children:e.jsxs(de,{children:[e.jsx(he,{sx:{bgcolor:"#F1F8E9"},children:e.jsxs(j,{children:[e.jsx(s,{sx:{fontWeight:700},children:"#"}),e.jsx(s,{sx:{fontWeight:700},children:"Customer"}),e.jsx(s,{sx:{fontWeight:700},children:"Module"}),e.jsx(s,{sx:{fontWeight:700},children:"Contact"}),e.jsx(s,{sx:{fontWeight:700},children:"Date"}),e.jsx(s,{align:"center",sx:{fontWeight:700},children:"Actions"})]})}),e.jsxs(xe,{children:[m&&e.jsx(j,{children:e.jsx(s,{colSpan:6,align:"center",children:e.jsx(K,{size:28,sx:{color:i}})})}),!m&&w.map((t,o)=>{var x;return e.jsxs(j,{hover:!0,children:[e.jsx(s,{children:o+1}),e.jsxs(s,{children:[e.jsx(r,{fontWeight:600,children:t.fullName}),e.jsx(r,{variant:"caption",color:"text.secondary",children:t.email})]}),e.jsx(s,{children:(x=t.moduleId)==null?void 0:x.title}),e.jsx(s,{children:t.contact}),e.jsx(s,{children:new Date(t.bookingDate).toLocaleDateString()}),e.jsx(s,{align:"center",children:e.jsxs(U,{direction:"row",spacing:1,justifyContent:"center",children:[e.jsx(p,{title:"Chat",children:e.jsx(u,{size:"small",onClick:()=>b("/catering/enquirychat",{state:t}),sx:{color:i,bgcolor:"#E8F5E9","&:hover":{bgcolor:"#C8E6C9"}},children:e.jsx(F,{fontSize:"small"})})}),e.jsx(p,{title:"View",children:e.jsx(u,{size:"small",color:"info",onClick:()=>V(t),children:e.jsx($,{fontSize:"small"})})}),e.jsx(p,{title:"Delete",children:e.jsx(u,{size:"small",color:"error",children:e.jsx(Q,{fontSize:"small"})})})]})})]},t._id)}),!m&&w.length===0&&e.jsx(j,{children:e.jsx(s,{colSpan:6,align:"center",children:"No catering enquiries found"})})]})]})})]}),e.jsxs(X,{open:M,onClose:h,maxWidth:"md",fullWidth:!0,children:[e.jsx(Y,{sx:{bgcolor:i,color:"white"},children:e.jsxs(c,{display:"flex",justifyContent:"space-between",children:[e.jsx(r,{fontWeight:600,children:"Enquiry Details"}),e.jsx(u,{onClick:h,sx:{color:"white"},children:e.jsx(ne,{})})]})}),e.jsx(Z,{children:l&&e.jsxs(C,{container:!0,spacing:3,mt:1,children:[e.jsx(C,{item:!0,xs:12,md:6,children:e.jsx(L,{variant:"outlined",children:e.jsxs(B,{children:[e.jsx(r,{fontWeight:600,mb:2,color:i,children:"Customer Information"}),e.jsx(a,{icon:e.jsx(ee,{fontSize:"small"}),label:"Full Name",value:l.fullName}),e.jsx(a,{icon:e.jsx(te,{fontSize:"small"}),label:"Email",value:l.email}),e.jsx(a,{icon:e.jsx(se,{fontSize:"small"}),label:"Contact",value:l.contact})]})})}),e.jsx(C,{item:!0,xs:12,md:6,children:e.jsx(L,{variant:"outlined",children:e.jsxs(B,{children:[e.jsx(r,{fontWeight:600,mb:2,color:i,children:"Booking Information"}),e.jsx(a,{icon:e.jsx(re,{fontSize:"small"}),label:"Module",value:(D=l.moduleId)==null?void 0:D.title}),e.jsx(a,{icon:e.jsx(le,{fontSize:"small"}),label:"Booking Date",value:new Date(l.bookingDate).toLocaleDateString()}),e.jsx(a,{icon:e.jsx(ae,{fontSize:"small"}),label:"Created At",value:new Date(l.createdAt).toLocaleString()})]})})})]})}),e.jsxs(oe,{children:[e.jsx(A,{onClick:h,variant:"outlined",sx:{color:i,borderColor:i},children:"Close"}),e.jsx(A,{variant:"contained",startIcon:e.jsx(F,{}),sx:{bgcolor:i,"&:hover":{bgcolor:"#1B5E20"}},onClick:()=>{h(),b("/catering/enquirychat",{state:l})},children:"Open Chat"})]})]})]})};export{Ee as default};
