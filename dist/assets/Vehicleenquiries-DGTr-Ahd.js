import{w as O,r,j as e,B as c,T as l,x as G,al as _,s as H,t as J,S as K,ao as p,b as u,V as Q,ae as U,ag as X,aq as Y,ah as Z,G as g,p as B,M as L,P as $,ar as ee,as as ie,ai as te,g as A,h as ne}from"./index-DKDRBmg1.js";import{C as N}from"./Chat-CQ4S6Nl_.js";import{C as re}from"./Close-BPhM-kbo.js";import{E as ae}from"./Event-CJ6_NevQ.js";import{C as le}from"./Category-DDvyOERQ.js";import{A as se}from"./AccessTime-smdtnJju.js";import{T as oe}from"./TableContainer-BGj9v7a8.js";import{T as ce,a as x,b as t,c as de}from"./TableRow-CJXXMWv3.js";import{T as ue}from"./TableHead-CpHmZcSB.js";var ye=function(){var D;var C=O(),[h,W]=r.useState(""),[P,y]=r.useState([]),[j,b]=r.useState(!0),[S,m]=r.useState(null),[f,M]=r.useState(null),[R,I]=r.useState(!1),[a,q]=r.useState(null);r.useEffect(function(){var i=localStorage.getItem("user");if(i){var n=JSON.parse(i);M(n.providerId||n._id)}},[]),r.useEffect(function(){var i=async function(){if(!f){m("Provider ID not found"),b(!1);return}try{var n=await ne.get("https://api.bookmyevent.ae/api/enquiries/provider/"+f),s=n.data.data||[],F=s.filter(function(v){var z,k;var E=(((z=v.moduleId)==null?void 0:z.moduleType)||"").toLowerCase(),T=(((k=v.moduleId)==null?void 0:k.title)||"").toLowerCase();return E==="transport"||E==="vehicle"||T.includes("transport")||T.includes("vehicle")});y(F),m(null)}catch{m("Failed to fetch enquiries"),y([])}finally{b(!1)}};i()},[f]);var w=P.filter(function(i){var s;var n=h.toLowerCase();return(i.fullName||"").toLowerCase().includes(n)||(i.email||"").toLowerCase().includes(n)||(i.contact||"").includes(h)||(((s=i.moduleId)==null?void 0:s.title)||"").toLowerCase().includes(n)}),V=function(i){q(i),I(!0)},d=function(){I(!1),q(null)},o=function(i){return e.jsxs(c,{display:"flex",alignItems:"center",gap:2,py:1.5,sx:{borderBottom:"1px solid",borderColor:"divider","&:last-child":{borderBottom:"none"}},children:[e.jsx(c,{sx:{width:40,height:40,borderRadius:"50%",bgcolor:"primary.light",color:"primary.main",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},children:i.icon}),e.jsxs(c,{children:[e.jsx(l,{variant:"caption",color:"text.secondary",children:i.label}),e.jsx(l,{fontWeight:500,children:i.value||"N/A"})]})]})};return e.jsxs(c,{p:2,children:[e.jsx(l,{variant:"h4",gutterBottom:!0,children:"Transport Enquiries"}),S&&e.jsx(G,{severity:"error",sx:{mb:2},children:S}),e.jsxs(_,{sx:{mt:2},children:[e.jsx(c,{p:2,children:e.jsx(H,{label:"Search enquiries",size:"small",value:h,onChange:function(i){W(i.target.value)},fullWidth:!0})}),e.jsx(oe,{children:e.jsxs(ce,{children:[e.jsx(ue,{children:e.jsxs(x,{children:[e.jsx(t,{children:"#"}),e.jsx(t,{children:"Customer"}),e.jsx(t,{children:"Module"}),e.jsx(t,{children:"Contact"}),e.jsx(t,{children:"Date"}),e.jsx(t,{align:"center",children:"Actions"})]})}),e.jsxs(de,{children:[j&&e.jsx(x,{children:e.jsx(t,{colSpan:6,align:"center",children:e.jsx(J,{size:28})})}),!j&&w.map(function(i,n){var s;return e.jsxs(x,{hover:!0,children:[e.jsx(t,{children:n+1}),e.jsxs(t,{children:[e.jsx(l,{fontWeight:600,children:i.fullName}),e.jsx(l,{variant:"caption",color:"text.secondary",children:i.email})]}),e.jsx(t,{children:(s=i.moduleId)==null?void 0:s.title}),e.jsx(t,{children:i.contact}),e.jsx(t,{children:new Date(i.bookingDate).toLocaleDateString()}),e.jsx(t,{align:"center",children:e.jsxs(K,{direction:"row",spacing:1,justifyContent:"center",children:[e.jsx(p,{title:"Chat",children:e.jsx(u,{size:"small",color:"primary",onClick:function(){C("/vehicles/enquirychat",{state:{enquiry:i}})},children:e.jsx(N,{fontSize:"small"})})}),e.jsx(p,{title:"View",children:e.jsx(u,{size:"small",color:"info",onClick:function(){V(i)},children:e.jsx(Q,{fontSize:"small"})})}),e.jsx(p,{title:"Delete",children:e.jsx(u,{size:"small",color:"error",children:e.jsx(U,{fontSize:"small"})})})]})})]},i._id)}),!j&&w.length===0&&e.jsx(x,{children:e.jsx(t,{colSpan:6,align:"center",children:"No enquiries found"})})]})]})})]}),e.jsxs(X,{open:R,onClose:d,maxWidth:"md",fullWidth:!0,children:[e.jsx(Y,{sx:{bgcolor:"primary.main",color:"white"},children:e.jsxs(c,{display:"flex",justifyContent:"space-between",children:[e.jsx(l,{fontWeight:600,children:"Enquiry Details"}),e.jsx(u,{onClick:d,sx:{color:"white"},children:e.jsx(re,{})})]})}),e.jsx(Z,{children:a&&e.jsxs(g,{container:!0,spacing:3,mt:1,children:[e.jsx(g,{item:!0,xs:12,md:6,children:e.jsx(B,{variant:"outlined",children:e.jsxs(L,{children:[e.jsx(l,{fontWeight:600,mb:2,children:"Customer Information"}),e.jsx(o,{icon:e.jsx($,{fontSize:"small"}),label:"Full Name",value:a.fullName}),e.jsx(o,{icon:e.jsx(ee,{fontSize:"small"}),label:"Email",value:a.email}),e.jsx(o,{icon:e.jsx(ie,{fontSize:"small"}),label:"Contact",value:a.contact})]})})}),e.jsx(g,{item:!0,xs:12,md:6,children:e.jsx(B,{variant:"outlined",children:e.jsxs(L,{children:[e.jsx(l,{fontWeight:600,mb:2,children:"Booking Information"}),e.jsx(o,{icon:e.jsx(le,{fontSize:"small"}),label:"Module",value:(D=a.moduleId)==null?void 0:D.title}),e.jsx(o,{icon:e.jsx(ae,{fontSize:"small"}),label:"Booking Date",value:new Date(a.bookingDate).toLocaleDateString()}),e.jsx(o,{icon:e.jsx(se,{fontSize:"small"}),label:"Created At",value:new Date(a.createdAt).toLocaleString()})]})})})]})}),e.jsxs(te,{children:[e.jsx(A,{onClick:d,variant:"outlined",children:"Close"}),e.jsx(A,{variant:"contained",startIcon:e.jsx(N,{}),onClick:function(){d(),C("/vehicles/enquirychat",{state:{enquiry:a}})},children:"Open Chat"})]})]})]})};export{ye as default};
