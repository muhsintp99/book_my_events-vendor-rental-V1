import{u as U,r as c,j as e,B as h,T as p,s as N,g as k,Q as M,U as v}from"./index-uLeiVYul.js";import{A as O}from"./ArrowDropDown-CW9qBPBK.js";import{S as _}from"./Search-DK9bfYTu.js";import{T as F,a as H,b as y,c as s,d as z}from"./TableRow-BrhgsaVQ.js";const V=()=>{const m=U(),[x,B]=c.useState(""),[j,A]=c.useState([]),[C,u]=c.useState([]),[f,b]=c.useState(null),[w,E]=c.useState(null),S=localStorage.getItem("moduleId"),g="https://api.bookmyevent.ae",R=()=>localStorage.getItem("token")||sessionStorage.getItem("token");c.useEffect(()=>{(async()=>{try{const o=R(),r={Accept:"application/json"};o&&(r.Authorization=`Bearer ${o}`);const a=await fetch(`${g}/api/categories/modules/${S}`,{headers:r});if(!a.ok)throw new Error(`HTTP error! Status: ${a.status}`);const i=a.headers.get("content-type");if(!i||!i.includes("application/json"))throw new Error("Response is not JSON");const n=await a.json();if(n.success&&Array.isArray(n.data)&&n.data.length>0){const d=n.data.map(l=>({id:l.categoryId||l._id,name:l.title||l.name,image:l.image?`${g}${l.image}`:""}));A(d),u(d)}else b("No categories found for this module")}catch(o){console.error("Error fetching categories:",o.message),b(o.message)}})()},[S,g]);const $=()=>{if(!x.trim()){u(j);return}const t=j.filter(o=>{var r;return(r=o.name)==null?void 0:r.toLowerCase().includes(x.toLowerCase())});u(t)},L=t=>E(t.currentTarget),I=()=>E(null),T=t=>{let o=`SI,Category Id,Category Name
`;C.forEach((n,d)=>{o+=`${d+1},${n.id},${n.name}
`});const r=new Blob([o],{type:t==="excel"?"application/vnd.ms-excel":"text/csv"}),a=window.URL.createObjectURL(r),i=document.createElement("a");i.href=a,i.download=`category_list.${t}`,i.click(),window.URL.revokeObjectURL(a),I()};return e.jsx(h,{sx:{p:3,backgroundColor:m.palette.grey[100],minHeight:"100vh"},children:e.jsxs(h,{sx:{maxWidth:"lg",margin:"auto",backgroundColor:"white",borderRadius:m.shape.borderRadius,boxShadow:m.shadows[1],p:3},children:[e.jsxs(h,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3},children:[e.jsx(p,{variant:"h5",component:"h1",children:"Category List"}),e.jsxs(h,{sx:{display:"flex",alignItems:"center",gap:2},children:[e.jsx(N,{variant:"outlined",placeholder:"Search categories",value:x,onChange:t=>B(t.target.value),size:"small",sx:{"& .MuiOutlinedInput-root":{"& fieldset":{borderColor:"#E15B65"},"&:hover fieldset":{borderColor:"#E15B65"},"&.Mui-focused fieldset":{borderColor:"#E15B65"}}}}),e.jsx(k,{variant:"outlined",startIcon:e.jsx(_,{}),onClick:$,sx:{borderColor:"#E15B65",color:"#E15B65"},children:"Search"}),e.jsx(k,{variant:"outlined",endIcon:e.jsx(O,{}),onClick:L,sx:{borderColor:"#E15B65",color:"#E15B65"},children:"Export"}),e.jsxs(M,{anchorEl:w,open:!!w,onClose:I,children:[e.jsx(v,{onClick:()=>T("excel"),children:"Excel"}),e.jsx(v,{onClick:()=>T("csv"),children:"CSV"})]})]})]}),f&&e.jsx(p,{color:"error",sx:{mb:2},children:f}),e.jsxs(F,{children:[e.jsx(H,{children:e.jsxs(y,{children:[e.jsx(s,{children:"SI"}),e.jsx(s,{children:"Category Id"}),e.jsx(s,{children:"Category Image"}),e.jsx(s,{children:"Category Name"})]})}),e.jsx(z,{children:C.map((t,o)=>e.jsxs(y,{children:[e.jsx(s,{children:o+1}),e.jsx(s,{children:t.id}),e.jsx(s,{children:t.image?e.jsx("img",{src:t.image,alt:t.name,style:{width:100,height:50,objectFit:"contain"}}):e.jsx(p,{variant:"caption",color:"text.secondary",children:"No Image"})}),e.jsx(s,{children:t.name})]},t.id))})]})]})})};export{V as default};
