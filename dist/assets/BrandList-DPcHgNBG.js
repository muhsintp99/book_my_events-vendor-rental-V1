import{u as A,r as c,j as e,B as i,T as w,s as L,g as E,U,W as S}from"./index-CLsaspxs.js";import{A as F}from"./ArrowDropDown-C6qwOF01.js";import{S as N}from"./Search-B2_-Eirq.js";import{T as H,a as y,b as n,c as O}from"./TableRow-DJQ_74qW.js";import{T as _}from"./TableHead-D8El7ksk.js";const J=()=>{const d=A(),[x,T]=c.useState(""),[C,I]=c.useState([]),[m,p]=c.useState([]),[u,j]=c.useState(null),v=localStorage.getItem("moduleId"),h="https://api.bookmyevent.ae";c.useEffect(()=>{(async()=>{try{const r=await fetch(`${h}/api/brands/module/${v}`,{headers:{Accept:"application/json"}});if(!r.ok)throw new Error(`HTTP error! Status: ${r.status}`);const l=r.headers.get("content-type");if(!l||!l.includes("application/json"))throw new Error("Response is not JSON");const t=await r.json();if(Array.isArray(t)&&t.length>0){const o=t.map(a=>({id:a.brandId,image:`${h}/${a.icon}`,name:a.title}));I(o),p(o)}else j("No brands found for this module")}catch(r){console.error("Error fetching brands:",r.message),j(`Failed to fetch brands: ${r.message}`)}})()},[]);const[f,g]=c.useState(null),k=s=>g(s.currentTarget),B=()=>g(null),b=s=>{let r=`Sr,Brand Id,Brand Name
`;m.forEach((a,$)=>{r+=`${$+1},${a.id},${a.name}
`});const l=new Blob([r],{type:s==="excel"?"application/vnd.ms-excel":"text/csv"}),t=window.URL.createObjectURL(l),o=document.createElement("a");o.href=t,o.download=`brand_list.${s}`,o.click(),window.URL.revokeObjectURL(t),B()},R=()=>{const s=C.filter(r=>r.name.toLowerCase().includes(x.toLowerCase()));p(s)};return e.jsx(i,{sx:{p:3,backgroundColor:d.palette.grey[100],minHeight:"100vh"},children:e.jsxs(i,{sx:{maxWidth:"lg",margin:"auto",backgroundColor:"white",borderRadius:d.shape.borderRadius,boxShadow:d.shadows[1],p:3},children:[e.jsxs(i,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3},children:[e.jsx(w,{variant:"h5",component:"h1",children:"Brand List"}),e.jsxs(i,{sx:{display:"flex",alignItems:"center",gap:2},children:[e.jsx(L,{variant:"outlined",color:"#E15B65",placeholder:"Search by brand name",value:x,onChange:s=>T(s.target.value),size:"small"}),e.jsx(E,{variant:"outlined",color:"#E15B65",startIcon:e.jsx(N,{}),onClick:R,sx:{color:"#E15B65"},children:"Search"}),e.jsx(E,{variant:"outlined",color:"#E15B65",endIcon:e.jsx(F,{}),onClick:k,sx:{color:"#E15B65"},children:"Export"}),e.jsxs(U,{anchorEl:f,open:!!f,onClose:B,children:[e.jsx(S,{onClick:()=>b("excel"),children:"Excel"}),e.jsx(S,{onClick:()=>b("csv"),children:"CSV"})]})]})]}),u&&e.jsx(w,{color:"error",sx:{mb:2},children:u}),e.jsxs(H,{children:[e.jsx(_,{children:e.jsxs(y,{children:[e.jsx(n,{children:"Sr"}),e.jsx(n,{children:"Brand Name"}),e.jsx(n,{children:"Brand Id"}),e.jsx(n,{children:"Brand Image"})]})}),e.jsx(O,{children:m.map((s,r)=>e.jsxs(y,{children:[e.jsx(n,{children:r+1}),e.jsx(n,{children:s.name}),e.jsx(n,{children:s.id}),e.jsx(n,{children:e.jsx("img",{src:s.image,alt:s.name,style:{width:100,height:50,objectFit:"contain"}})})]},s.id))})]})]})})};export{J as default};
