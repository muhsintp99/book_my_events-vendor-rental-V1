import{c as G,j as e,s as $,M as q,B as g,P as D,r as o,u as K,F as L,I as B,O as E,a as Q,b as U,V as X,d as Y,e as Z,G as t,f as ee,C as te,T as i,L as j,A as se,g as z,h as H,S as O,i as M,k as ne,D as re,l as oe,m as ae}from"./index-s0QLBFc1.js";const ie=G([e.jsx("path",{d:"M17 18H7V6h7V1H7c-1.1 0-2 .9-2 2v18c0 1.1.9 2 2 2h10c1.1 0 2-.9 2-2v-5h-2z"},"0"),e.jsx("path",{d:"m18 14 5-5-1.41-1.41L19 10.17V3h-2v7.17l-2.59-2.58L13 9z"},"1")]),le=$("div")(({theme:s})=>({backgroundColor:s.palette.grey[100],minHeight:"100vh"}));function T({children:s,...r}){return e.jsx(q,{sx:{maxWidth:{xs:400,lg:475},margin:{xs:2.5,md:3},"& > *":{flexGrow:1,flexBasis:"50%"}},content:!1,...r,children:e.jsx(g,{sx:{p:{xs:2,sm:3,xl:5}},children:s})})}T.propTypes={children:D.any,other:D.any};const ce=()=>{const[s,r]=o.useState(!1),[h,l]=o.useState(null);return o.useEffect(()=>{const c=x=>{x.preventDefault(),r(!0),l(x)};return window.addEventListener("beforeinstallprompt",c),()=>window.removeEventListener("beforeinstallprompt",c)},[]),{supportsPWA:s,installPWA:()=>{h&&h.prompt()}}};function de(){const s=K(),[r,h]=o.useState(!0),[l,f]=o.useState(!1),[c,x]=o.useState(""),[b,V]=o.useState(""),[y,I]=o.useState(""),{supportsPWA:_,installPWA:F}=ce(),R=async a=>{var v,S,w,A,k,C;a.preventDefault(),I("");try{const m=await H.post("https://api.bookmyevent.ae/api/auth/login",{email:c,password:b}),{token:P,user:d,profile:u}=m.data;r?localStorage.setItem("token",P):sessionStorage.setItem("token",P),localStorage.setItem("user",JSON.stringify(d));let p=null;if((v=u==null?void 0:u.module)!=null&&v._id&&(p=u.module._id,localStorage.setItem("moduleId",p),localStorage.setItem("logRes",u.module.title)),d!=null&&d._id&&p)try{const n=(S=(await H.get(`https://api.bookmyevent.ae/api/subscription/status/${d._id}?moduleId=${p}`)).data)==null?void 0:S.subscription;if((n==null?void 0:n.status)==="active"&&(n!=null&&n.isCurrent)){const J=new Date(n.endDate),N=Math.max(0,Math.ceil((J-new Date)/(1e3*60*60*24)));localStorage.setItem("upgrade",JSON.stringify({isSubscribed:!0,status:"active",plan:n.planId,module:n.moduleId,access:{canAccess:!0,isExpired:!1,daysLeft:N}}))}else localStorage.setItem("upgrade",JSON.stringify({isSubscribed:!1,status:"free",access:{canAccess:!1}}))}catch(W){console.error("Subscription fetch failed:",W),localStorage.setItem("upgrade",JSON.stringify({isSubscribed:!1,status:"free",access:{canAccess:!1}}))}window.location.href="/dashboard/default"}catch(m){I(((A=(w=m.response)==null?void 0:w.data)==null?void 0:A.message)||((C=(k=m.response)==null?void 0:k.data)==null?void 0:C.error)||"Invalid email or password")}};return e.jsxs("form",{onSubmit:R,children:[e.jsxs(L,{fullWidth:!0,sx:{...s.typography.customInput,mb:2},children:[e.jsx(B,{children:"Email Address"}),e.jsx(E,{type:"email",value:c,onChange:a=>x(a.target.value),required:!0})]}),e.jsxs(L,{fullWidth:!0,sx:{...s.typography.customInput,mb:2},children:[e.jsx(B,{children:"Password"}),e.jsx(E,{type:l?"text":"password",value:b,onChange:a=>V(a.target.value),endAdornment:e.jsx(Q,{position:"end",children:e.jsx(U,{onClick:()=>f(!l),edge:"end",children:l?e.jsx(X,{}):e.jsx(Y,{})})}),required:!0})]}),y&&e.jsx(Z,{error:!0,children:y}),e.jsxs(t,{container:!0,justifyContent:"space-between",alignItems:"center",children:[e.jsx(ee,{control:e.jsx(te,{checked:r,onChange:a=>h(a.target.checked)}),label:"Keep me logged in"}),e.jsx(i,{component:j,to:"/forgot-password",color:"#E15B65",sx:{textDecoration:"none"},children:"Forgot Password?"})]}),e.jsx(g,{sx:{mt:2},children:e.jsx(se,{children:e.jsx(z,{fullWidth:!0,size:"large",type:"submit",variant:"contained",sx:{bgcolor:"#E15B65"},children:"Sign In"})})}),_&&e.jsx(g,{sx:{mt:2},children:e.jsx(z,{fullWidth:!0,size:"large",variant:"outlined",onClick:F,startIcon:e.jsx(ie,{}),sx:{color:s.palette.primary.main,borderColor:s.palette.primary.main},children:"Install App"})})]})}function ue(){return e.jsxs(O,{direction:"row",sx:{justifyContent:"space-between"},children:[e.jsx(i,{variant:"subtitle2",component:M,href:"https://berrydashboard.com",target:"_blank",underline:"hover",children:"berrydashboard.com"}),e.jsx(i,{variant:"subtitle2",component:M,href:"https://codedthemes.com",target:"_blank",underline:"hover",children:"Â© codedthemes.com"})]})}function he(){return e.jsx(j,{to:oe,"aria-label":"theme-logo",children:e.jsx("img",{src:ae,alt:"Book Logo",style:{width:160,height:50}})})}function pe(){const s=ne(r=>r.breakpoints.down("md"));return e.jsx(le,{children:e.jsxs(t,{container:!0,direction:"column",sx:{justifyContent:"flex-end",minHeight:"100vh"},children:[e.jsx(t,{size:12,children:e.jsx(t,{container:!0,sx:{justifyContent:"center",alignItems:"center",minHeight:"calc(100vh - 68px)"},children:e.jsx(t,{sx:{m:{xs:1,sm:3},mb:0},children:e.jsx(T,{children:e.jsxs(t,{container:!0,spacing:2,sx:{alignItems:"center",justifyContent:"center"},children:[e.jsx(t,{sx:{mb:3},children:e.jsx(he,{})}),e.jsx(t,{size:12,children:e.jsx(t,{container:!0,direction:{xs:"column-reverse",md:"row"},sx:{alignItems:"center",justifyContent:"center"},children:e.jsx(t,{children:e.jsxs(O,{spacing:1,sx:{alignItems:"center",justifyContent:"center"},children:[e.jsx(i,{gutterBottom:!0,variant:s?"h3":"h2",sx:{color:"#E15B65"},children:"Hi, Welcome Back"}),e.jsx(i,{variant:"caption",sx:{fontSize:"16px",textAlign:{xs:"center",md:"inherit"}},children:"Enter your credentials to continue"})]})})})}),e.jsx(t,{size:12,children:e.jsx(de,{})}),e.jsx(t,{size:12,children:e.jsx(re,{})}),e.jsx(t,{size:12,children:e.jsx(t,{container:!0,direction:"column",sx:{alignItems:"center"},size:12,children:e.jsxs(i,{variant:"body2",sx:{color:"text.secondary"},children:["Don't have an account?"," ",e.jsx(i,{component:j,to:"/pages/register",variant:"body2",sx:{color:"#E15B65",fontWeight:700,textDecoration:"none","&:hover":{textDecoration:"underline"}},children:"Register as Vendor"})]})})})]})})})})}),e.jsx(t,{sx:{px:3,my:3},size:12,children:e.jsx(ue,{})})]})})}export{pe as default};
