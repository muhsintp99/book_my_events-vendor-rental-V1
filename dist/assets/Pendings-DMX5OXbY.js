import{r as i,j as o,B as l,T as a,t as w,a6 as E,S as j,ab as _,D,g as m,h as p}from"./index-DwHzorPX.js";const I=()=>{try{const r=localStorage.getItem("user");if(!r)return null;const s=JSON.parse(r);return(s==null?void 0:s._id)||null}catch(r){return console.error("Error parsing user from localStorage:",r),null}},N=()=>{const[r,s]=i.useState([]),[k,b]=i.useState(!0),[x,y]=i.useState(null),[g,v]=i.useState(null);i.useEffect(()=>{const e=I();v(e)},[]),i.useEffect(()=>{if(!g)return;(async()=>{var n;try{const P=(((n=(await p.get(`https://api.bookmyevent.ae/api/bookings/provider/${g}`)).data)==null?void 0:n.data)||[]).filter(u=>{var h,f;return((h=u.status)==null?void 0:h.toLowerCase())==="pending"||((f=u.paymentStatus)==null?void 0:f.toLowerCase())==="pending"});s(P)}catch(t){console.error("Error fetching pending bookings:",t)}finally{b(!1)}})()},[g]);const S=e=>{y(x===e?null:e)},C=async(e,n)=>{n.stopPropagation();try{await p.patch(`https://api.bookmyevent.ae/api/bookings/${e}/accept`),s(t=>t.filter(d=>d._id!==e)),alert("Booking Confirmed ✔️")}catch(t){console.error(t),alert("Failed to confirm booking")}},B=async(e,n)=>{n.stopPropagation();try{await p.patch(`https://api.bookmyevent.ae/api/bookings/${e}/reject`),s(t=>t.filter(d=>d._id!==e)),alert("Booking Rejected ❌")}catch(t){console.error(t),alert("Failed to reject booking")}};return o.jsx(l,{p:2,sx:{background:"#f4f7fb",minHeight:"100vh"},children:o.jsxs(l,{sx:{maxWidth:"850px",margin:"0 auto"},children:[o.jsx(a,{variant:"h4",fontWeight:600,mb:3,children:"Pending Bookings"}),k?o.jsx(l,{display:"flex",justifyContent:"center",mt:4,children:o.jsx(w,{})}):r.length===0?o.jsx(a,{children:"No Pending Bookings Found"}):r.map(e=>o.jsxs(E,{elevation:2,sx:{p:2.5,mt:2,borderRadius:"16px",cursor:"pointer",transition:"0.2s",background:"#fff","&:hover":{boxShadow:"0px 4px 20px rgba(0,0,0,0.08)",transform:"translateY(-2px)"}},onClick:()=>S(e._id),children:[o.jsxs(j,{direction:"row",justifyContent:"space-between",alignItems:"center",children:[o.jsxs(l,{children:[o.jsxs(a,{fontWeight:700,fontSize:16,children:["Booking ID:"," ",o.jsxs("span",{style:{color:"#1976d2"},children:["#",e._id.slice(-6)]})]}),o.jsx(a,{color:"gray",fontSize:14,children:e.moduleType||"Event Booking"}),o.jsx(a,{color:"gray",fontSize:13,mt:.5,children:e.bookingDate?new Date(e.bookingDate).toDateString():"No date"})]}),o.jsxs(a,{fontWeight:700,sx:{color:"#16a34a",fontSize:"18px"},children:["₹",e.finalPrice||"0"]})]}),o.jsxs(_,{in:x===e._id,children:[o.jsx(D,{sx:{my:2}}),o.jsxs(l,{sx:{background:"#f9fafb",p:2,borderRadius:"12px",border:"1px solid #e5e7eb"},children:[o.jsx(c,{label:"Customer",value:e.fullName}),o.jsx(c,{label:"Guests",value:e.numberOfGuests}),o.jsx(c,{label:"Email",value:e.emailAddress}),o.jsx(c,{label:"Phone",value:e.contactNumber||"N/A"}),o.jsx(c,{label:"Booking Type",value:e.bookingType})]}),o.jsxs(j,{direction:"row",spacing:2,mt:2,justifyContent:"center",children:[o.jsx(m,{variant:"outlined",sx:{width:"130px",borderRadius:"30px",color:"#e11d48",borderColor:"#e11d48","&:hover":{background:"#ffe4e6"}},onClick:n=>B(e._id,n),children:"Reject"}),o.jsx(m,{variant:"contained",sx:{width:"130px",borderRadius:"30px",bgcolor:"#16a34a","&:hover":{bgcolor:"#15803d"}},onClick:n=>C(e._id,n),children:"Confirm"})]})]})]},e._id))]})})},c=({label:r,value:s})=>o.jsxs(a,{fontSize:14,sx:{mb:.5},children:[o.jsxs("strong",{children:[r,":"]})," ",s]});export{N as default};
