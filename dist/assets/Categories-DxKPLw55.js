import{g as L,r as a,j as e,B as n,Y as $,T as v,a as B,Z as P,b as U,a5 as D,M as w,c as M}from"./index-DQO8S-Hd.js";import{A as _}from"./ArrowDropDown-D4PRmP0N.js";import{S as F}from"./Search-BNCytBKg.js";import{T as H,a as I,b as t,c as N}from"./TableRow-D3JAjirS.js";import{T as z}from"./TableHead-N38RAP1I.js";const q=()=>{L();const[c,S]=a.useState(""),[h,E]=a.useState([]),[x,g]=a.useState([]),[m,u]=a.useState(null),[T,A]=a.useState(!0),[f,p]=a.useState(null),d=localStorage.getItem("moduleId"),j="https://api.bookmyevent.ae";a.useEffect(()=>{(async()=>{try{if(!d)throw new Error("Module ID not found in localStorage");const o=await fetch(`${j}/api/categories/modules/${d}`);if(!o.ok)throw new Error(`HTTP error! ${o.status}`);const l=await o.json();if(l.success&&Array.isArray(l.data)){const i=l.data.map(r=>({id:r.categoryId||r._id,name:r.title,image:r.image?`${j}${r.image}`:"",status:r.isActive}));E(i),g(i)}else u("No categories found for this module")}catch(o){console.error(o),u(o.message)}finally{A(!1)}})()},[d]),a.useEffect(()=>{const s=h.filter(o=>o.name.toLowerCase().includes(c.toLowerCase()));g(s)},[c,h]);const k=s=>p(s.currentTarget),C=()=>p(null),b=s=>{let o=`SI,Category Id,Category Name
`;x.forEach((y,R)=>{o+=`${R+1},${y.id},${y.name}
`});const l=new Blob([o],{type:s==="excel"?"application/vnd.ms-excel":"text/csv"}),i=window.URL.createObjectURL(l),r=document.createElement("a");r.href=i,r.download=`panthal_categories.${s}`,r.click(),window.URL.revokeObjectURL(i),C()};return e.jsx(n,{sx:{p:4,bgcolor:"#f8f9fc",minHeight:"100vh"},children:e.jsxs($,{elevation:3,sx:{p:4,borderRadius:4},children:[e.jsxs(n,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:4},children:[e.jsx(v,{variant:"h4",sx:{fontWeight:700,color:"#C62828"},children:"Panthal Category List"}),e.jsxs(n,{sx:{display:"flex",gap:2},children:[e.jsx(B,{size:"small",placeholder:"Search categories...",value:c,onChange:s=>S(s.target.value),InputProps:{startAdornment:e.jsx(P,{position:"start",children:e.jsx(F,{})})}}),e.jsx(U,{variant:"contained",endIcon:e.jsx(_,{}),onClick:k,sx:{bgcolor:"#C62828","&:hover":{bgcolor:"#8E0000"}},children:"Export"}),e.jsxs(D,{anchorEl:f,open:!!f,onClose:C,children:[e.jsx(w,{onClick:()=>b("excel"),children:"Excel"}),e.jsx(w,{onClick:()=>b("csv"),children:"CSV"})]})]})]}),T?e.jsx(n,{sx:{textAlign:"center",py:5},children:e.jsx(M,{})}):m?e.jsx(v,{color:"error",children:m}):e.jsxs(H,{children:[e.jsx(z,{children:e.jsxs(I,{sx:{bgcolor:"#fce9ea"},children:[e.jsx(t,{children:"SI"}),e.jsx(t,{children:"Image"}),e.jsx(t,{children:"Category Name"}),e.jsx(t,{children:"Category ID"}),e.jsx(t,{children:"Status"})]})}),e.jsx(N,{children:x.map((s,o)=>e.jsxs(I,{hover:!0,sx:{"&:hover":{bgcolor:"#fff5f6"}},children:[e.jsx(t,{children:o+1}),e.jsx(t,{children:e.jsx(n,{component:"img",src:s.image,alt:s.name,sx:{width:80,height:60,objectFit:"cover",borderRadius:2}})}),e.jsx(t,{sx:{fontWeight:600},children:s.name}),e.jsx(t,{children:s.id}),e.jsx(t,{children:e.jsx(n,{sx:{px:2,py:.5,borderRadius:3,display:"inline-block",fontSize:12,bgcolor:s.status?"#e6f4ea":"#fdecea",color:s.status?"#2e7d32":"#d32f2f"},children:s.status?"Active":"Inactive"})})]},s.id))})]})]})})};export{q as default};
