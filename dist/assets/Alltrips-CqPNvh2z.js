import{r as o,j as e,B as f,T as y,x as B,ad as C,S,s as T,g,t as b,h as A}from"./index-DyiINH7F.js";import{T as D}from"./TableContainer-BT65oUDu.js";import{T as E,a as L,b as c,c as t,d as N}from"./TableRow-Dg8YGqGP.js";const R=()=>{const[n,k]=o.useState(""),[d,j]=o.useState([]),[l,m]=o.useState(!0),[p,h]=o.useState(null),[x,w]=o.useState(null);o.useEffect(()=>{const s=localStorage.getItem("user");if(s){const r=JSON.parse(s);w(r._id||r.id||r.providerId)}},[]),o.useEffect(()=>{(async()=>{var r,a;if(!x){h("Provider ID not found. Please login again."),m(!1);return}try{const i=await A.get(`https://api.bookmyevent.ae/api/bookings/provider/${x}`);j(i.data.data||i.data.bookings||[]),h(null)}catch(i){console.error("Error fetching bookings:",i),h(((a=(r=i.response)==null?void 0:r.data)==null?void 0:a.message)||"Failed to fetch bookings"),j([])}finally{m(!1)}})()},[x]);const v=s=>k(s.target.value),u=d.filter(s=>(s.fullName||"").toLowerCase().includes(n.toLowerCase())||(s.emailAddress||"").toLowerCase().includes(n.toLowerCase())||(s._id||"").toLowerCase().includes(n.toLowerCase()));return e.jsxs(f,{p:2,children:[e.jsx(y,{variant:"h4",gutterBottom:!0,children:"My Bookings"}),p&&e.jsx(B,{severity:"error",sx:{mb:2},children:p}),e.jsxs(C,{sx:{mt:2,width:"100%",borderRadius:"10px"},children:[e.jsxs(S,{direction:{xs:"column",sm:"row"},spacing:2,justifyContent:"space-between",alignItems:{xs:"stretch",sm:"center"},p:2,children:[e.jsx(T,{label:"Search by Booking ID, Name, Email",variant:"outlined",size:"small",value:n,onChange:v,sx:{maxWidth:{sm:300}}}),e.jsx(g,{variant:"contained",color:"primary",children:"Export"})]}),e.jsx(D,{sx:{width:"100%",overflowX:"auto"},children:e.jsxs(E,{stickyHeader:!0,children:[e.jsx(L,{children:e.jsxs(c,{children:[e.jsx(t,{children:"S#"}),e.jsx(t,{children:"Booking ID"}),e.jsx(t,{children:"Module"}),e.jsx(t,{children:"Customer"}),e.jsx(t,{children:"Email"}),e.jsx(t,{children:"Booking Date"}),e.jsx(t,{children:"Guests"}),e.jsx(t,{children:"Amount"}),e.jsx(t,{children:"Status"}),e.jsx(t,{children:"Payment Status"}),e.jsx(t,{children:"Action"})]})}),e.jsxs(N,{children:[l&&e.jsx(c,{children:e.jsx(t,{colSpan:11,align:"center",children:e.jsx(b,{size:28})})}),!l&&u.map((s,r)=>{var a;return e.jsxs(c,{children:[e.jsx(t,{children:r+1}),e.jsxs(t,{children:["#",s._id.slice(-6)]}),e.jsx(t,{children:s.moduleType||"N/A"}),e.jsx(t,{children:s.fullName||"N/A"}),e.jsx(t,{children:s.emailAddress||"N/A"}),e.jsx(t,{children:new Date(s.bookingDate).toLocaleDateString()}),e.jsx(t,{children:s.numberOfGuests||"-"}),e.jsxs(t,{children:["â‚¹",((a=s.finalPrice)==null?void 0:a.toLocaleString())||0]}),e.jsx(t,{style:{color:s.status==="Accepted"?"green":s.status==="Rejected"?"red":"orange",fontWeight:600},children:s.status}),e.jsx(t,{style:{textTransform:"capitalize",color:s.paymentStatus==="completed"?"green":s.paymentStatus==="failed"?"red":"orange",fontWeight:600},children:s.paymentStatus}),e.jsx(t,{children:e.jsxs(S,{direction:"row",spacing:1,children:[e.jsx(g,{variant:"outlined",size:"small",color:"primary",children:"View"}),e.jsx(g,{variant:"outlined",size:"small",color:"secondary",children:"Download"})]})})]},s._id)}),!l&&u.length===0&&e.jsx(c,{children:e.jsx(t,{colSpan:11,align:"center",children:n?"No matching bookings found":"No bookings yet"})})]})]})})]}),!l&&d.length>0&&e.jsx(f,{mt:2,children:e.jsxs(y,{variant:"body2",color:"textSecondary",children:["Showing ",u.length," of ",d.length," bookings"]})})]})};export{R as default};
