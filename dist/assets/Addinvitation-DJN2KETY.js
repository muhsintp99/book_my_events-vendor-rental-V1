import{r as p,l as X,d as ee,j as e,aE as re,aF as te,aG as ae,B as n,T as l,A as R,aH as ie,s as v,Y as j,a as k,Z as L,G as u,o as U,y as se,i as oe,b as G,N as ne,e as le}from"./index-BPglAkNh.js";import{C as H}from"./Close-CemJsPGu.js";import{A as O,R as ce}from"./RotateLeft-BheQGmKg.js";import{A as de}from"./AutoAwesome-YupV5UH4.js";const T={},pe=te({palette:{primary:{main:"#E15B65",dark:"#C2444E",light:"#F09898",contrastText:"#fff"},secondary:{main:"#D4A017"},background:{default:"#FDF6EE",paper:"#fff"},text:{primary:"#1A0A00",secondary:"#7A5C4A"}},typography:{fontFamily:"'DM Sans', sans-serif",h4:{fontFamily:"'Playfair Display', serif"}},shape:{borderRadius:14},components:{MuiCssBaseline:{styleOverrides:"@import url('https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,700;1,500&family=DM+Sans:wght@300;400;500;600&display=swap');"},MuiOutlinedInput:{styleOverrides:{root:{borderRadius:12,backgroundColor:"#FFFBF7",fontFamily:"'DM Sans', sans-serif",fontSize:"14.5px","& fieldset":{borderColor:"rgba(225, 91, 101,0.2)"},"&:hover fieldset":{borderColor:"rgba(225, 91, 101,0.5) !important"},"&.Mui-focused fieldset":{borderColor:"#E15B65 !important",borderWidth:"2px"}},input:{padding:"15px 16px"}}},MuiInputLabel:{styleOverrides:{root:{fontFamily:"'DM Sans', sans-serif",fontSize:"14px",color:"#8B3A0F","&.Mui-focused":{color:"#E15B65"}}}},MuiButton:{styleOverrides:{root:{textTransform:"none",fontFamily:"'DM Sans', sans-serif",fontWeight:600,borderRadius:12}}}}}),A=({children:s})=>e.jsx(l,{sx:{fontSize:"10.5px",fontWeight:700,letterSpacing:"0.13em",textTransform:"uppercase",color:"#E15B65",mb:1.25},children:s}),S={bgcolor:"#fff",border:"1px solid rgba(225, 91, 101, 0.11)",borderRadius:"16px",p:{xs:2.5,sm:3},boxShadow:"0 2px 14px rgba(225, 91, 101, 0.05)"};function ge(){const[s,P]=p.useState({name:"",description:"",price:"",advance:""}),[w,E]=p.useState(null),[W,g]=p.useState(null),[N,I]=p.useState([]),[z,f]=p.useState([]),[c,D]=p.useState({}),[B,b]=p.useState({open:!1,msg:"",severity:"success"}),[C,M]=p.useState(!1),{id:y}=X();ee();const m=!!y,x=(T==null?void 0:T.VITE_API_BASE_URL)||"https://api.bookmyevent.ae";p.useEffect(()=>{if(!y)return;(async()=>{try{const t=localStorage.getItem("token"),o=await(await fetch(`${x}/api/invitation/${y}`,{headers:{Authorization:`Bearer ${t}`}})).json();if(o.success){const i=o.data;P({name:i.packageName||"",description:i.description||"",price:i.packagePrice!=null?String(i.packagePrice):"",advance:i.advanceBookingAmount!=null?String(i.advanceBookingAmount):""}),i.thumbnail&&g(`${x}${i.thumbnail.startsWith("/")?"":"/"}${i.thumbnail}`),i.images&&Array.isArray(i.images)&&f(i.images.map(h=>`${x}${h.startsWith("/")?"":"/"}${h}`))}}catch(t){console.error(t)}})()},[y,x]);const F=(r,t)=>{P(a=>({...a,[r]:t})),c[r]&&D(a=>({...a,[r]:""}))},q=r=>{if(!(r!=null&&r.type.startsWith("image/")))return;E(r);const t=new FileReader;t.onload=a=>{g(a.target.result),D(o=>({...o,thumbnail:""}))},t.readAsDataURL(r)},J=r=>{const a=Array.from(r).filter(o=>o.type.startsWith("image/"));I(o=>[...o,...a]),a.forEach(o=>{const i=new FileReader;i.onload=h=>f(d=>[...d,h.target.result]),i.readAsDataURL(o)})},V=r=>{I(t=>t.filter((a,o)=>o!==r)),f(t=>t.filter((a,o)=>o!==r))},Y=()=>{const r={};return s.name.trim()||(r.name="Required"),s.description.trim()||(r.description="Required"),(!s.price||+s.price<=0)&&(r.price="Enter a valid price"),(s.advance===""||+s.advance<0)&&(r.advance="Enter a valid amount"),!m&&!w&&(r.thumbnail="Please upload a thumbnail"),r},Z=async r=>{r.preventDefault();const t=Y();if(Object.keys(t).length){D(t),b({open:!0,msg:"Please fix the highlighted fields.",severity:"error"});return}try{M(!0);const a=localStorage.getItem("moduleId"),i=JSON.parse(localStorage.getItem("user")||"{}")._id,h=localStorage.getItem("token");if(!a||!i)throw new Error("Module or Vendor session missing");const d=new FormData;d.append("secondaryModule",a),d.append("providerId",i),d.append("packageName",s.name),d.append("description",s.description),d.append("packagePrice",s.price),d.append("advanceBookingAmount",s.advance),w&&d.append("thumbnail",w),N.forEach(Q=>d.append("images",Q));const _=m?`${x}/api/invitation/${y}`:`${x}/api/invitation/create`,$=await fetch(_,{method:m?"PUT":"POST",headers:h?{Authorization:`Bearer ${h}`}:void 0,body:d}),K=await $.json();if(!$.ok)throw new Error(K.message||"Something went wrong");b({open:!0,msg:"Invitation package published! ðŸŽ‰",severity:"success"}),m||(P({name:"",description:"",price:"",advance:""}),E(null),g(null),I([]),f([]))}catch(a){b({open:!0,msg:a.message,severity:"error"})}finally{M(!1)}};return e.jsxs(re,{theme:pe,children:[e.jsx(ae,{}),e.jsxs(n,{sx:{width:"100%",bgcolor:"#FDF6EE",minHeight:"100%",py:{xs:3,sm:4},px:{xs:2,sm:3,md:4}},children:[e.jsxs(n,{sx:{mb:3.5},children:[e.jsxs(l,{variant:"h4",fontWeight:700,sx:{fontSize:{xs:"1.65rem",sm:"2rem"},lineHeight:1.2},children:["Add"," ",e.jsx(n,{component:"em",sx:{color:"primary.main",fontStyle:"italic"},children:"Invitation"})," ","Package"]}),e.jsx(l,{variant:"body2",color:"text.secondary",mt:.75,fontSize:"13.5px",children:"Design and showcase your printing & invitation masterpieces."})]}),e.jsxs(n,{sx:{bgcolor:"#1A0A00",px:3.5,py:2.25,borderRadius:"16px 16px 0 0",display:"flex",alignItems:"center",gap:2},children:[e.jsx(R,{sx:{bgcolor:"rgba(225, 91, 101, 0.3)",borderRadius:"10px",width:38,height:38,fontSize:"15px"},children:"âœ¦"}),e.jsxs(n,{children:[e.jsx(l,{sx:{color:"#F7EDE0",fontFamily:"'Playfair Display', serif",fontSize:"1.05rem"},children:"Package Details"}),e.jsx(l,{sx:{color:"rgba(255,255,255,0.3)",fontSize:"11.5px"},children:"All * fields are required"})]})]}),C&&e.jsx(ie,{color:"primary"}),e.jsx(n,{component:"form",onSubmit:Z,noValidate:!0,sx:{border:"1px solid rgba(225, 91, 101, 0.11)",borderTop:"none",borderRadius:"0 0 16px 16px",bgcolor:"#FDF6EE",p:3,boxShadow:"0 4px 24px rgba(225, 91, 101, 0.06)"},children:e.jsxs(v,{spacing:2.5,children:[e.jsxs(j,{elevation:0,sx:S,children:[e.jsx(A,{children:"Package Name"}),e.jsx(k,{label:"Package Name *",placeholder:"e.g. Premium Laser-Cut Wedding Invite",fullWidth:!0,value:s.name,onChange:r=>F("name",r.target.value),error:!!c.name,helperText:c.name})]}),e.jsxs(j,{elevation:0,sx:S,children:[e.jsx(A,{children:"Description"}),e.jsx(k,{label:"Description *",placeholder:"Paper quality, print type, card dimensions, inclusions...",fullWidth:!0,multiline:!0,rows:4,value:s.description,onChange:r=>F("description",r.target.value),error:!!c.description,helperText:c.description})]}),e.jsxs(j,{elevation:0,sx:S,children:[e.jsx(A,{children:"Pricing"}),e.jsxs(v,{direction:{xs:"column",sm:"row"},spacing:2.5,children:[e.jsx(k,{label:"Base Price *",placeholder:"0",fullWidth:!0,type:"number",value:s.price,onChange:r=>F("price",r.target.value),error:!!c.price,helperText:c.price,InputProps:{startAdornment:e.jsx(L,{position:"start",children:e.jsx(l,{color:"primary.main",fontWeight:700,children:"â‚¹"})})}}),e.jsx(k,{label:"Advance Amount *",placeholder:"0",fullWidth:!0,type:"number",value:s.advance,onChange:r=>F("advance",r.target.value),error:!!c.advance,helperText:c.advance,InputProps:{startAdornment:e.jsx(L,{position:"start",children:e.jsx(l,{color:"secondary.main",fontWeight:700,children:"â‚¹"})})}})]})]}),e.jsxs(u,{container:!0,spacing:3,children:[e.jsx(u,{item:!0,xs:12,md:6,children:e.jsxs(j,{elevation:0,sx:{...S,height:"100%",display:"flex",flexDirection:"column"},children:[e.jsx(A,{children:"Package Thumbnail"}),e.jsx(l,{variant:"caption",color:"text.secondary",sx:{mb:2,display:"block"},children:"Main image displayed in catalogs and lists."}),e.jsxs(n,{component:"label",htmlFor:"thumb-img",sx:{flexGrow:1,border:"2px dashed",borderColor:c.thumbnail?"#dc2626":"rgba(225, 91, 101, 0.2)",borderRadius:"16px",p:2,textAlign:"center",cursor:"pointer",bgcolor:"#FFFBF7",transition:"all 0.3s ease",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:220,"&:hover":{borderColor:"#E15B65",bgcolor:"rgba(225, 91, 101, 0.04)",transform:"scale(1.01)"}},children:[e.jsx("input",{id:"thumb-img",type:"file",accept:"image/*",hidden:!0,onChange:r=>q(r.target.files[0])}),W?e.jsxs(n,{sx:{position:"relative",width:"100%",height:"100%",minHeight:180},children:[e.jsx(n,{component:"img",src:W,sx:{width:"100%",height:"100%",maxHeight:220,objectFit:"cover",borderRadius:"10px"}}),e.jsx(U,{size:"small",sx:{position:"absolute",top:8,right:8,bgcolor:"rgba(255,255,255,0.9)","&:hover":{bgcolor:"#fff"}},onClick:r=>{r.preventDefault(),g(null),E(null)},children:e.jsx(H,{fontSize:"small"})})]}):e.jsxs(v,{alignItems:"center",spacing:1.5,children:[e.jsx(R,{sx:{bgcolor:"rgba(225, 91, 101, 0.1)",color:"#E15B65",width:56,height:56},children:e.jsx(se,{})}),e.jsxs(n,{children:[e.jsx(l,{variant:"subtitle2",fontWeight:700,children:"Click to upload thumbnail"}),e.jsx(l,{variant:"caption",color:"text.secondary",children:"PNG, JPG or JPEG (Max 5MB)"})]})]})]}),c.thumbnail&&e.jsx(oe,{error:!0,sx:{mt:1,ml:1},children:c.thumbnail})]})}),e.jsx(u,{item:!0,xs:12,md:6,children:e.jsxs(j,{elevation:0,sx:{...S,height:"100%",display:"flex",flexDirection:"column"},children:[e.jsx(A,{children:"Work Portfolio (Gallery)"}),e.jsx(l,{variant:"caption",color:"text.secondary",sx:{mb:2,display:"block"},children:"Additional photos showcasing details and variations."}),e.jsxs(n,{component:"label",htmlFor:"gallery-imgs",sx:{flexGrow:1,border:"2px dashed rgba(225, 91, 101, 0.2)",borderRadius:"16px",p:2,textAlign:"center",cursor:"pointer",bgcolor:"#FFFBF7",transition:"all 0.3s ease",display:"flex",flexDirection:"column",minHeight:220,"&:hover":{borderColor:"#E15B65",bgcolor:"rgba(225, 91, 101, 0.04)"}},children:[e.jsx("input",{id:"gallery-imgs",type:"file",accept:"image/*",multiple:!0,hidden:!0,onChange:r=>J(r.target.files)}),z.length>0?e.jsxs(u,{container:!0,spacing:1.5,children:[z.map((r,t)=>e.jsx(u,{item:!0,xs:4,children:e.jsxs(n,{sx:{position:"relative",pt:"100%"},children:[e.jsx(n,{component:"img",src:r,sx:{position:"absolute",top:0,left:0,width:"100%",height:"100%",objectFit:"cover",borderRadius:"8px",border:"1px solid rgba(0,0,0,0.05)"}}),e.jsx(U,{size:"small",sx:{position:"absolute",top:4,right:4,bgcolor:"rgba(255,255,255,0.8)",p:.3,"&:hover":{bgcolor:"#fff"}},onClick:a=>{a.preventDefault(),V(t)},children:e.jsx(H,{sx:{fontSize:14}})})]})},t)),e.jsx(u,{item:!0,xs:4,children:e.jsx(n,{sx:{pt:"100%",position:"relative",border:"2px dashed rgba(225, 91, 101, 0.15)",borderRadius:"8px",display:"flex",alignItems:"center",justifyContent:"center","&:hover":{bgcolor:"rgba(225, 91, 101, 0.05)"}},children:e.jsx(O,{color:"primary",sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",opacity:.6}})})})]}):e.jsxs(v,{alignItems:"center",spacing:1.5,sx:{my:"auto"},children:[e.jsx(R,{sx:{bgcolor:"rgba(212, 160, 23, 0.1)",color:"#D4A017",width:56,height:56},children:e.jsx(O,{})}),e.jsxs(n,{children:[e.jsx(l,{variant:"subtitle2",fontWeight:700,children:"Add Project Images"}),e.jsx(l,{variant:"caption",color:"text.secondary",children:"Upload up to 10 gallery photos"})]})]})]})]})})]}),e.jsxs(v,{direction:"row",spacing:2,pt:2,children:[e.jsx(G,{type:"submit",variant:"contained",size:"large",fullWidth:!0,startIcon:e.jsx(de,{}),disabled:C,sx:{py:1.5,background:"linear-gradient(135deg, #E15B65 0%, #C2444E 100%)"},children:C?"Processing...":m?"Update Package":"Publish Invitation"}),!m&&e.jsx(G,{variant:"outlined",size:"large",fullWidth:!0,startIcon:e.jsx(ce,{}),onClick:()=>{P({name:"",description:"",price:"",advance:""}),g(null),f([])},children:"Reset"})]})]})})]}),e.jsx(ne,{open:B.open,autoHideDuration:3500,onClose:()=>b(r=>({...r,open:!1})),anchorOrigin:{vertical:"top",horizontal:"right"},children:e.jsx(le,{severity:B.severity,variant:"filled",onClose:()=>b(r=>({...r,open:!1})),sx:{borderRadius:"12px"},children:B.msg})})]})}export{ge as default};
