import{w as O,r as n,j as e,B as o,T as r,x as R,a8 as V,s as F,t as G,S as _,at as C,b as h,V as H,an as J,a9 as U,aa as $,ab as K,G as y,p as q,M as T,P as Q,ag as X,av as Y,ad as Z,g as z,h as ee}from"./index-B1D2Baoc.js";import{C as k}from"./Chat-BLutm7m0.js";import{C as se}from"./Close-CDVZGfaB.js";import{E as te}from"./Event-DVqZnAog.js";import{C as ie}from"./Category-DiAtrJ01.js";import{A as ne}from"./AccessTime-9Ha3uolO.js";import{E as le}from"./EnquiryChatDialog-DHxKuOiJ.js";import{T as re}from"./TableContainer-DeaHbnf6.js";import{T as ae,a as u,b as t,c as oe}from"./TableRow-CDkjtdnz.js";import{T as ce}from"./TableHead-DSsOBCf5.js";import"./Send-wuNDaHOg.js";import"./ChatBubbleOutline-DWeJEDMT.js";import"./socket-BpXQx-Y7.js";const ve=()=>{var D;O();const[c,B]=n.useState(""),[L,S]=n.useState([]),[j,b]=n.useState(!0),[v,m]=n.useState(null),[f,A]=n.useState(null),[N,I]=n.useState(!1),[l,E]=n.useState(null),[W,p]=n.useState(!1),[P,g]=n.useState(null);n.useEffect(()=>{const s=localStorage.getItem("user");if(s){const i=JSON.parse(s);A(i.providerId||i._id)}},[]),n.useEffect(()=>{(async()=>{if(!f){m("Provider ID not found"),b(!1);return}try{const i=await ee.get(`https://api.bookmyevent.ae/api/enquiries/provider/${f}`);S(i.data.data||[]),m(null)}catch{m("Failed to fetch enquiries"),S([])}finally{b(!1)}})()},[f]);const w=L.filter(s=>{var i;return(s.fullName||"").toLowerCase().includes(c.toLowerCase())||(s.email||"").toLowerCase().includes(c.toLowerCase())||(s.contact||"").includes(c)||(((i=s.moduleId)==null?void 0:i.title)||"").toLowerCase().includes(c.toLowerCase())}),M=s=>{E(s),I(!0)},d=()=>{I(!1),E(null)},a=({icon:s,label:i,value:x})=>e.jsxs(o,{display:"flex",alignItems:"center",gap:2,py:1.5,sx:{borderBottom:"1px solid",borderColor:"divider","&:last-child":{borderBottom:"none"}},children:[e.jsx(o,{sx:{width:40,height:40,borderRadius:"50%",bgcolor:"primary.light",color:"primary.main",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},children:s}),e.jsxs(o,{children:[e.jsx(r,{variant:"caption",color:"text.secondary",children:i}),e.jsx(r,{fontWeight:500,children:x||"N/A"})]})]});return e.jsxs(o,{p:2,children:[e.jsx(r,{variant:"h4",gutterBottom:!0,children:"Enquiries"}),v&&e.jsx(R,{severity:"error",sx:{mb:2},children:v}),e.jsxs(V,{sx:{mt:2},children:[e.jsx(o,{p:2,children:e.jsx(F,{label:"Search enquiries",size:"small",value:c,onChange:s=>B(s.target.value),fullWidth:!0})}),e.jsx(re,{children:e.jsxs(ae,{children:[e.jsx(ce,{children:e.jsxs(u,{children:[e.jsx(t,{children:"#"}),e.jsx(t,{children:"Customer"}),e.jsx(t,{children:"Module"}),e.jsx(t,{children:"Contact"}),e.jsx(t,{children:"Date"}),e.jsx(t,{align:"center",children:"Actions"})]})}),e.jsxs(oe,{children:[j&&e.jsx(u,{children:e.jsx(t,{colSpan:6,align:"center",children:e.jsx(G,{size:28})})}),!j&&w.map((s,i)=>{var x;return e.jsxs(u,{hover:!0,children:[e.jsx(t,{children:i+1}),e.jsxs(t,{children:[e.jsx(r,{fontWeight:600,children:s.fullName}),e.jsx(r,{variant:"caption",color:"text.secondary",children:s.email})]}),e.jsx(t,{children:(x=s.moduleId)==null?void 0:x.title}),e.jsx(t,{children:s.contact}),e.jsx(t,{children:new Date(s.bookingDate).toLocaleDateString()}),e.jsx(t,{align:"center",children:e.jsxs(_,{direction:"row",spacing:1,justifyContent:"center",children:[e.jsx(C,{title:"Chat",children:e.jsx(h,{size:"small",color:"primary",onClick:()=>{g(s),p(!0)},children:e.jsx(k,{fontSize:"small"})})}),e.jsx(C,{title:"View",children:e.jsx(h,{size:"small",color:"info",onClick:()=>M(s),children:e.jsx(H,{fontSize:"small"})})}),e.jsx(C,{title:"Delete",children:e.jsx(h,{size:"small",color:"error",children:e.jsx(J,{fontSize:"small"})})})]})})]},s._id)}),!j&&w.length===0&&e.jsx(u,{children:e.jsx(t,{colSpan:6,align:"center",children:"No enquiries found"})})]})]})})]}),e.jsxs(U,{open:N,onClose:d,maxWidth:"md",fullWidth:!0,children:[e.jsx($,{sx:{bgcolor:"primary.main",color:"white"},children:e.jsxs(o,{display:"flex",justifyContent:"space-between",children:[e.jsx(r,{fontWeight:600,children:"Enquiry Details"}),e.jsx(h,{onClick:d,sx:{color:"white"},children:e.jsx(se,{})})]})}),e.jsx(K,{children:l&&e.jsxs(y,{container:!0,spacing:3,mt:1,children:[e.jsx(y,{item:!0,xs:12,md:6,children:e.jsx(q,{variant:"outlined",children:e.jsxs(T,{children:[e.jsx(r,{fontWeight:600,mb:2,children:"Customer Information"}),e.jsx(a,{icon:e.jsx(Q,{fontSize:"small"}),label:"Full Name",value:l.fullName}),e.jsx(a,{icon:e.jsx(X,{fontSize:"small"}),label:"Email",value:l.email}),e.jsx(a,{icon:e.jsx(Y,{fontSize:"small"}),label:"Contact",value:l.contact})]})})}),e.jsx(y,{item:!0,xs:12,md:6,children:e.jsx(q,{variant:"outlined",children:e.jsxs(T,{children:[e.jsx(r,{fontWeight:600,mb:2,children:"Booking Information"}),e.jsx(a,{icon:e.jsx(ie,{fontSize:"small"}),label:"Module",value:(D=l.moduleId)==null?void 0:D.title}),e.jsx(a,{icon:e.jsx(te,{fontSize:"small"}),label:"Booking Date",value:new Date(l.bookingDate).toLocaleDateString()}),e.jsx(a,{icon:e.jsx(ne,{fontSize:"small"}),label:"Created At",value:new Date(l.createdAt).toLocaleString()})]})})})]})}),e.jsxs(Z,{children:[e.jsx(z,{onClick:d,variant:"outlined",children:"Close"}),e.jsx(z,{variant:"contained",startIcon:e.jsx(k,{}),onClick:()=>{d(),g(l),p(!0)},children:"Open Chat"})]})]}),e.jsx(le,{open:W,onClose:()=>{p(!1),g(null)},enquiry:P})]})};export{ve as default};
