import{w as O,r as a,j as e,B as c,T as l,x as G,a8 as _,s as H,t as J,S as K,aj as p,b as u,V as Q,ap as U,a9 as X,aa as Y,ab as Z,G as g,p as B,M as L,P as $,ag as ee,av as ie,ad as te,g as A,h as re}from"./index-CxFmThG8.js";import{C as N}from"./Chat-B37pLeGZ.js";import{C as ae}from"./Close-BuO2MOoh.js";import{E as ne}from"./Event-BOAm-gH6.js";import{C as le}from"./Category-BrY0Mpzm.js";import{A as se}from"./AccessTime-CL4dsrjI.js";import{T as oe}from"./TableContainer-MWnyzJ5Y.js";import{T as ce,a as x,b as t,c as de}from"./TableRow-BobOFfSn.js";import{T as ue}from"./TableHead-DUu2iJwC.js";var ye=function(){var D;var C=O(),[h,W]=a.useState(""),[P,y]=a.useState([]),[j,b]=a.useState(!0),[S,m]=a.useState(null),[f,M]=a.useState(null),[R,I]=a.useState(!1),[n,w]=a.useState(null);a.useEffect(function(){var i=localStorage.getItem("user");if(i){var r=JSON.parse(i);M(r.providerId||r._id)}},[]),a.useEffect(function(){var i=async function(){if(!f){m("Provider ID not found"),b(!1);return}try{var r=await re.get("https://api.bookmyevent.ae/api/enquiries/provider/"+f),s=r.data.data||[],F=s.filter(function(v){var z,k;var E=(((z=v.moduleId)==null?void 0:z.moduleType)||"").toLowerCase(),T=(((k=v.moduleId)==null?void 0:k.title)||"").toLowerCase();return E==="transport"||E==="vehicle"||T.includes("transport")||T.includes("vehicle")});y(F),m(null)}catch{m("Failed to fetch enquiries"),y([])}finally{b(!1)}};i()},[f]);var q=P.filter(function(i){var s;var r=h.toLowerCase();return(i.fullName||"").toLowerCase().includes(r)||(i.email||"").toLowerCase().includes(r)||(i.contact||"").includes(h)||(((s=i.moduleId)==null?void 0:s.title)||"").toLowerCase().includes(r)}),V=function(i){w(i),I(!0)},d=function(){I(!1),w(null)},o=function(i){return e.jsxs(c,{display:"flex",alignItems:"center",gap:2,py:1.5,sx:{borderBottom:"1px solid",borderColor:"divider","&:last-child":{borderBottom:"none"}},children:[e.jsx(c,{sx:{width:40,height:40,borderRadius:"50%",bgcolor:"primary.light",color:"primary.main",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},children:i.icon}),e.jsxs(c,{children:[e.jsx(l,{variant:"caption",color:"text.secondary",children:i.label}),e.jsx(l,{fontWeight:500,children:i.value||"N/A"})]})]})};return e.jsxs(c,{p:2,children:[e.jsx(l,{variant:"h4",gutterBottom:!0,children:"Transport Enquiries"}),S&&e.jsx(G,{severity:"error",sx:{mb:2},children:S}),e.jsxs(_,{sx:{mt:2},children:[e.jsx(c,{p:2,children:e.jsx(H,{label:"Search enquiries",size:"small",value:h,onChange:function(i){W(i.target.value)},fullWidth:!0})}),e.jsx(oe,{children:e.jsxs(ce,{children:[e.jsx(ue,{children:e.jsxs(x,{children:[e.jsx(t,{children:"#"}),e.jsx(t,{children:"Customer"}),e.jsx(t,{children:"Module"}),e.jsx(t,{children:"Contact"}),e.jsx(t,{children:"Date"}),e.jsx(t,{align:"center",children:"Actions"})]})}),e.jsxs(de,{children:[j&&e.jsx(x,{children:e.jsx(t,{colSpan:6,align:"center",children:e.jsx(J,{size:28})})}),!j&&q.map(function(i,r){var s;return e.jsxs(x,{hover:!0,children:[e.jsx(t,{children:r+1}),e.jsxs(t,{children:[e.jsx(l,{fontWeight:600,children:i.fullName}),e.jsx(l,{variant:"caption",color:"text.secondary",children:i.email})]}),e.jsx(t,{children:(s=i.moduleId)==null?void 0:s.title}),e.jsx(t,{children:i.contact}),e.jsx(t,{children:new Date(i.bookingDate).toLocaleDateString()}),e.jsx(t,{align:"center",children:e.jsxs(K,{direction:"row",spacing:1,justifyContent:"center",children:[e.jsx(p,{title:"Chat",children:e.jsx(u,{size:"small",color:"primary",onClick:function(){C("/vehicles/enquirychat",{state:{enquiry:i}})},children:e.jsx(N,{fontSize:"small"})})}),e.jsx(p,{title:"View",children:e.jsx(u,{size:"small",color:"info",onClick:function(){V(i)},children:e.jsx(Q,{fontSize:"small"})})}),e.jsx(p,{title:"Delete",children:e.jsx(u,{size:"small",color:"error",children:e.jsx(U,{fontSize:"small"})})})]})})]},i._id)}),!j&&q.length===0&&e.jsx(x,{children:e.jsx(t,{colSpan:6,align:"center",children:"No enquiries found"})})]})]})})]}),e.jsxs(X,{open:R,onClose:d,maxWidth:"md",fullWidth:!0,children:[e.jsx(Y,{sx:{bgcolor:"primary.main",color:"white"},children:e.jsxs(c,{display:"flex",justifyContent:"space-between",children:[e.jsx(l,{fontWeight:600,children:"Enquiry Details"}),e.jsx(u,{onClick:d,sx:{color:"white"},children:e.jsx(ae,{})})]})}),e.jsx(Z,{children:n&&e.jsxs(g,{container:!0,spacing:3,mt:1,children:[e.jsx(g,{item:!0,xs:12,md:6,children:e.jsx(B,{variant:"outlined",children:e.jsxs(L,{children:[e.jsx(l,{fontWeight:600,mb:2,children:"Customer Information"}),e.jsx(o,{icon:e.jsx($,{fontSize:"small"}),label:"Full Name",value:n.fullName}),e.jsx(o,{icon:e.jsx(ee,{fontSize:"small"}),label:"Email",value:n.email}),e.jsx(o,{icon:e.jsx(ie,{fontSize:"small"}),label:"Contact",value:n.contact})]})})}),e.jsx(g,{item:!0,xs:12,md:6,children:e.jsx(B,{variant:"outlined",children:e.jsxs(L,{children:[e.jsx(l,{fontWeight:600,mb:2,children:"Booking Information"}),e.jsx(o,{icon:e.jsx(le,{fontSize:"small"}),label:"Module",value:(D=n.moduleId)==null?void 0:D.title}),e.jsx(o,{icon:e.jsx(ne,{fontSize:"small"}),label:"Booking Date",value:new Date(n.bookingDate).toLocaleDateString()}),e.jsx(o,{icon:e.jsx(se,{fontSize:"small"}),label:"Created At",value:new Date(n.createdAt).toLocaleString()})]})})})]})}),e.jsxs(te,{children:[e.jsx(A,{onClick:d,variant:"outlined",children:"Close"}),e.jsx(A,{variant:"contained",startIcon:e.jsx(N,{}),onClick:function(){d(),C("/vehicles/enquirychat",{state:{enquiry:n}})},children:"Open Chat"})]})]})]})};export{ye as default};
