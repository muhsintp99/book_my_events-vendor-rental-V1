import{c as v,j as e,r as n,h as j,a7 as X,H as x,B as a,q as D,T as o,a4 as K,S as B,am as Q,x as T,G as h,p as y,M as A,s as L,a as U,bf as Z,t as Y,ae as ee,D as re,a3 as d,al as se,g as ae,bk as te,b as oe}from"./index-DMZaeTtO.js";import{L as k}from"./LocalOffer-DuV77hiR.js";import{E as $}from"./Edit-qxOsFocy.js";import{C as ie}from"./CurrencyRupee-D52TH3x3.js";import{C as ne}from"./CloudUpload-B5f7l4wN.js";const de=v(e.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m5 11h-4v4h-2v-4H7v-2h4V7h2v4h4z"})),le=v(e.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m5 11H7v-2h10z"})),ce=v(e.jsx("path",{d:"M17 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V7zm-5 16c-1.66 0-3-1.34-3-3s1.34-3 3-3 3 1.34 3 3-1.34 3-3 3m3-10H5V5h10z"})),xe=v(e.jsx("path",{d:"M5 4v3h5.5v12h3V7H19V4z"})),pe=x(se)(({theme:s})=>({background:"linear-gradient(135deg, #ffffff 0%, #f8faff 100%)",borderRadius:32,border:"1px solid",borderColor:d(s.palette.primary.main,.08),boxShadow:"0 20px 40px rgba(0,0,0,0.04)",overflow:"hidden",position:"relative","&::before":{content:'""',position:"absolute",top:0,left:0,right:0,height:6,background:"linear-gradient(90deg, #FF9A9E 0%, #FAD0C4 100%)"}})),he=x(te.div)(({theme:s})=>({background:"rgba(255, 255, 255, 0.7)",backdropFilter:"blur(10px)",borderRadius:24,border:"1px solid rgba(255, 255, 255, 0.3)",boxShadow:"0 10px 30px rgba(0,0,0,0.05)",padding:s.spacing(3),height:"100%",transition:"all 0.4s cubic-bezier(0.4, 0, 0.2, 1)",cursor:"default",position:"relative",overflow:"hidden",display:"flex",flexDirection:"column","&:hover":{transform:"translateY(-8px)",boxShadow:"0 20px 40px rgba(255, 154, 158, 0.15)",borderColor:d("#FF9A9E",.2)}})),ge=x(a)(({theme:s})=>({width:64,height:64,borderRadius:20,background:"linear-gradient(135deg, #fff 0%, #f0f4f8 100%)",display:"flex",alignItems:"center",justifyContent:"center",boxShadow:"inset 0 2px 4px rgba(0,0,0,0.05), 0 10px 20px rgba(0,0,0,0.05)",marginBottom:s.spacing(2),transition:"transform 0.3s ease","& img":{width:"70%",height:"70%",objectFit:"contain"}})),H=x(oe)(({theme:s,variant:l})=>({backgroundColor:l==="delete"?d(s.palette.error.main,.05):d(s.palette.primary.main,.05),color:l==="delete"?s.palette.error.main:s.palette.primary.main,margin:s.spacing(0,.5),"&:hover":{backgroundColor:l==="delete"?s.palette.error.main:s.palette.primary.main,color:"#fff",transform:"scale(1.1)"},transition:"all 0.2s ease"})),me=x(a)(({theme:s})=>({border:"2px dashed #e0e0e0",borderRadius:16,padding:s.spacing(4),textAlign:"center",backgroundColor:"#fafafa",transition:"all 0.3s ease",cursor:"pointer","&:hover":{borderColor:"#FF9A9E",backgroundColor:"#fff9f9"}}));x(y)(({theme:s})=>({borderRadius:12,border:"1px solid #f0f0f0",transition:"all 0.2s ease","&:hover":{borderColor:"#FF9A9E",boxShadow:"0 4px 12px rgba(255, 154, 158, 0.1)"}}));const M=x(ae)(({theme:s})=>({borderRadius:16,textTransform:"none",fontWeight:700,padding:s.spacing(1.8,4),fontSize:"1rem",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",letterSpacing:"0.5px",boxShadow:"0 8px 16px rgba(0,0,0,0.05)","&:hover":{transform:"translateY(-2px)",boxShadow:"0 12px 24px rgba(0,0,0,0.1)"},"&:active":{transform:"translateY(0)"}})),ue=x(M,{shouldForwardProp:s=>s!=="$isEditing"})(({theme:s,$isEditing:l})=>({background:l?"linear-gradient(135deg, #667eea 0%, #764ba2 100%)":"linear-gradient(135deg, #1e3c72 0%, #2a5298 100%)",color:"#fff",border:"none",minWidth:260,fontSize:"1.05rem",padding:s.spacing(2,6),boxShadow:"0 10px 20px rgba(30, 60, 114, 0.2)","&:hover":{background:l?"linear-gradient(135deg, #5a6fd6 0%, #6a4491 100%)":"linear-gradient(135deg, #2a5298 0%, #1e3c72 100%)",boxShadow:"0 15px 30px rgba(30, 60, 114, 0.3)",transform:"translateY(-3px)"},"&:disabled":{background:"#e0e0e0",color:"#9e9e9e"}})),Se=()=>{const[s,l]=n.useState(""),[f,C]=n.useState(""),[F,S]=n.useState(null),[z,w]=n.useState(null),[V,G]=n.useState(!1),[g,E]=n.useState([]),[u,m]=n.useState(!1),[R,c]=n.useState(null),[b,N]=n.useState(null),[p,W]=n.useState(null);n.useEffect(()=>{const r=localStorage.getItem("user");if(console.log("User Data from LocalStorage:",r),r)try{const t=JSON.parse(r),i=t._id||t.id||t.providerId||t.vendorId;console.log("Determined Provider ID:",i),i&&i!=="null"&&i!=="undefined"?N(i):(console.warn("No valid ID found in user object"),c("Could not identify vendor session. Login again."))}catch(t){console.error("Error parsing session data:",t),c("Session corrupted. Please login again.")}else console.warn("No user data found in localStorage"),c("You must be logged in to manage add-ons.")},[]),n.useEffect(()=>{b&&I()},[b]);const _=r=>{var i;const t=(i=r.target.files)==null?void 0:i[0];t&&(S(t),w(URL.createObjectURL(t)))},I=async()=>{try{m(!0);const r=await j.get(`https://api.bookmyevent.ae/api/cake-addons/provider/${b}`);r.data.success?E(r.data.data||[]):E([])}catch(r){console.error(r),c("Failed to fetch addons")}finally{m(!1)}},O=async()=>{var r,t;if(!s||!f||!F){c("Title, price and image are required");return}try{m(!0),c(null);const i=new FormData;i.append("title",s),i.append("price",f),i.append("provider",b),i.append("image",F),(p?await j.put(`https://api.bookmyevent.ae/api/cake-addons/${p}`,i):await j.post("https://api.bookmyevent.ae/api/cake-addons",i)).data.success&&(I(),P())}catch(i){c(((t=(r=i.response)==null?void 0:r.data)==null?void 0:t.message)||"Save failed")}finally{m(!1)}},q=r=>{W(r._id),l(r.title),C(r.price),w(r.image),S(null),window.scrollTo({top:0,behavior:"smooth"})},J=async r=>{if(window.confirm("Are you sure you want to delete this addon group?"))try{m(!0),(await j.delete(`https://api.bookmyevent.ae/api/cake-addons/${r}`)).data.success&&I()}catch(t){console.error("Delete error:",t),c("Failed to delete addon")}finally{m(!1)}},P=()=>{W(null),l(""),C(""),S(null),w(null),c(null)};return e.jsx(X,{maxWidth:"lg",sx:{pt:2,pb:3},children:e.jsxs(pe,{sx:{p:{xs:3,md:5}},children:[e.jsxs(a,{sx:{mb:2},children:[e.jsxs(a,{sx:{display:"flex",alignItems:"center",gap:2,mb:1},children:[e.jsx(D,{sx:{bgcolor:"primary.main",width:48,height:48},children:e.jsx(k,{fontSize:"medium"})}),e.jsxs(a,{children:[e.jsx(o,{variant:"h4",fontWeight:800,gutterBottom:!0,children:"Cake Add-ons Manager"}),e.jsx(o,{variant:"body1",color:"text.secondary",children:"Create beautiful add-ons with pricing, descriptions, and images"})]})]}),e.jsx(K,{label:`${g.length} add-on${g.length!==1?"s":""}`,color:"primary",variant:"outlined",sx:{mt:1}})]}),e.jsxs(B,{spacing:2,sx:{mb:3},children:[e.jsx(Q,{in:V,children:e.jsx(T,{severity:"success",sx:{borderRadius:2},onClose:()=>G(!1),children:"Add-ons saved successfully!"})}),R&&e.jsx(T,{severity:"error",sx:{borderRadius:2},onClose:()=>c(null),children:R})]}),e.jsxs(h,{container:!0,spacing:2.5,children:[e.jsxs(h,{size:{xs:12,md:8},children:[e.jsx(y,{sx:{mb:4,borderRadius:3},children:e.jsxs(A,{children:[e.jsxs(a,{sx:{display:"flex",alignItems:"center",mb:3},children:[e.jsx(xe,{color:"primary",sx:{mr:2}}),e.jsx(o,{variant:"h6",fontWeight:600,children:"Basic Information"})]}),e.jsxs(B,{spacing:3,children:[e.jsx(L,{fullWidth:!0,label:"Add-ons Title",placeholder:"e.g. Sparkler Candle",value:s,onChange:r=>l(r.target.value),InputProps:{startAdornment:e.jsx(U,{position:"start",children:e.jsx($,{fontSize:"small"})})}}),e.jsx(L,{fullWidth:!0,label:"Price",value:f,onChange:r=>C(r.target.value),InputProps:{startAdornment:e.jsx(U,{position:"start",children:e.jsx(ie,{})})}})]})]})}),e.jsx(y,{sx:{mb:4,borderRadius:3},children:e.jsxs(A,{children:[e.jsxs(a,{sx:{display:"flex",alignItems:"center",mb:3},children:[e.jsx(Z,{color:"primary",sx:{mr:2}}),e.jsx(o,{variant:"h6",fontWeight:600,children:"Add-on Icon"})]}),e.jsxs(me,{onClick:()=>document.getElementById("image-upload").click(),children:[e.jsx("input",{id:"image-upload",hidden:!0,type:"file",accept:"image/*",onChange:_}),z?e.jsx(D,{src:z,sx:{width:120,height:120,borderRadius:3,boxShadow:"0 8px 16px rgba(0,0,0,0.1)"}}):e.jsxs(a,{sx:{py:2},children:[e.jsx(ne,{sx:{fontSize:48,color:"text.disabled",mb:1}}),e.jsx(o,{color:"text.secondary",children:"Upload Add-on Image"})]})]})]})})]}),e.jsx(h,{size:{xs:12,md:4},children:e.jsx(y,{sx:{borderRadius:3,border:"2px solid",borderColor:"primary.light"},children:e.jsxs(A,{children:[e.jsx(o,{variant:"h6",fontWeight:600,gutterBottom:!0,children:"Preview"}),e.jsxs(a,{sx:{mb:3},children:[e.jsx(o,{variant:"subtitle2",color:"text.secondary",gutterBottom:!0,children:"Title"}),e.jsx(o,{variant:"body1",children:s||"Your add-ons title will appear here"})]}),e.jsx(a,{sx:{pt:2,borderTop:1,borderColor:"divider"},children:e.jsxs(a,{sx:{display:"flex",justifyContent:"space-between",mb:2},children:[e.jsx(o,{variant:"body1",fontWeight:600,children:"Price"}),e.jsxs(o,{variant:"body1",fontWeight:700,color:"primary",children:["₹",f||"0.00"]})]})})]})})})]}),e.jsxs(a,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mt:4,pt:3,borderTop:1,borderColor:"divider"},children:[e.jsx(o,{variant:"body2",color:"text.secondary",children:"All changes are auto-saved locally"}),e.jsxs(a,{sx:{display:"flex",gap:2},children:[e.jsx(M,{variant:"outlined",color:p?"error":"inherit",onClick:P,disabled:u,startIcon:p?e.jsx(le,{}):e.jsx(de,{}),children:p?"Cancel Update":"Reset Form"}),e.jsx(ue,{variant:"contained",$isEditing:!!p,startIcon:u?e.jsx(Y,{size:24,color:"inherit"}):e.jsx(ce,{}),onClick:O,disabled:u,fullWidth:!1,sx:{minWidth:200},children:u?"Processing...":p?"Update Add-ons":"Save Add-ons"})]})]}),e.jsxs(a,{sx:{mt:8},children:[e.jsxs(a,{sx:{display:"flex",alignItems:"center",mb:4},children:[e.jsx(a,{sx:{width:40,height:4,bgcolor:"primary.main",borderRadius:2,mr:2}}),e.jsx(o,{variant:"h4",fontWeight:800,children:"Existing Add-on Library"})]}),e.jsx(h,{container:!0,spacing:4,children:u?e.jsx(h,{size:12,children:e.jsxs(a,{sx:{display:"flex",flexDirection:"column",alignItems:"center",py:10,gap:2},children:[e.jsx(Y,{size:56,thickness:4,color:"primary"}),e.jsx(o,{variant:"h6",color:"text.secondary",fontWeight:600,children:"Loading your premium library..."})]})}):g&&Array.isArray(g)&&g.length>0?g.map((r,t)=>e.jsx(h,{size:{xs:12,sm:6,md:4},children:e.jsxs(he,{children:[e.jsxs(a,{sx:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",mb:2},children:[e.jsx(ge,{children:r.image?e.jsx(a,{component:"img",src:r.image,alt:r.title,sx:{width:"80%",height:"80%",objectFit:"contain"}}):e.jsx(k,{sx:{color:"primary.light",fontSize:32}})}),e.jsxs(a,{sx:{display:"flex",gap:1},children:[e.jsx(H,{size:"small",onClick:()=>q(r),children:e.jsx($,{fontSize:"small"})}),e.jsx(H,{size:"small",variant:"delete",onClick:()=>J(r._id),children:e.jsx(ee,{fontSize:"small"})})]})]}),e.jsx(o,{variant:"h5",fontWeight:800,sx:{mb:1,color:"#1a2027",letterSpacing:"-0.025em"},children:r.title}),e.jsxs(a,{sx:{mt:"auto"},children:[e.jsx(re,{sx:{mb:2,borderColor:d("#000",.04)}}),e.jsxs(a,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",p:1.5,borderRadius:2,bgcolor:d("#FF9A9E",.04),border:"1px solid",borderColor:d("#FF9A9E",.1),transition:"all 0.2s ease","&:hover":{transform:"translateX(5px)",bgcolor:d("#FF9A9E",.08)}},children:[e.jsx(o,{variant:"body2",fontWeight:700,sx:{color:"#2d3748"},children:"Price"}),e.jsxs(o,{variant:"body2",fontWeight:800,color:"primary.main",children:["₹",r.price]})]})]})]})},r._id||`addon-${t}`)):e.jsx(h,{size:12,children:e.jsxs(a,{sx:{py:12,textAlign:"center",bgcolor:d("#f8fafc",.8),borderRadius:12,border:"2px dashed",borderColor:d("#cbd5e0",1),display:"flex",flexDirection:"column",alignItems:"center"},children:[e.jsx(a,{sx:{width:80,height:80,borderRadius:"50%",bgcolor:d("#FF9A9E",.1),display:"flex",alignItems:"center",justifyContent:"center",mb:2},children:e.jsx(k,{sx:{fontSize:40,color:"#FF9A9E"}})}),e.jsx(o,{variant:"h5",color:"text.primary",fontWeight:800,gutterBottom:!0,children:"No Add-ons found"}),e.jsx(o,{variant:"body1",color:"text.secondary",sx:{maxWidth:460},children:"Your premium cake library is empty. Please add some premium add-ons using the form above."})]})})})]})]})})};export{Se as default};
