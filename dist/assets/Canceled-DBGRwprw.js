import{c as N,j as e,r as y,B as r,S as u,T as n,s as L,a as W,t as R,a8 as z,h as P,G as f,q as H,a4 as E,af as _,b as $,ae as G,D as O,P as V,ag as J,ah as U,R as q}from"./index-CLsaspxs.js";import{A as D}from"./AccessTime-NBXRSZ1p.js";import{E as F}from"./ExpandMore-BcyQSudc.js";import{E as Y}from"./EventAvailable-c0x-J2LJ.js";import{C as M}from"./Cancel-1DW6ALJb.js";import{S as K}from"./Search-B2_-Eirq.js";const Q=N(e.jsx("path",{d:"M20.01 15.38c-1.23 0-2.42-.2-3.53-.56-.35-.12-.74-.03-1.01.24l-1.57 1.97c-2.83-1.35-5.48-3.9-6.89-6.83l1.95-1.66c.27-.28.35-.67.24-1.02-.37-1.11-.56-2.3-.56-3.53 0-.54-.45-.99-.99-.99H4.19C3.65 3 3 3.24 3 3.99 3 13.28 10.73 21 20.01 21c.71 0 .99-.63.99-1.18v-3.45c0-.54-.45-.99-.99-.99"})),T=N(e.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m1.41 16.09V20h-2.67v-1.93c-1.71-.36-3.16-1.46-3.27-3.4h1.96c.1 1.05.82 1.87 2.65 1.87 1.96 0 2.4-.98 2.4-1.59 0-.83-.44-1.61-2.67-2.14-2.48-.6-4.18-1.62-4.18-3.67 0-1.72 1.39-2.84 3.11-3.21V4h2.67v1.95c1.86.45 2.79 1.86 2.85 3.39H14.3c-.05-1.11-.64-1.87-2.22-1.87-1.5 0-2.4.68-2.4 1.64 0 .84.65 1.39 2.67 1.91s4.18 1.39 4.18 3.91c-.01 1.83-1.38 2.83-3.12 3.16"})),X=()=>{try{const t=localStorage.getItem("user");if(!t)return null;const o=JSON.parse(t);return(o==null?void 0:o._id)||null}catch(t){return console.error("Error parsing user:",t),null}},Z=t=>{if(!t)return"";const o=new Date,j=new Date(t),i=Math.floor((o-j)/1e3);if(i<60)return"Just now";const c=Math.floor(i/60);if(c<60)return`${c}m ago`;const d=Math.floor(c/60);return d<24?`${d}h ago`:`${Math.floor(d/24)}d ago`},ie=()=>{const[t,o]=y.useState([]),[j,i]=y.useState(!0),[c,d]=y.useState(null),[m,C]=y.useState(null),[S,k]=y.useState("");y.useEffect(()=>{C(X())},[]),y.useEffect(()=>{if(!m)return;(async()=>{var a;try{const v=(((a=(await P.get(`https://api.bookmyevent.ae/api/bookings/provider/${m}`)).data)==null?void 0:a.data)||[]).filter(x=>{var h,w;return((h=x.status)==null?void 0:h.toLowerCase())==="rejected"||((w=x.status)==null?void 0:w.toLowerCase())==="cancelled"});v.sort((x,h)=>new Date(h.createdAt)-new Date(x.createdAt)),o(v)}catch(b){console.error("Error fetching canceled bookings:",b)}finally{i(!1)}})()},[m]);const p=s=>{d(a=>a===s?null:s)},I=t.filter(s=>{var b,l,v,x,h;const a=S.toLowerCase();return s._id.toLowerCase().includes(a)||((b=s.fullName)==null?void 0:b.toLowerCase().includes(a))||((v=(l=s.venueId)==null?void 0:l.venueName)==null?void 0:v.toLowerCase().includes(a))||((h=(x=s.packageId)==null?void 0:x.title)==null?void 0:h.toLowerCase().includes(a))});return e.jsx(r,{p:3,sx:{background:"#f8fafc",minHeight:"100vh"},children:e.jsxs(r,{sx:{maxWidth:"1000px",margin:"0 auto"},children:[e.jsxs(u,{direction:{xs:"column",sm:"row"},justifyContent:"space-between",alignItems:"center",mb:4,gap:2,children:[e.jsxs(r,{children:[e.jsx(n,{variant:"h3",fontWeight:700,color:"#1e293b",children:"Canceled Bookings"}),e.jsxs(n,{variant:"body1",color:"text.secondary",mt:.5,children:[t.length," bookings canceled or rejected"]})]}),e.jsx(L,{placeholder:"Search ID, Name, Venue...",variant:"outlined",size:"small",value:S,onChange:s=>k(s.target.value),sx:{bgcolor:"white",borderRadius:2,width:{xs:"100%",sm:"300px"},"& .MuiOutlinedInput-root":{borderRadius:"10px"}},InputProps:{startAdornment:e.jsx(W,{position:"start",children:e.jsx(K,{sx:{color:"text.secondary"}})})}})]}),j?e.jsx(r,{display:"flex",justifyContent:"center",mt:8,children:e.jsx(R,{size:50,thickness:4})}):I.length===0?e.jsxs(z,{sx:{p:6,textAlign:"center",borderRadius:4,bgcolor:"#fff"},elevation:0,children:[e.jsx(M,{sx:{fontSize:60,color:"#cbd5e1",mb:2}}),e.jsx(n,{variant:"h6",color:"text.secondary",children:"No canceled bookings found."})]}):e.jsx(u,{spacing:3,children:I.map(s=>e.jsx(ee,{booking:s,expanded:c===s._id,onToggle:()=>p(s._id)},s._id))})]})})},ee=({booking:t,expanded:o,onToggle:j})=>{const{_id:i,venueId:c,packageId:d,makeupId:m,photographyId:C,moduleType:S,bookingDate:k,timeSlot:p,fullName:I,contactNumber:s,emailAddress:a,numberOfGuests:b,finalPrice:l,paymentStatus:v,bookingType:x,createdAt:h,status:w}=t,B=(c==null?void 0:c.venueName)||(d==null?void 0:d.title)||(m==null?void 0:m.name)||(C==null?void 0:C.name)||S||"Event Booking",A=typeof p=="object"?p==null?void 0:p.label:p;return e.jsxs(z,{elevation:0,sx:{borderRadius:"16px",border:"1px solid #e2e8f0",overflow:"hidden",transition:"all 0.3s ease","&:hover":{boxShadow:"0 10px 30px -10px rgba(0,0,0,0.1)",borderColor:"#cbd5e1",transform:"translateY(-2px)"}},children:[e.jsx(r,{onClick:j,sx:{p:3,cursor:"pointer",background:"#fff",position:"relative"},children:e.jsxs(f,{container:!0,spacing:2,alignItems:"center",children:[e.jsx(f,{item:!0,xs:12,md:5,children:e.jsxs(u,{direction:"row",spacing:2,alignItems:"center",children:[e.jsx(H,{sx:{bgcolor:"#fee2e2",color:"#ef4444",width:56,height:56},children:e.jsx(M,{})}),e.jsxs(r,{children:[e.jsx(n,{variant:"h6",fontWeight:700,color:"#0f172a",lineHeight:1.2,children:B}),e.jsxs(u,{direction:"row",spacing:1,alignItems:"center",mt:.5,children:[e.jsx(E,{label:S||"Service",size:"small",sx:{height:20,fontSize:"0.7rem",bgcolor:"#f1f5f9",color:"#475569"}}),e.jsxs(n,{variant:"caption",color:"text.secondary",children:["ID: #",i.slice(-6).toUpperCase()]})]})]})]})}),e.jsx(f,{item:!0,xs:12,sm:6,md:3,children:e.jsxs(u,{spacing:.5,children:[e.jsxs(r,{display:"flex",alignItems:"center",gap:1,children:[e.jsx(_,{sx:{fontSize:18,color:"#64748b"}}),e.jsx(n,{variant:"body2",fontWeight:600,color:"#334155",children:new Date(k).toDateString()})]}),e.jsxs(r,{display:"flex",alignItems:"center",gap:1,children:[e.jsx(D,{sx:{fontSize:18,color:"#64748b"}}),e.jsx(n,{variant:"body2",color:"#64748b",children:A||"N/A"})]})]})}),e.jsxs(f,{item:!0,xs:12,sm:6,md:3,sx:{textAlign:{xs:"left",md:"right"}},children:[e.jsxs(n,{variant:"h5",fontWeight:700,color:"#ef4444",children:["₹",l==null?void 0:l.toLocaleString()]}),e.jsxs(u,{direction:"row",justifyContent:{xs:"flex-start",md:"flex-end"},alignItems:"center",gap:1,mt:.5,children:[e.jsxs(n,{variant:"caption",color:"text.secondary",children:["Updated ",Z(h)]}),e.jsx(E,{label:w||"Cancelled",size:"small",sx:{bgcolor:"#fee2e2",color:"#ef4444",fontWeight:600,height:24,textTransform:"capitalize"}})]})]}),e.jsx(f,{item:!0,xs:12,md:1,sx:{display:"flex",justifyContent:"flex-end"},children:e.jsx($,{size:"small",sx:{transform:o?"rotate(180deg)":"rotate(0deg)",transition:"0.3s"},children:e.jsx(F,{})})})]})}),e.jsxs(G,{in:o,children:[e.jsx(O,{}),e.jsx(r,{sx:{p:3,bgcolor:"#f8fafc"},children:e.jsxs(f,{container:!0,spacing:3,children:[e.jsxs(f,{item:!0,xs:12,md:4,children:[e.jsx(n,{variant:"subtitle2",color:"text.secondary",fontWeight:600,mb:2,textTransform:"uppercase",children:"Customer Details"}),e.jsxs(u,{spacing:2,children:[e.jsx(g,{icon:e.jsx(V,{}),label:"Name",value:I}),e.jsx(g,{icon:e.jsx(Q,{}),label:"Phone",value:s}),e.jsx(g,{icon:e.jsx(J,{}),label:"Email",value:a})]})]}),e.jsxs(f,{item:!0,xs:12,md:4,children:[e.jsx(n,{variant:"subtitle2",color:"text.secondary",fontWeight:600,mb:2,textTransform:"uppercase",children:"Booking Info"}),e.jsxs(u,{spacing:2,children:[e.jsx(g,{icon:e.jsx(U,{}),label:"Guests",value:b||"N/A"}),e.jsx(g,{icon:e.jsx(Y,{}),label:"Type",value:x}),e.jsx(g,{icon:e.jsx(D,{}),label:"Time Slot",value:A||"N/A"})]})]}),e.jsxs(f,{item:!0,xs:12,md:4,children:[e.jsx(n,{variant:"subtitle2",color:"text.secondary",fontWeight:600,mb:2,textTransform:"uppercase",children:"Payment Summary"}),e.jsxs(u,{spacing:2,children:[e.jsx(g,{icon:e.jsx(T,{}),label:"Total",value:`₹${l==null?void 0:l.toLocaleString()}`,highlight:!0}),e.jsx(g,{icon:e.jsx(T,{}),label:"Status",value:v})]})]})]})})]})]})},g=({icon:t,label:o,value:j,highlight:i=!1})=>e.jsxs(r,{display:"flex",alignItems:"center",gap:1.5,children:[e.jsx(r,{sx:{color:i?"#ef4444":"#94a3b8"},children:q.cloneElement(t,{fontSize:"small"})}),e.jsxs(r,{children:[e.jsx(n,{variant:"caption",color:"text.secondary",display:"block",lineHeight:1,children:o}),e.jsx(n,{variant:"body2",fontWeight:i?700:500,color:i?"#ef4444":"#334155",children:j||"N/A"})]})]});export{ie as default};
