import{r as a,j as e,B as l,T as i,t as B,a9 as w,S as u,af as E,D as R,g as h,h as x}from"./index-CRCMV2pT.js";const _=()=>{try{const t=localStorage.getItem("user");if(!t)return null;const s=JSON.parse(t);return(s==null?void 0:s._id)||null}catch(t){return console.error("Error parsing user:",t),null}},D=()=>{const[t,s]=a.useState([]),[f,j]=a.useState(!0),[m,k]=a.useState(null),[g,b]=a.useState(null);a.useEffect(()=>{b(_())},[]),a.useEffect(()=>{if(!g)return;(async()=>{var r;try{const S=(((r=(await x.get(`https://api.bookmyevent.ae/api/bookings/provider/${g}`)).data)==null?void 0:r.data)||[]).filter(P=>{var p;return((p=P.status)==null?void 0:p.toLowerCase())==="pending"});s(S)}catch(n){console.error("Error fetching pending bookings:",n)}finally{j(!1)}})()},[g]);const y=o=>{k(r=>r===o?null:o)},v=async(o,r)=>{r.stopPropagation();try{await x.patch(`https://api.bookmyevent.ae/api/bookings/${o}/accept`),s(n=>n.filter(d=>d._id!==o)),alert("Booking Confirmed ✔️")}catch(n){console.error("Confirm error:",n),alert("Failed to confirm booking")}},C=async(o,r)=>{r.stopPropagation();try{await x.patch(`https://api.bookmyevent.ae/api/bookings/${o}/reject`),s(n=>n.filter(d=>d._id!==o)),alert("Booking Rejected ❌")}catch(n){console.error("Reject error:",n),alert("Failed to reject booking")}};return e.jsx(l,{p:2,sx:{background:"#f4f7fb",minHeight:"100vh"},children:e.jsxs(l,{sx:{maxWidth:"850px",margin:"0 auto"},children:[e.jsx(i,{variant:"h4",fontWeight:600,mb:3,children:"Pending Bookings"}),f?e.jsx(l,{display:"flex",justifyContent:"center",mt:4,children:e.jsx(B,{})}):t.length===0?e.jsx(i,{children:"No Pending Bookings Found"}):t.map(o=>e.jsxs(w,{elevation:2,sx:{p:2.5,mt:2,borderRadius:"16px",cursor:"pointer",transition:"0.2s",background:"#fff","&:hover":{boxShadow:"0px 4px 20px rgba(0,0,0,0.08)",transform:"translateY(-2px)"}},onClick:()=>y(o._id),children:[e.jsxs(u,{direction:"row",justifyContent:"space-between",alignItems:"center",children:[e.jsxs(l,{children:[e.jsxs(i,{fontWeight:700,fontSize:16,children:["Booking ID:"," ",e.jsxs("span",{style:{color:"#1976d2"},children:["#",o._id.slice(-6)]})]}),e.jsx(i,{color:"gray",fontSize:14,children:o.moduleType||"Event Booking"}),e.jsx(i,{color:"gray",fontSize:13,children:new Date(o.bookingDate).toDateString()})]}),e.jsxs(i,{fontWeight:700,sx:{color:"#16a34a"},children:["₹",o.finalPrice]})]}),e.jsxs(E,{in:m===o._id,children:[e.jsx(R,{sx:{my:2}}),e.jsxs(l,{sx:{background:"#f9fafb",p:2,borderRadius:"12px",border:"1px solid #e5e7eb"},children:[e.jsx(c,{label:"Customer",value:o.fullName}),e.jsx(c,{label:"Guests",value:o.numberOfGuests}),e.jsx(c,{label:"Email",value:o.emailAddress}),e.jsx(c,{label:"Phone",value:o.contactNumber}),e.jsx(c,{label:"Booking Type",value:o.bookingType})]}),e.jsxs(u,{direction:"row",spacing:2,mt:2,justifyContent:"center",children:[e.jsx(h,{variant:"outlined",sx:{width:"130px",borderRadius:"30px",color:"#e11d48",borderColor:"#e11d48","&:hover":{background:"#ffe4e6"}},onClick:r=>C(o._id,r),children:"Reject"}),e.jsx(h,{variant:"contained",sx:{width:"130px",borderRadius:"30px",bgcolor:"#16a34a","&:hover":{bgcolor:"#15803d"}},onClick:r=>v(o._id,r),children:"Confirm"})]})]})]},o._id))]})})},c=({label:t,value:s})=>e.jsxs(i,{fontSize:14,sx:{mb:.5},children:[e.jsxs("strong",{children:[t,":"]})," ",s]});export{D as default};
