import{g as X,n as Y,r as l,j as e,B as i,T as d,C as I,q as C,s as N,a as m,I as O,F as _,S as ee,M as q,x as te,y as ae,b as M,N as re,e as se}from"./index-CWJg_lwt.js";const ne=te(i)(({theme:o})=>({border:"2px dashed #e0e0e0",borderRadius:o.shape.borderRadius,padding:o.spacing(3),textAlign:"center",backgroundColor:o.palette.grey[50],cursor:"pointer",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:"150px","&:hover":{borderColor:o.palette.primary.main},'& input[type="file"]':{display:"none"}})),le=()=>{const o=X(),x=Y(o.breakpoints.down("md")),[b,R]=l.useState(""),[v,E]=l.useState(""),[j,z]=l.useState(""),[y,B]=l.useState(""),[w,L]=l.useState(""),[g,P]=l.useState(""),[U,k]=l.useState(""),[c,u]=l.useState(null),[W,a]=l.useState(!1),[S,r]=l.useState(""),[T,$]=l.useState([]);l.useEffect(()=>{const t=()=>{const s=localStorage.getItem("roles");if(s){const p=JSON.parse(s).map(n=>n.roleName);$(p)}};return t(),window.addEventListener("rolesUpdated",t),()=>window.removeEventListener("rolesUpdated",t)},[]);const H=t=>{const s=t.target.files[0];if(s){if(s.size>2097152){r("Image size must be less than 2 MB."),a(!0);return}const n=new Image;n.onload=()=>{n.width/n.height!==1||n.height/n.width!==1?(r("Image must have a 1:1 ratio."),a(!0),u(null)):u(s)},n.onerror=()=>{r("Invalid image file."),a(!0),u(null)};const f=URL.createObjectURL(s);n.src=f}},J=t=>{t.preventDefault()},G=t=>{t.preventDefault();const s=t.dataTransfer.files[0];if(s){if(s.size>2097152){r("Image size must be less than 2 MB."),a(!0);return}const n=new Image;n.onload=()=>{n.width/n.height!==1||n.height/n.width!==1?(r("Image must have a 1:1 ratio."),a(!0),u(null)):u(s)},n.onerror=()=>{r("Invalid image file."),a(!0),u(null)};const f=URL.createObjectURL(s);n.src=f}},A=()=>{R(""),E(""),z(""),B(""),L(""),P(""),k(""),u(null),a(!1),r("")},D=(t,s)=>{s!=="clickaway"&&(a(!1),r(""))},Q=t=>{t.preventDefault();const s=/^[a-zA-Z\s]{2,30}$/,p=/^\+?[1-9]\d{9,14}$/,n=/^[^\s@]+@[^\s@]+\.[^\s@]+$/,f=/^.{8,}$/;if(!s.test(b)){r("First name must be 2-30 letters only."),a(!0);return}if(!s.test(v)){r("Last name must be 2-30 letters only."),a(!0);return}if(!p.test(j)){r("Phone must be a valid number (10-15 digits, starting with country code)."),a(!0);return}if(!y){r("Please select a role."),a(!0);return}if(!n.test(w)){r("Please enter a valid email address."),a(!0);return}if(!f.test(g)){r("Password must be at least 8 characters long."),a(!0);return}if(g!==U){r("Passwords do not match."),a(!0);return}if(!c){r("Please upload an image."),a(!0);return}const Z=2*1024*1024;if(c.size>Z){r("Image size must be less than 2 MB."),a(!0);return}const h=new Image;h.onload=()=>{if(h.width/h.height!==1||h.height/h.width!==1){r("Image must have a 1:1 ratio."),a(!0);return}const V={firstName:b,lastName:v,phone:j,role:y,email:w,password:g,imageFile:c},F=JSON.parse(localStorage.getItem("employees")||"[]");F.push(V),localStorage.setItem("employees",JSON.stringify(F)),window.dispatchEvent(new Event("employeeAdded")),console.log({firstName:b,lastName:v,phone:j,role:y,email:w,password:g,imageFile:c}),a(!0),A()},h.onerror=()=>{r("Invalid image file."),a(!0)};const K=URL.createObjectURL(c);h.src=K};return e.jsx(i,{sx:{p:x?2:3,backgroundColor:o.palette.grey[100],minHeight:"100vh",width:"100%"},children:e.jsxs(i,{sx:{maxWidth:"lg",margin:"auto",backgroundColor:"white",borderRadius:o.shape.borderRadius,boxShadow:o.shadows[1],p:x?2:3},children:[e.jsx(i,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3},children:e.jsxs(i,{sx:{display:"flex",alignItems:"center"},children:[e.jsx("img",{src:"https://via.placeholder.com/24",alt:"User Icon",style:{marginRight:8}}),e.jsx(d,{variant:"h5",component:"h1",children:"Add New Employee"})]})}),e.jsx(d,{variant:"subtitle1",color:"text.secondary",sx:{mb:4},children:"Insert the basic information of the employee"}),e.jsxs(i,{component:"form",onSubmit:Q,children:[e.jsxs(i,{sx:{display:"flex",flexDirection:x?"column":"row",gap:3,mb:4},children:[e.jsx(I,{sx:{flex:x?"auto":2,p:2,boxShadow:"none",border:`1px solid ${o.palette.grey[200]}`},children:e.jsxs(C,{sx:{"&:last-child":{pb:2}},children:[e.jsx(d,{variant:"h6",gutterBottom:!0,children:"General Information"}),e.jsx(d,{variant:"body2",color:"text.secondary",sx:{mb:2},children:"Insert the basic information of the employee"}),e.jsxs(N,{spacing:2,children:[e.jsx(m,{fullWidth:!0,label:"First Name",variant:"outlined",value:b,onChange:t=>R(t.target.value),placeholder:"Ex: Sakeef Ameer",required:!0}),e.jsx(m,{fullWidth:!0,label:"Last Name",variant:"outlined",value:v,onChange:t=>E(t.target.value),placeholder:"Ex: Prodhan",required:!0}),e.jsx(m,{fullWidth:!0,label:"Phone",variant:"outlined",value:j,onChange:t=>z(t.target.value),placeholder:"+1",required:!0,InputProps:{startAdornment:e.jsx(O,{sx:{mr:1},children:"ðŸ‡ºðŸ‡¸ +1"})}}),e.jsxs(_,{fullWidth:!0,variant:"outlined",required:!0,children:[e.jsx(O,{id:"role-label",children:"Role"}),e.jsxs(ee,{labelId:"role-label",id:"role-select",value:y,label:"Role",onChange:t=>B(t.target.value),children:[e.jsx(q,{value:"",children:"Select Role"}),T.map((t,s)=>e.jsx(q,{value:t,children:t},s))]})]})]})]})}),e.jsx(I,{sx:{flex:x?"auto":1,p:2,boxShadow:"none",border:`1px solid ${o.palette.grey[200]}`},children:e.jsxs(C,{sx:{"&:last-child":{pb:2}},children:[e.jsx(d,{variant:"h6",gutterBottom:!0,children:"Image"}),e.jsx(d,{variant:"body2",color:"text.secondary",sx:{mb:2},children:"Image Ratio (1:1) Max Size (2 MB)"}),e.jsxs(ne,{onDragOver:J,onDrop:G,onClick:()=>document.getElementById("image-upload").click(),children:[c?e.jsxs(i,{children:[e.jsx("img",{src:URL.createObjectURL(c),alt:"Image preview",style:{maxWidth:"100%",maxHeight:100,objectFit:"contain",marginBottom:o.spacing(1)}}),e.jsx(d,{variant:"body2",color:"text.secondary",children:c.name})]}):e.jsxs(i,{children:[e.jsx(ae,{sx:{fontSize:40,color:o.palette.grey[400],mb:1}}),e.jsx(d,{variant:"body2",color:"#E15B65",sx:{mb:.5,fontWeight:"medium"},children:"Choose File"}),e.jsx(d,{variant:"body2",color:"text.secondary",children:"file selected."})]}),e.jsx("input",{type:"file",id:"image-upload",hidden:!0,accept:"image/jpeg,image/png,image/jpg",onChange:H})]})]})})]}),e.jsx(i,{sx:{mb:4},children:e.jsx(I,{sx:{p:2,boxShadow:"none",border:`1px solid ${o.palette.grey[200]}`},children:e.jsxs(C,{sx:{"&:last-child":{pb:2}},children:[e.jsx(d,{variant:"h6",gutterBottom:!0,children:"Account Information"}),e.jsxs(N,{spacing:2,children:[e.jsx(m,{fullWidth:!0,label:"Email",variant:"outlined",value:w,onChange:t=>L(t.target.value),placeholder:"Ex: ex@gmail.com",required:!0}),e.jsx(m,{fullWidth:!0,label:"Password",variant:"outlined",type:"password",value:g,onChange:t=>P(t.target.value),placeholder:"8+ characters required",required:!0,inputProps:{minLength:8}}),e.jsx(m,{fullWidth:!0,label:"Confirm password",variant:"outlined",type:"password",value:U,onChange:t=>k(t.target.value),placeholder:"8+ characters required",required:!0,inputProps:{minLength:8}})]})]})})}),e.jsxs(i,{sx:{mt:4,display:"flex",justifyContent:"flex-end"},children:[e.jsx(M,{variant:"outlined",color:"#E15B65",size:"large",onClick:A,sx:{color:"#E15B65"},children:"Reset"}),e.jsx(M,{variant:"contained",type:"submit",size:"large",sx:{ml:2,color:"white",bgcolor:"#E15B65"},children:"Submit"})]})]}),e.jsx(re,{open:W,autoHideDuration:3e3,onClose:D,anchorOrigin:{vertical:"top",horizontal:"center"},children:e.jsx(se,{onClose:D,severity:S?"error":"success",sx:{backgroundColor:S?"#d32f2f":"#1976d2",color:"white"},children:S||"Employee added successfully!"})})]})})};export{le as default};
