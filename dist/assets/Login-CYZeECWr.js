import{ad as Z,j as e,a6 as U,au as X,B as f,bf as z,r as a,g as Y,d as ee,F as H,I as O,O as M,Z as te,o as se,V as ne,bg as re,i as ae,G as t,t as oe,E as ie,T as l,L as b,k as ce,b as R,f as T,s as _,bh as V,n as le,a2 as de,D as ue,h as he}from"./index-DQO8S-Hd.js";const xe=Z([e.jsx("path",{d:"M17 18H7V6h7V1H7c-1.1 0-2 .9-2 2v18c0 1.1.9 2 2 2h10c1.1 0 2-.9 2-2v-5h-2z"},"0"),e.jsx("path",{d:"m18 14 5-5-1.41-1.41L19 10.17V3h-2v7.17l-2.59-2.58L13 9z"},"1")]),me=U("div")(({theme:s})=>({backgroundColor:s.palette.grey[100],minHeight:"100vh"}));function F({children:s,...o}){return e.jsx(X,{sx:{maxWidth:{xs:400,lg:475},margin:{xs:2.5,md:3},"& > *":{flexGrow:1,flexBasis:"50%"}},content:!1,...o,children:e.jsx(f,{sx:{p:{xs:2,sm:3,xl:5}},children:s})})}F.propTypes={children:z.any,other:z.any};const pe=()=>{const[s,o]=a.useState(!1),[d,j]=a.useState(null);return a.useEffect(()=>{const m=u=>{u.preventDefault(),o(!0),j(u)};return window.addEventListener("beforeinstallprompt",m),()=>window.removeEventListener("beforeinstallprompt",m)},[]),{supportsPWA:s,installPWA:()=>{d&&d.prompt()}}};function ge(){const s=Y(),o=ee(),[d,j]=a.useState(!0),[x,m]=a.useState(!1),[u,N]=a.useState(""),[y,J]=a.useState(""),[v,I]=a.useState(""),{supportsPWA:G,installPWA:$}=pe(),q=async i=>{var S,w,A,k,C,W,D,E,L,P;i.preventDefault(),I("");try{const r=await T.post("https://api.bookmyevent.ae/api/auth/login",{email:u,password:y}),{token:p,user:c,profile:h}=r.data;d?localStorage.setItem("token",p):sessionStorage.setItem("token",p),localStorage.setItem("user",JSON.stringify(c));let g=null;if((S=h==null?void 0:h.module)!=null&&S._id&&(g=h.module._id,localStorage.setItem("moduleId",g),localStorage.setItem("logRes",h.module.title)),c!=null&&c._id&&g)try{const n=(w=(await T.get(`https://api.bookmyevent.ae/api/subscription/status/${c._id}?moduleId=${g}`)).data)==null?void 0:w.subscription;if((n==null?void 0:n.status)==="active"&&(n!=null&&n.isCurrent)){const K=new Date(n.endDate),Q=Math.max(0,Math.ceil((K-new Date)/(1e3*60*60*24)));localStorage.setItem("upgrade",JSON.stringify({isSubscribed:!0,status:"active",plan:n.planId,module:n.moduleId,access:{canAccess:!0,isExpired:!1,daysLeft:Q}}))}else localStorage.setItem("upgrade",JSON.stringify({isSubscribed:!1,status:"free",access:{canAccess:!1}}))}catch(B){console.error("Subscription fetch failed:",B),localStorage.setItem("upgrade",JSON.stringify({isSubscribed:!1,status:"free",access:{canAccess:!1}}))}window.location.href="/dashboard/default"}catch(r){if(((k=(A=r.response)==null?void 0:A.data)==null?void 0:k.status)==="pending"||((W=(C=r.response)==null?void 0:C.data)==null?void 0:W.status)==="rejected"){const p=r.response.data.status,c=r.response.data.message;o("/pages/register",{state:{status:p,rejectReason:c}});return}I(((E=(D=r.response)==null?void 0:D.data)==null?void 0:E.message)||((P=(L=r.response)==null?void 0:L.data)==null?void 0:P.error)||"Invalid email or password")}};return e.jsxs("form",{onSubmit:q,children:[e.jsxs(H,{fullWidth:!0,sx:{...s.typography.customInput,mb:2},children:[e.jsx(O,{children:"Email Address"}),e.jsx(M,{type:"email",value:u,onChange:i=>N(i.target.value),required:!0})]}),e.jsxs(H,{fullWidth:!0,sx:{...s.typography.customInput,mb:2},children:[e.jsx(O,{children:"Password"}),e.jsx(M,{type:x?"text":"password",value:y,onChange:i=>J(i.target.value),endAdornment:e.jsx(te,{position:"end",children:e.jsx(se,{onClick:()=>m(!x),edge:"end",children:x?e.jsx(ne,{}):e.jsx(re,{})})}),required:!0})]}),v&&e.jsx(ae,{error:!0,children:v}),e.jsxs(t,{container:!0,justifyContent:"space-between",alignItems:"center",children:[e.jsx(oe,{control:e.jsx(ie,{checked:d,onChange:i=>j(i.target.checked)}),label:"Keep me logged in"}),e.jsx(l,{component:b,to:"/forgot-password",color:"#E15B65",sx:{textDecoration:"none"},children:"Forgot Password?"})]}),e.jsx(f,{sx:{mt:2},children:e.jsx(ce,{children:e.jsx(R,{fullWidth:!0,size:"large",type:"submit",variant:"contained",sx:{bgcolor:"#E15B65"},children:"Sign In"})})}),G&&e.jsx(f,{sx:{mt:2},children:e.jsx(R,{fullWidth:!0,size:"large",variant:"outlined",onClick:$,startIcon:e.jsx(xe,{}),sx:{color:s.palette.primary.main,borderColor:s.palette.primary.main},children:"Install App"})})]})}function je(){return e.jsxs(_,{direction:"row",sx:{justifyContent:"space-between"},children:[e.jsx(l,{variant:"subtitle2",component:V,href:"https://berrydashboard.com",target:"_blank",underline:"hover",children:"berrydashboard.com"}),e.jsx(l,{variant:"subtitle2",component:V,href:"https://codedthemes.com",target:"_blank",underline:"hover",children:"Â© codedthemes.com"})]})}function fe(){return e.jsx(b,{to:ue,"aria-label":"theme-logo",children:e.jsx("img",{src:he,alt:"Book Logo",style:{width:160,height:50}})})}function ve(){const s=le(o=>o.breakpoints.down("md"));return e.jsx(me,{children:e.jsxs(t,{container:!0,direction:"column",sx:{justifyContent:"flex-end",minHeight:"100vh"},children:[e.jsx(t,{size:12,children:e.jsx(t,{container:!0,sx:{justifyContent:"center",alignItems:"center",minHeight:"calc(100vh - 68px)"},children:e.jsx(t,{sx:{m:{xs:1,sm:3},mb:0},children:e.jsx(F,{children:e.jsxs(t,{container:!0,spacing:2,sx:{alignItems:"center",justifyContent:"center"},children:[e.jsx(t,{sx:{mb:3},children:e.jsx(fe,{})}),e.jsx(t,{size:12,children:e.jsx(t,{container:!0,direction:{xs:"column-reverse",md:"row"},sx:{alignItems:"center",justifyContent:"center"},children:e.jsx(t,{children:e.jsxs(_,{spacing:1,sx:{alignItems:"center",justifyContent:"center"},children:[e.jsx(l,{gutterBottom:!0,variant:s?"h3":"h2",sx:{color:"#E15B65"},children:"Hi, Welcome Back"}),e.jsx(l,{variant:"caption",sx:{fontSize:"16px",textAlign:{xs:"center",md:"inherit"}},children:"Enter your credentials to continue"})]})})})}),e.jsx(t,{size:12,children:e.jsx(ge,{})}),e.jsx(t,{size:12,children:e.jsx(de,{})}),e.jsx(t,{size:12,children:e.jsx(t,{container:!0,direction:"column",sx:{alignItems:"center"},size:12,children:e.jsxs(l,{variant:"body2",sx:{color:"text.secondary"},children:["Don't have an account?"," ",e.jsx(l,{component:b,to:"/pages/register",variant:"body2",sx:{color:"#E15B65",fontWeight:700,textDecoration:"none","&:hover":{textDecoration:"underline"}},children:"Register as Vendor"})]})})})]})})})})}),e.jsx(t,{sx:{px:3,my:3},size:12,children:e.jsx(je,{})})]})})}export{ve as default};
