import{p as Ie,d as Te,r,j as e,B as o,c as ue,s as w,t as Ee,T as f,H as pe,k as U,a as g,S as L,F as ge,I as he,o as xe,M as k,x as Me,a1 as Be,w as C,z as De,b as me,h as P}from"./index-s_d37VNW.js";import{A as We}from"./Add-NtZk6aY8.js";import{S as O}from"./Switch-Bs5zn8IW.js";import{C as fe}from"./Close-CUJ19K32.js";import{C as Fe}from"./CloudUpload-BAFwnm-c.js";import{D as _e}from"./Delete-B95eIUHs.js";const x="#E91E63",j="https://api.bookmyevent.ae",$e="68e5fc09651cc12c1fc0f9c9",ze=["HD Makeup","Airbrush Makeup","Matte Makeup","Dewy/Glass Makeup","Mineral Makeup","Traditional"],Ne=({section:p,onChange:b,onDelete:h})=>e.jsxs(o,{sx:{position:"relative",border:"1px solid #e5e5e5",borderRadius:2,p:3,mb:3,bgcolor:"white"},children:[e.jsx(w,{onClick:h,sx:{position:"absolute",top:12,right:12,color:x},children:e.jsx(_e,{fontSize:"small"})}),e.jsx(g,{fullWidth:!0,label:e.jsxs("span",{children:["Section Title ",e.jsx("span",{style:{color:"red"},children:"*"})]}),value:p.title||"",onChange:m=>b("title",m.target.value),sx:{mb:2}}),e.jsx(g,{fullWidth:!0,label:e.jsxs("span",{children:["Items (comma separated) ",e.jsx("span",{style:{color:"red"},children:"*"})]}),placeholder:"e.g. Bridal Bun, Curls, Waves",value:Array.isArray(p.items)?p.items.join(", "):"",onChange:m=>b("items",m.target.value),multiline:!0,rows:2,helperText:" Separate items with commas"})]}),Ve=()=>{const{id:p}=Ie(),b=Te(),h=!!p,[m,R]=r.useState(!0),[G,H]=r.useState(!1),[V,A]=r.useState(""),[q,c]=r.useState(""),[I,je]=r.useState([]),[be,J]=r.useState(!0),[T,K]=r.useState(""),[E,Y]=r.useState([]),[M,Q]=r.useState(""),[B,X]=r.useState(""),[Z,ee]=r.useState(""),[D,te]=r.useState(""),[ae,se]=r.useState(""),[ie,re]=r.useState(""),[W,le]=r.useState(!1),[F,ne]=r.useState(!1),[_,oe]=r.useState(!0),[$,v]=r.useState([{id:Date.now(),title:"",items:[]}]),[y,ve]=r.useState({hairStyling:!1,sareeDraping:!1,eyelashExtension:!1,nailPolish:!1}),[S,ce]=r.useState([]),[z,de]=r.useState([]);r.useEffect(()=>{(async()=>{try{J(!0);const a=await P.get(`${j}/api/categories/modules/${$e}`);a.data.success&&Array.isArray(a.data.data)?je(a.data.data):c("No makeup categories found")}catch(a){console.error("Error fetching makeup categories:",a),c("Failed to load categories. Please refresh.")}finally{J(!1)}})()},[]),r.useEffect(()=>{if(!h){R(!1);return}(async()=>{var a,s,l,d,i;try{const n=(await P.get(`${j}/api/makeup-packages/${p}`)).data.data;K(n.packageTitle||""),Y(((a=n.categories)==null?void 0:a.map(u=>u._id||u))||[]),Q(n.makeupType||""),X(((s=n.basePrice)==null?void 0:s.toString())||""),ee(((l=n.offerPrice)==null?void 0:l.toString())||"0"),te(n.description||""),se(n.cancellationPolicy||""),re(n.advanceBookingAmount||""),le(n.trialMakeupIncluded||!1),ne(n.travelToVenue||!1),oe(n.isActive??!0),((d=n.includedServices)==null?void 0:d.length)>0&&v(n.includedServices.map(u=>({id:u._id||Date.now(),title:u.title||"",items:Array.isArray(u.items)?u.items:[]}))),((i=n.gallery)==null?void 0:i.length)>0&&de(n.gallery.map(u=>`${j}${u}`))}catch{c("Failed to load package.")}finally{R(!1)}})()},[p,h]);const ye=()=>{v(t=>[...t,{id:Date.now(),title:"",items:[]}])},Se=(t,a,s)=>{v(l=>l.map(d=>{if(d.id===t){if(a==="items"){const i=s.split(",").map(N=>N.trim()).filter(Boolean);return{...d,items:i}}return{...d,[a]:s}}return d}))},ke=t=>{$.length>1&&v(a=>a.filter(s=>s.id!==t))},Ce=t=>{const a=Array.from(t.target.files);if(S.length+z.length+a.length>5){alert("Maximum 5 images allowed");return}ce(l=>[...l,...a])},Pe=t=>ce(a=>a.filter((s,l)=>l!==t)),we=t=>de(a=>a.filter((s,l)=>l!==t)),Ae=async()=>{var l,d;if(!T.trim())return c("Package title is required");if(E.length===0)return c("Select at least one category");if(!M)return c("Select makeup type");if(!B)return c("Base price is required");if(!D.trim())return c("Description is required");H(!0),c(""),A("");const t=new FormData;t.append("packageTitle",T.trim()),E.forEach(i=>t.append("categories",i)),t.append("makeupType",M),t.append("description",D.trim()),t.append("basePrice",B),t.append("offerPrice",Z||"0"),t.append("cancellationPolicy",ae),t.append("advanceBookingAmount",ie),t.append("trialMakeupIncluded",W),t.append("travelToVenue",F),t.append("isActive",_),t.append("providerId","68e77be26a1614cf448a34d7");const a=$.filter(i=>i.title.trim()&&i.items.length>0).map(i=>({title:i.title.trim(),items:i.items}));t.append("includedServices",JSON.stringify(a));const s=Object.keys(y).filter(i=>y[i]).map(i=>({hairStyling:"Hair Styling",sareeDraping:"Saree Draping",eyelashExtension:"Eyelash Extension",nailPolish:"Nail Polish"})[i]);if(s.length>0){let i=JSON.parse(t.get("includedServices")||"[]");i.push({title:"Basic Add-ons",items:s}),t.set("includedServices",JSON.stringify(i))}S.forEach(i=>t.append("gallery",i));try{h?(await P.put(`${j}/api/makeup-packages/${p}`,t),A("Package updated successfully!")):(await P.post(`${j}/api/makeup-packages`,t),A("Package created successfully!"))}catch(i){c(((d=(l=i.response)==null?void 0:l.data)==null?void 0:d.message)||"Failed to save package")}finally{H(!1),window.scrollTo({top:0,behavior:"smooth"})}};return m||be?e.jsx(o,{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"80vh",children:e.jsx(ue,{size:60})}):e.jsxs(o,{sx:{bgcolor:"#f9f9fc",minHeight:"100vh"},children:[e.jsx(o,{sx:{bgcolor:"white",borderBottom:"1px solid #eee",p:2,px:4,position:"sticky",top:0,zIndex:10},children:e.jsxs(o,{sx:{display:"flex",alignItems:"center",gap:2},children:[e.jsx(w,{onClick:()=>b(-1),children:e.jsx(Ee,{})}),e.jsxs(f,{variant:"h5",fontWeight:"bold",children:[h?"Edit":"Add"," Makeup Package"]})]})}),e.jsxs(o,{sx:{p:{xs:2,md:4}},children:[V&&e.jsx(pe,{severity:"success",sx:{mb:3},children:V}),q&&e.jsx(pe,{severity:"error",sx:{mb:3},children:q}),e.jsxs(U,{elevation:3,sx:{borderRadius:3,p:{xs:3,md:6}},children:[e.jsx(g,{fullWidth:!0,label:"Package Title *",value:T,onChange:t=>K(t.target.value),sx:{mb:3}}),e.jsxs(L,{direction:{xs:"column",md:"row"},spacing:3,sx:{mb:3},children:[e.jsxs(ge,{fullWidth:!0,children:[e.jsx(he,{children:"Category *"}),e.jsx(xe,{multiple:!0,value:E,onChange:t=>Y(t.target.value),renderValue:t=>e.jsx(o,{sx:{display:"flex",flexWrap:"wrap",gap:.5},children:t.map(a=>{const s=I.find(l=>l._id===a);return e.jsx(Me,{label:(s==null?void 0:s.title)||"Unknown",size:"small"},a)})}),children:I.length===0?e.jsx(k,{disabled:!0,children:"No categories available"}):I.map(t=>e.jsx(k,{value:t._id,children:t.title},t._id))})]}),e.jsxs(ge,{fullWidth:!0,children:[e.jsx(he,{children:"Makeup Type *"}),e.jsxs(xe,{value:M,onChange:t=>Q(t.target.value),children:[e.jsx(k,{value:"",disabled:!0,children:"Select Type"}),ze.map(t=>e.jsx(k,{value:t,children:t},t))]})]})]}),e.jsxs(L,{direction:{xs:"column",md:"row"},spacing:3,sx:{mb:3},children:[e.jsx(g,{fullWidth:!0,label:"Base Price *",type:"number",value:B,onChange:t=>X(t.target.value)}),e.jsx(g,{fullWidth:!0,label:"Offer Price",type:"number",value:Z,onChange:t=>ee(t.target.value),helperText:"Leave empty if no discount"}),e.jsx(g,{fullWidth:!0,label:"Advance Booking Amount",value:ie,onChange:t=>re(t.target.value)})]}),e.jsx(g,{fullWidth:!0,label:"Description *",multiline:!0,rows:4,value:D,onChange:t=>te(t.target.value),sx:{mb:4}}),e.jsx(f,{variant:"h6",sx:{mb:2,color:x},children:"Basic Add-ons"}),e.jsx(U,{variant:"outlined",sx:{p:3,mb:4,bgcolor:"#fafafa"},children:e.jsx(Be,{row:!0,children:Object.keys(y).map(t=>e.jsx(C,{control:e.jsx(De,{checked:y[t],onChange:a=>ve(s=>({...s,[t]:a.target.checked}))}),label:t==="hairStyling"?"Hair Styling":t==="sareeDraping"?"Saree Draping":t==="eyelashExtension"?"Eyelash Extension":"Nail Polish"},t))})}),e.jsxs(o,{sx:{mb:4},children:[e.jsxs(o,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3},children:[e.jsx(f,{variant:"h6",sx:{color:x},children:"Custom Service Sections"}),e.jsx(me,{variant:"contained",startIcon:e.jsx(We,{}),sx:{bgcolor:x},onClick:ye,children:"Add Section"})]}),$.map(t=>e.jsx(Ne,{section:t,onChange:(a,s)=>Se(t.id,a,s),onDelete:()=>ke(t.id)},t.id))]}),e.jsx(g,{fullWidth:!0,label:"Cancellation Policy",multiline:!0,rows:3,value:ae,onChange:t=>se(t.target.value),sx:{mb:4}}),e.jsxs(L,{direction:"row",spacing:4,sx:{mb:4},children:[e.jsx(C,{control:e.jsx(O,{checked:W,onChange:()=>le(!W)}),label:"Trial Makeup Included"}),e.jsx(C,{control:e.jsx(O,{checked:F,onChange:()=>ne(!F)}),label:"Travel to Venue"}),e.jsx(C,{control:e.jsx(O,{checked:_,onChange:()=>oe(!_)}),label:"Package Active"})]}),e.jsx(f,{variant:"h6",sx:{color:x,mb:2},children:"Gallery (Max 5)"}),e.jsxs(U,{onClick:()=>document.getElementById("gallery-input").click(),sx:{border:"2px dashed #ddd",borderRadius:2,p:4,textAlign:"center",cursor:"pointer",mb:4},children:[e.jsx("input",{id:"gallery-input",type:"file",hidden:!0,multiple:!0,accept:"image/*",onChange:Ce}),S.length>0||z.length>0?e.jsxs(o,{sx:{display:"flex",flexWrap:"wrap",gap:2},children:[z.map((t,a)=>e.jsxs(o,{sx:{position:"relative"},children:[e.jsx("img",{src:t,alt:"",style:{width:120,height:120,objectFit:"cover",borderRadius:8}}),e.jsx(w,{onClick:s=>{s.stopPropagation(),we(a)},sx:{position:"absolute",top:-8,right:-8,bgcolor:"white"},children:e.jsx(fe,{fontSize:"small"})})]},`ex-${a}`)),S.map((t,a)=>e.jsxs(o,{sx:{position:"relative"},children:[e.jsx("img",{src:URL.createObjectURL(t),alt:"",style:{width:120,height:120,objectFit:"cover",borderRadius:8}}),e.jsx(w,{onClick:s=>{s.stopPropagation(),Pe(a)},sx:{position:"absolute",top:-8,right:-8,bgcolor:"white"},children:e.jsx(fe,{fontSize:"small"})})]},`new-${a}`))]}):e.jsxs(e.Fragment,{children:[e.jsx(Fe,{sx:{fontSize:60,color:"#ccc"}}),e.jsx(f,{sx:{mt:2,color:x,fontWeight:"bold"},children:"Click to Upload Images"})]})]}),e.jsx(me,{fullWidth:!0,variant:"contained",size:"large",onClick:Ae,disabled:G,sx:{py:2,bgcolor:x,"&:hover":{bgcolor:"#c2185b"}},children:G?e.jsx(ue,{size:28,color:"inherit"}):h?"Update Package":"Create Package"})]})]})]})};export{Ve as default};
