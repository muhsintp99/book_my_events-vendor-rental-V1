import{l as z,d as L,r as o,j as e,aF as M,aG as O,aH as U,B as c,Y as q,aI as G,s as g,A as J,T as B,c as F,a as l,Z as j,b as v,y as Y,o as Z,N as _,e as K}from"./index-CWJg_lwt.js";import{A as Q,R as V}from"./RotateLeft-nZlTPbGJ.js";import{C as X}from"./Close-D09zOr9j.js";const ee=O({palette:{primary:{main:"#C62828",dark:"#8E0000",light:"#FFCDD2",contrastText:"#fff"},secondary:{main:"#B71C1C"},background:{default:"#f8fafc",paper:"#fff"},text:{primary:"#0f172a",secondary:"#475569"}},typography:{fontFamily:"'DM Sans', sans-serif",h4:{fontFamily:"'Playfair Display', serif"}},shape:{borderRadius:14},components:{MuiCssBaseline:{styleOverrides:"@import url('https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,700;1,500&family=DM+Sans:wght@300;400;500;600&display=swap');"},MuiOutlinedInput:{styleOverrides:{root:{borderRadius:12,backgroundColor:"#FFF8F8",fontFamily:"'DM Sans', sans-serif",fontSize:"14.5px","& fieldset":{borderColor:"rgba(198,40,40,0.2)"},"&:hover fieldset":{borderColor:"rgba(198,40,40,0.5) !important"},"&.Mui-focused fieldset":{borderColor:"#C62828 !important",borderWidth:2},transition:"box-shadow .3s","&.Mui-focused":{boxShadow:"0 0 0 4px rgba(198,40,40,0.10)"}}}}}}),m="https://api.bookmyevent.ae";function oe(){const{id:d}=z(),N=L(),s=!!d,h=JSON.parse(localStorage.getItem("user")||"{}"),R=h==null?void 0:h._id,W=localStorage.getItem("moduleId"),C=localStorage.getItem("token"),[t,f]=o.useState({packageName:"",description:"",packagePrice:"",advanceBookingAmount:"",additionalHourPrice:""}),[A,x]=o.useState(null),[S,p]=o.useState(null),[k,I]=o.useState(!1),[D,w]=o.useState(!1),[n,b]=o.useState({}),[u,y]=o.useState({open:!1,message:"",severity:"success"});o.useEffect(()=>{s&&(w(!0),fetch(`${m}/api/panthal/${d}`,{headers:{Authorization:`Bearer ${C}`}}).then(a=>a.json()).then(a=>{const r=a.data||a;f({packageName:r.packageName||"",description:r.description||"",packagePrice:r.packagePrice||"",advanceBookingAmount:r.advanceBookingAmount||"",additionalHourPrice:r.additionalHourPrice||""}),r.image&&p(`${m}/${r.image}`)}).catch(console.error).finally(()=>w(!1)))},[d]);const i=a=>{f({...t,[a.target.name]:a.target.value}),b({...n,[a.target.name]:""})},H=a=>{var P;const r=(P=a.target.files)==null?void 0:P[0];r&&(x(r),p(URL.createObjectURL(r)))},T=()=>{const a={};return t.packageName.trim()||(a.packageName="Package name required"),t.packagePrice||(a.packagePrice="Price required"),b(a),!Object.keys(a).length},E=async()=>{if(T()){I(!0);try{const a=new FormData;a.append("packageName",t.packageName),a.append("description",t.description),a.append("packagePrice",t.packagePrice),a.append("advanceBookingAmount",t.advanceBookingAmount),a.append("additionalHourPrice",t.additionalHourPrice),a.append("providerId",R),a.append("module",W),A&&a.append("image",A);const r=s?`${m}/api/panthal/${d}`:`${m}/api/panthal`;await fetch(r,{method:s?"PUT":"POST",headers:{Authorization:`Bearer ${C}`},body:a}),y({open:!0,message:s?"Package updated!":"Package created!",severity:"success"}),setTimeout(()=>N("/panthal/packagelist"),1200)}catch{y({open:!0,message:"Failed to save package",severity:"error"})}finally{I(!1)}}},$=()=>{f({packageName:"",description:"",packagePrice:"",advanceBookingAmount:"",additionalHourPrice:""}),x(null),p(null),b({})};return e.jsxs(M,{theme:ee,children:[e.jsx(U,{}),e.jsxs(c,{sx:{maxWidth:800,mx:"auto",p:3},children:[e.jsxs(q,{sx:{p:4,borderRadius:4,boxShadow:"0 8px 32px rgba(0,0,0,0.08)"},children:[k&&e.jsx(G,{sx:{mb:2,borderRadius:2}}),e.jsxs(g,{direction:"row",alignItems:"center",spacing:2,sx:{mb:4},children:[e.jsx(J,{sx:{bgcolor:"#C62828",width:56,height:56},children:e.jsx(Q,{})}),e.jsxs(c,{children:[e.jsx(B,{variant:"h4",fontWeight:700,color:"primary",children:s?"Edit Panthal Package":"Create Panthal Package"}),e.jsx(B,{variant:"body2",color:"text.secondary",children:s?"Update your panthal & decoration package details":"Add a new panthal & decoration package for your clients"})]})]}),D?e.jsx(c,{sx:{display:"flex",justifyContent:"center",py:6},children:e.jsx(F,{sx:{color:"#C62828"}})}):e.jsxs(g,{spacing:3,children:[e.jsx(l,{fullWidth:!0,label:"Package Name",name:"packageName",placeholder:"Enter panthal & decoration package name",value:t.packageName,onChange:i,error:!!n.packageName,helperText:n.packageName}),e.jsx(l,{fullWidth:!0,multiline:!0,rows:4,label:"Description",name:"description",placeholder:"Describe your panthal & decoration services, setup types, etc.",value:t.description,onChange:i}),e.jsxs(g,{direction:{xs:"column",sm:"row"},spacing:2,children:[e.jsx(l,{fullWidth:!0,label:"Package Price",name:"packagePrice",type:"number",value:t.packagePrice,onChange:i,InputProps:{startAdornment:e.jsx(j,{position:"start",children:"₹"})},error:!!n.packagePrice,helperText:n.packagePrice}),e.jsx(l,{fullWidth:!0,label:"Advance Amount",name:"advanceBookingAmount",type:"number",value:t.advanceBookingAmount,onChange:i,InputProps:{startAdornment:e.jsx(j,{position:"start",children:"₹"})}})]}),e.jsx(l,{fullWidth:!0,label:"Additional Hour Price",name:"additionalHourPrice",type:"number",value:t.additionalHourPrice,onChange:i,InputProps:{startAdornment:e.jsx(j,{position:"start",children:"₹"})}}),e.jsxs(c,{children:[e.jsxs(v,{component:"label",variant:"outlined",startIcon:e.jsx(Y,{}),sx:{borderColor:"#C62828",color:"#C62828","&:hover":{borderColor:"#8E0000",bgcolor:"rgba(198,40,40,0.04)"}},children:["Upload Package Image",e.jsx("input",{hidden:!0,type:"file",accept:"image/*",onChange:H})]}),S&&e.jsxs(c,{sx:{mt:2,position:"relative",display:"inline-block"},children:[e.jsx("img",{src:S,alt:"preview",style:{width:200,height:140,borderRadius:12,objectFit:"cover"}}),e.jsx(Z,{size:"small",onClick:()=>{x(null),p(null)},sx:{position:"absolute",top:-8,right:-8,bgcolor:"#ef5350",color:"#fff","&:hover":{bgcolor:"#c62828"}},children:e.jsx(X,{fontSize:"small"})})]})]}),e.jsxs(g,{direction:"row",spacing:2,children:[e.jsx(v,{fullWidth:!0,variant:"contained",onClick:E,disabled:k,sx:{py:1.5,fontWeight:700,fontSize:"1rem"},children:k?e.jsx(F,{size:24,sx:{color:"#fff"}}):s?"Update Package":"Create Package"}),e.jsx(v,{fullWidth:!0,variant:"outlined",onClick:$,startIcon:e.jsx(V,{}),sx:{py:1.5,fontWeight:700},children:"Reset"})]})]})]}),e.jsx(_,{open:u.open,autoHideDuration:3e3,onClose:()=>y({...u,open:!1}),children:e.jsx(K,{severity:u.severity,children:u.message})})]})]})}export{oe as default};
