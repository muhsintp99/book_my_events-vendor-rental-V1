import{u as $,r as n,j as e,B as a,am as B,T as w,t as U,b as P,h as _,Q as D,U as I,v as H}from"./index-CYOhujfk.js";import{A as M}from"./ArrowDropDown-B87ifF2O.js";import{S as O}from"./Search-Cy2wkmMw.js";import{T as F,a as S,b as r,c as N}from"./TableRow-76LlmTPY.js";import{T as z}from"./TableHead-D9aopKCL.js";const h="#673ab7",J=()=>{$();const[c,E]=n.useState(""),[x,T]=n.useState([]),[g,u]=n.useState([]),[m,f]=n.useState(null),[A,L]=n.useState(!0),[j,p]=n.useState(null),d=localStorage.getItem("moduleId"),b="https://api.bookmyevent.ae";n.useEffect(()=>{(async()=>{try{if(!d)throw new Error("Module ID not found in localStorage");const o=await fetch(`${b}/api/categories/modules/${d}`);if(!o.ok)throw new Error(`HTTP error! ${o.status}`);const i=await o.json();if(i.success&&Array.isArray(i.data)){const l=i.data.map(t=>({id:t.categoryId||t._id,name:t.title,image:t.image?`${b}${t.image}`:"",status:t.isActive}));T(l),u(l)}else f("No categories found for this module")}catch(o){console.error(o),f(o.message)}finally{L(!1)}})()},[d]),n.useEffect(()=>{const s=x.filter(o=>o.name.toLowerCase().includes(c.toLowerCase()));u(s)},[c,x]);const R=s=>p(s.currentTarget),C=()=>p(null),y=s=>{let o=`SI,Category Id,Category Name
`;g.forEach((v,k)=>{o+=`${k+1},${v.id},${v.name}
`});const i=new Blob([o],{type:s==="excel"?"application/vnd.ms-excel":"text/csv"}),l=window.URL.createObjectURL(i),t=document.createElement("a");t.href=l,t.download=`light_categories.${s}`,t.click(),window.URL.revokeObjectURL(l),C()};return e.jsx(a,{sx:{p:4,bgcolor:"#f8f9fc",minHeight:"100vh"},children:e.jsxs(B,{elevation:3,sx:{p:4,borderRadius:4},children:[e.jsxs(a,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:4},children:[e.jsx(w,{variant:"h4",sx:{fontWeight:700,color:h},children:"Light & Sound Category List"}),e.jsxs(a,{sx:{display:"flex",gap:2},children:[e.jsx(U,{size:"small",placeholder:"Search categories...",value:c,onChange:s=>E(s.target.value),InputProps:{startAdornment:e.jsx(P,{position:"start",children:e.jsx(O,{})})}}),e.jsx(_,{variant:"contained",endIcon:e.jsx(M,{}),onClick:R,sx:{bgcolor:h,"&:hover":{bgcolor:"#5e35b1"}},children:"Export"}),e.jsxs(D,{anchorEl:j,open:!!j,onClose:C,children:[e.jsx(I,{onClick:()=>y("excel"),children:"Excel"}),e.jsx(I,{onClick:()=>y("csv"),children:"CSV"})]})]})]}),A?e.jsx(a,{sx:{textAlign:"center",py:5},children:e.jsx(H,{sx:{color:h}})}):m?e.jsx(w,{color:"error",children:m}):e.jsxs(F,{children:[e.jsx(z,{children:e.jsxs(S,{sx:{bgcolor:"#f3e5f5"},children:[e.jsx(r,{children:"SI"}),e.jsx(r,{children:"Image"}),e.jsx(r,{children:"Category Name"}),e.jsx(r,{children:"Category ID"}),e.jsx(r,{children:"Status"})]})}),e.jsx(N,{children:g.map((s,o)=>e.jsxs(S,{hover:!0,sx:{"&:hover":{bgcolor:"#f3e5f5"}},children:[e.jsx(r,{children:o+1}),e.jsx(r,{children:e.jsx(a,{component:"img",src:s.image,alt:s.name,sx:{width:80,height:60,objectFit:"cover",borderRadius:2}})}),e.jsx(r,{sx:{fontWeight:600},children:s.name}),e.jsx(r,{children:s.id}),e.jsx(r,{children:e.jsx(a,{sx:{px:2,py:.5,borderRadius:3,display:"inline-block",fontSize:12,bgcolor:s.status?"#e6f4ea":"#fdecea",color:s.status?"#2e7d32":"#d32f2f"},children:s.status?"Active":"Inactive"})})]},s.id))})]})]})})};export{J as default};
