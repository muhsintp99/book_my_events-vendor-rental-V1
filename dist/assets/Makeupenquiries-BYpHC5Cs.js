import{a as I,r,j as e,B as T,T as x,a5 as z,a6 as D,S as C,s as L,aa as k,Q as n,t as B,af as N,aW as j,c as m,V as P,h as A}from"./index-x5H_2qPX.js";import{D as R}from"./Delete-CTFiTwlz.js";import{C as V}from"./Chat-Dn1kOKCm.js";import{T as W}from"./TableContainer-K-BBPnZD.js";import{T as F,a as M,b as c,c as t,d as O}from"./TableRow-C0XNH_e4.js";const $=()=>{const q=I(),[i,y]=r.useState(""),[o,E]=r.useState("all"),[b,p]=r.useState([]),[d,f]=r.useState(!0),[g,u]=r.useState(null),[h,w]=r.useState(null);r.useEffect(()=>{const s=localStorage.getItem("user");if(s){const a=JSON.parse(s);w(a.providerId||a._id)}},[]),r.useEffect(()=>{(async()=>{if(!h){u("Provider ID not found"),f(!1);return}try{const a=await A.get(`https://api.bookmyevent.ae/api/enquiries/provider/${h}`);p(a.data.data||[]),u(null)}catch{u("Failed to fetch enquiries"),p([])}finally{f(!1)}})()},[h]);const S=b.filter(s=>{var v;const a=(s.fullName||"").toLowerCase().includes(i.toLowerCase())||(s.email||"").toLowerCase().includes(i.toLowerCase())||(s.contact||"").includes(i)||(((v=s.moduleId)==null?void 0:v.title)||"").toLowerCase().includes(i.toLowerCase()),l=o==="all"||s.status===o;return a&&l});return e.jsxs(T,{p:2,children:[e.jsx(x,{variant:"h4",gutterBottom:!0,children:"Enquiries"}),g&&e.jsx(z,{severity:"error",sx:{mb:2},children:g}),e.jsxs(D,{sx:{mt:2},children:[e.jsxs(C,{direction:{xs:"column",sm:"row"},spacing:2,p:2,children:[e.jsx(L,{label:"Search enquiries",size:"small",value:i,onChange:s=>y(s.target.value)}),e.jsxs(k,{size:"small",value:o,onChange:s=>E(s.target.value),sx:{minWidth:160},children:[e.jsx(n,{value:"all",children:"All"}),e.jsx(n,{value:"pending",children:"Pending"}),e.jsx(n,{value:"responded",children:"Responded"}),e.jsx(n,{value:"confirmed",children:"Confirmed"}),e.jsx(n,{value:"cancelled",children:"Cancelled"})]})]}),e.jsx(W,{children:e.jsxs(F,{children:[e.jsx(M,{children:e.jsxs(c,{children:[e.jsx(t,{children:"#"}),e.jsx(t,{children:"Customer"}),e.jsx(t,{children:"Module"}),e.jsx(t,{children:"Contact"}),e.jsx(t,{children:"Date"}),e.jsx(t,{children:"Status"}),e.jsx(t,{align:"center",children:"Actions"})]})}),e.jsxs(O,{children:[d&&e.jsx(c,{children:e.jsx(t,{colSpan:7,align:"center",children:e.jsx(B,{size:28})})}),!d&&S.map((s,a)=>{var l;return e.jsxs(c,{hover:!0,children:[e.jsx(t,{children:a+1}),e.jsxs(t,{children:[e.jsx(x,{fontWeight:600,children:s.fullName}),e.jsx(x,{variant:"caption",children:s.email})]}),e.jsx(t,{children:(l=s.moduleId)==null?void 0:l.title}),e.jsx(t,{children:s.contact}),e.jsx(t,{children:new Date(s.bookingDate).toLocaleDateString()}),e.jsx(t,{children:e.jsx(N,{size:"small",label:s.status,color:s.status==="pending"?"warning":s.status==="confirmed"?"success":"default"})}),e.jsx(t,{align:"center",children:e.jsxs(C,{direction:"row",spacing:1,justifyContent:"center",children:[e.jsx(j,{title:"Open Chat",children:e.jsx(m,{size:"small",color:"primary",onClick:()=>q("/makeupartist/Enqurychat",{state:s}),children:e.jsx(V,{fontSize:"small"})})}),e.jsx(j,{title:"View Enquiry",children:e.jsx(m,{size:"small",children:e.jsx(P,{fontSize:"small"})})}),e.jsx(j,{title:"Delete Enquiry",children:e.jsx(m,{size:"small",color:"error",children:e.jsx(R,{fontSize:"small"})})})]})})]},s._id)}),!d&&S.length===0&&e.jsx(c,{children:e.jsx(t,{colSpan:7,align:"center",children:"No enquiries found"})})]})]})})]})]})};export{$ as default};
