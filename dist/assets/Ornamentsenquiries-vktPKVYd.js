import{w as W,r as i,j as e,B as o,T as a,x as P,am as M,q as R,t as V,S as F,ap as p,b as h,V as O,af as G,ah as _,at as H,ai as J,G as g,n as E,K as q,p as K,au as U,av as $,aj as Q,g as T,h as X}from"./index-s0QLBFc1.js";import{C as z}from"./Chat-BLt0AxsD.js";import{C as Y}from"./Close-BAWo_bOw.js";import{E as Z}from"./Event-CY-q8oLw.js";import{C as ee}from"./Category-DMjoJfWl.js";import{A as se}from"./AccessTime-BKag1b6a.js";import{T as te}from"./TableContainer-DDgnYc8M.js";import{T as ne,a as u,b as t,c as ie}from"./TableRow-CB0N1NYI.js";import{T as le}from"./TableHead-sL7Y86j8.js";const me=()=>{var D;const C=W(),[c,k]=i.useState(""),[B,b]=i.useState([]),[j,y]=i.useState(!0),[S,m]=i.useState(null),[f,L]=i.useState(null),[A,v]=i.useState(!1),[l,I]=i.useState(null);i.useEffect(()=>{const s=localStorage.getItem("user");if(s){const n=JSON.parse(s);L(n.providerId||n._id)}},[]),i.useEffect(()=>{(async()=>{if(!f){m("Provider ID not found"),y(!1);return}try{const n=await X.get(`https://api.bookmyevent.ae/api/enquiries/provider/${f}`);b(n.data.data||[]),m(null)}catch{m("Failed to fetch enquiries"),b([])}finally{y(!1)}})()},[f]);const w=B.filter(s=>{var n;return(s.fullName||"").toLowerCase().includes(c.toLowerCase())||(s.email||"").toLowerCase().includes(c.toLowerCase())||(s.contact||"").includes(c)||(((n=s.moduleId)==null?void 0:n.title)||"").toLowerCase().includes(c.toLowerCase())}),N=s=>{I(s),v(!0)},d=()=>{v(!1),I(null)},r=({icon:s,label:n,value:x})=>e.jsxs(o,{display:"flex",alignItems:"center",gap:2,py:1.5,sx:{borderBottom:"1px solid",borderColor:"divider","&:last-child":{borderBottom:"none"}},children:[e.jsx(o,{sx:{width:40,height:40,borderRadius:"50%",bgcolor:"primary.light",color:"primary.main",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},children:s}),e.jsxs(o,{children:[e.jsx(a,{variant:"caption",color:"text.secondary",children:n}),e.jsx(a,{fontWeight:500,children:x||"N/A"})]})]});return e.jsxs(o,{p:2,children:[e.jsx(a,{variant:"h4",gutterBottom:!0,children:"Enquiries"}),S&&e.jsx(P,{severity:"error",sx:{mb:2},children:S}),e.jsxs(M,{sx:{mt:2},children:[e.jsx(o,{p:2,children:e.jsx(R,{label:"Search enquiries",size:"small",value:c,onChange:s=>k(s.target.value),fullWidth:!0})}),e.jsx(te,{children:e.jsxs(ne,{children:[e.jsx(le,{children:e.jsxs(u,{children:[e.jsx(t,{children:"#"}),e.jsx(t,{children:"Customer"}),e.jsx(t,{children:"Module"}),e.jsx(t,{children:"Contact"}),e.jsx(t,{children:"Date"}),e.jsx(t,{align:"center",children:"Actions"})]})}),e.jsxs(ie,{children:[j&&e.jsx(u,{children:e.jsx(t,{colSpan:6,align:"center",children:e.jsx(V,{size:28})})}),!j&&w.map((s,n)=>{var x;return e.jsxs(u,{hover:!0,children:[e.jsx(t,{children:n+1}),e.jsxs(t,{children:[e.jsx(a,{fontWeight:600,children:s.fullName}),e.jsx(a,{variant:"caption",color:"text.secondary",children:s.email})]}),e.jsx(t,{children:(x=s.moduleId)==null?void 0:x.title}),e.jsx(t,{children:s.contact}),e.jsx(t,{children:new Date(s.bookingDate).toLocaleDateString()}),e.jsx(t,{align:"center",children:e.jsxs(F,{direction:"row",spacing:1,justifyContent:"center",children:[e.jsx(p,{title:"Chat",children:e.jsx(h,{size:"small",color:"primary",onClick:()=>C("/ornaments/enquirychat",{state:s}),children:e.jsx(z,{fontSize:"small"})})}),e.jsx(p,{title:"View",children:e.jsx(h,{size:"small",color:"info",onClick:()=>N(s),children:e.jsx(O,{fontSize:"small"})})}),e.jsx(p,{title:"Delete",children:e.jsx(h,{size:"small",color:"error",children:e.jsx(G,{fontSize:"small"})})})]})})]},s._id)}),!j&&w.length===0&&e.jsx(u,{children:e.jsx(t,{colSpan:6,align:"center",children:"No enquiries found"})})]})]})})]}),e.jsxs(_,{open:A,onClose:d,maxWidth:"md",fullWidth:!0,children:[e.jsx(H,{sx:{bgcolor:"primary.main",color:"white"},children:e.jsxs(o,{display:"flex",justifyContent:"space-between",children:[e.jsx(a,{fontWeight:600,children:"Enquiry Details"}),e.jsx(h,{onClick:d,sx:{color:"white"},children:e.jsx(Y,{})})]})}),e.jsx(J,{children:l&&e.jsxs(g,{container:!0,spacing:3,mt:1,children:[e.jsx(g,{item:!0,xs:12,md:6,children:e.jsx(E,{variant:"outlined",children:e.jsxs(q,{children:[e.jsx(a,{fontWeight:600,mb:2,children:"Customer Information"}),e.jsx(r,{icon:e.jsx(K,{fontSize:"small"}),label:"Full Name",value:l.fullName}),e.jsx(r,{icon:e.jsx(U,{fontSize:"small"}),label:"Email",value:l.email}),e.jsx(r,{icon:e.jsx($,{fontSize:"small"}),label:"Contact",value:l.contact})]})})}),e.jsx(g,{item:!0,xs:12,md:6,children:e.jsx(E,{variant:"outlined",children:e.jsxs(q,{children:[e.jsx(a,{fontWeight:600,mb:2,children:"Booking Information"}),e.jsx(r,{icon:e.jsx(ee,{fontSize:"small"}),label:"Module",value:(D=l.moduleId)==null?void 0:D.title}),e.jsx(r,{icon:e.jsx(Z,{fontSize:"small"}),label:"Booking Date",value:new Date(l.bookingDate).toLocaleDateString()}),e.jsx(r,{icon:e.jsx(se,{fontSize:"small"}),label:"Created At",value:new Date(l.createdAt).toLocaleString()})]})})})]})}),e.jsxs(Q,{children:[e.jsx(T,{onClick:d,variant:"outlined",children:"Close"}),e.jsx(T,{variant:"contained",startIcon:e.jsx(z,{}),onClick:()=>{d(),C("/ornaments/enquirychat",{state:l})},children:"Open Chat"})]})]})]})};export{me as default};
