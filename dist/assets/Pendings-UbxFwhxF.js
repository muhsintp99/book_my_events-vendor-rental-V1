import{r,j as o,B as l,T as s,t as w,a6 as B,S as j,ab as E,D as _,g as m,h as g}from"./index-q2nSyL80.js";const I=()=>{const[c,a]=r.useState([]),[k,b]=r.useState(!0),[x,y]=r.useState(null),[p,v]=r.useState(null);r.useEffect(()=>{const e=localStorage.getItem("user");if(e){const t=JSON.parse(e);v(t._id||t.id||t.providerId)}},[]),r.useEffect(()=>{(async()=>{if(p)try{const i=((await g.get(`https://api.bookmyevent.ae/api/bookings/provider/${p}`)).data.data||[]).filter(h=>{var u,f;return((u=h.status)==null?void 0:u.toLowerCase())==="pending"||((f=h.paymentStatus)==null?void 0:f.toLowerCase())==="pending"});a(i)}catch(t){console.error("Error fetching pending bookings:",t)}finally{b(!1)}})()},[p]);const S=e=>{y(x===e?null:e)},C=async(e,t)=>{t.stopPropagation();try{await g.patch(`https://api.bookmyevent.ae/api/bookings/${e}/accept`),a(n=>n.filter(i=>i._id!==e)),alert("Booking Confirmed ✔️")}catch(n){console.error(n),alert("Failed to confirm booking")}},P=async(e,t)=>{t.stopPropagation();try{await g.patch(`https://api.bookmyevent.ae/api/bookings/${e}/reject`),a(n=>n.filter(i=>i._id!==e)),alert("Booking Rejected ❌")}catch(n){console.error(n),alert("Failed to reject booking")}};return o.jsx(l,{p:2,sx:{background:"#f4f7fb",minHeight:"100vh"},children:o.jsxs(l,{sx:{maxWidth:"850px",margin:"0 auto"},children:[o.jsx(s,{variant:"h4",fontWeight:600,mb:3,children:"Pending Bookings"}),k?o.jsx(l,{display:"flex",justifyContent:"center",mt:4,children:o.jsx(w,{})}):c.length===0?o.jsx(s,{children:"No Pending Bookings Found"}):c.map(e=>o.jsxs(B,{elevation:2,sx:{p:2.5,mt:2,borderRadius:"16px",cursor:"pointer",transition:"0.2s",background:"#fff","&:hover":{boxShadow:"0px 4px 20px rgba(0,0,0,0.08)",transform:"translateY(-2px)"}},onClick:()=>S(e._id),children:[o.jsxs(j,{direction:"row",justifyContent:"space-between",alignItems:"center",children:[o.jsxs(l,{children:[o.jsxs(s,{fontWeight:700,fontSize:16,children:["Booking ID:"," ",o.jsxs("span",{style:{color:"#1976d2"},children:["#",e._id.slice(-6)]})]}),o.jsx(s,{color:"gray",fontSize:14,children:e.moduleType||"Event Booking"}),o.jsx(s,{color:"gray",fontSize:13,mt:.5,children:new Date(e.bookingDate).toDateString()})]}),o.jsxs(s,{fontWeight:700,sx:{color:"#16a34a",fontSize:"18px"},children:["₹",e.finalPrice]})]}),o.jsxs(E,{in:x===e._id,children:[o.jsx(_,{sx:{my:2}}),o.jsxs(l,{sx:{background:"#f9fafb",p:2,borderRadius:"12px",border:"1px solid #e5e7eb"},children:[o.jsx(d,{label:"Customer",value:e.fullName}),o.jsx(d,{label:"Guests",value:e.numberOfGuests}),o.jsx(d,{label:"Email",value:e.emailAddress}),o.jsx(d,{label:"Phone",value:e.contactNumber||"N/A"}),o.jsx(d,{label:"Booking Type",value:e.bookingType})]}),o.jsxs(j,{direction:"row",spacing:2,mt:2,justifyContent:"center",children:[o.jsx(m,{variant:"outlined",sx:{width:"130px",borderRadius:"30px",color:"#e11d48",borderColor:"#e11d48","&:hover":{background:"#ffe4e6"}},onClick:t=>P(e._id,t),children:"Reject"}),o.jsx(m,{variant:"contained",sx:{width:"130px",borderRadius:"30px",bgcolor:"#16a34a","&:hover":{bgcolor:"#15803d"}},onClick:t=>C(e._id,t),children:"Confirm"})]})]})]},e._id))]})})},d=({label:c,value:a})=>o.jsxs(s,{fontSize:14,sx:{mb:.5},children:[o.jsxs("strong",{children:[c,":"]})," ",a]});export{I as default};
