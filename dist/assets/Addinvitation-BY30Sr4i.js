import{ad as oe,j as e,r as p,l as ne,d as le,aF as ce,aG as de,aH as pe,B as s,T as n,A as f,aI as he,s as m,Y as b,a as E,Z as U,c as ge,G as A,e as G,i as _,o as V,y as q,b as T,N as xe}from"./index-DQO8S-Hd.js";import{C as J}from"./Close-DxdnvH5I.js";import{A as Y}from"./AddPhotoAlternate-Bmz3mU4X.js";import{A as me,R as ue}from"./RotateLeft-CkxLoTpn.js";const fe=oe(e.jsx("path",{d:"M17 3H7c-1.1 0-1.99.9-1.99 2L5 21l7-3 7 3V5c0-1.1-.9-2-2-2m0 15-5-2.18L7 18V5h10z"})),M={},be=de({palette:{primary:{main:"#E15B65",dark:"#C2444E",light:"#F09898",contrastText:"#fff"},secondary:{main:"#D4A017"},background:{default:"#FDF6EE",paper:"#fff"},text:{primary:"#1A0A00",secondary:"#7A5C4A"}},typography:{fontFamily:"'DM Sans', sans-serif",h4:{fontFamily:"'Playfair Display', serif"}},shape:{borderRadius:14},components:{MuiCssBaseline:{styleOverrides:"@import url('https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,700;1,500&family=DM+Sans:wght@300;400;500;600&display=swap');"},MuiOutlinedInput:{styleOverrides:{root:{borderRadius:12,backgroundColor:"#FFFBF7",fontFamily:"'DM Sans', sans-serif",fontSize:"14.5px","& fieldset":{borderColor:"rgba(225, 91, 101,0.2)"},"&:hover fieldset":{borderColor:"rgba(225, 91, 101,0.5) !important"},"&.Mui-focused fieldset":{borderColor:"#E15B65 !important",borderWidth:"2px"}},input:{padding:"15px 16px"}}},MuiInputLabel:{styleOverrides:{root:{fontFamily:"'DM Sans', sans-serif",fontSize:"14px",color:"#8B3A0F","&.Mui-focused":{color:"#E15B65"}}}},MuiButton:{styleOverrides:{root:{textTransform:"none",fontFamily:"'DM Sans', sans-serif",fontWeight:600,borderRadius:12}}}}}),y=({children:i})=>e.jsx(n,{sx:{fontSize:"10.5px",fontWeight:700,letterSpacing:"0.13em",textTransform:"uppercase",color:"#E15B65",mb:1.25},children:i}),j={bgcolor:"#fff",border:"1px solid rgba(225, 91, 101, 0.11)",borderRadius:"16px",p:{xs:2.5,sm:3},boxShadow:"0 2px 14px rgba(225, 91, 101, 0.05)"};function we(){const[i,P]=p.useState({name:"",description:"",price:"",advance:"",category:""}),[F,I]=p.useState(null),[$,v]=p.useState(null),[Z,B]=p.useState([]),[g,S]=p.useState([]),[d,D]=p.useState({}),[R,w]=p.useState({open:!1,msg:"",severity:"success"}),[W,L]=p.useState(!1),[O,K]=p.useState([]),[Q,H]=p.useState(!1),{id:C}=ne();le();const u=!!C,h=(M==null?void 0:M.VITE_API_BASE_URL)||"https://api.bookmyevent.ae";p.useEffect(()=>{if(!C)return;(async()=>{var r;try{const a=localStorage.getItem("token"),x=await(await fetch(`${h}/api/invitation-printing/${C}`,{headers:{Authorization:`Bearer ${a}`}})).json();if(x.success){const o=x.data;P({name:o.packageName||"",description:o.description||"",price:o.packagePrice!=null?String(o.packagePrice):"",advance:o.advanceBookingAmount!=null?String(o.advanceBookingAmount):"",category:((r=o.category)==null?void 0:r._id)||o.category||""}),o.thumbnail&&v(`${h}${o.thumbnail.startsWith("/")?"":"/"}${o.thumbnail}`),o.images&&Array.isArray(o.images)&&S(o.images.map(c=>`${h}${c.startsWith("/")?"":"/"}${c}`))}}catch(a){console.error(a)}})()},[C,h]);const k=(t,r)=>{P(a=>({...a,[t]:r})),d[t]&&D(a=>({...a,[t]:""}))};p.useEffect(()=>{(async()=>{try{H(!0);const r=localStorage.getItem("moduleId");if(!r)return;const l=await(await fetch(`${h}/api/categories/modules/${r}`)).json();l.success&&K(l.data||[])}catch(r){console.error("Fetch categories error:",r)}finally{H(!1)}})()},[h]);const X=t=>{if(!(t!=null&&t.type.startsWith("image/")))return;I(t);const r=new FileReader;r.onload=a=>{v(a.target.result),D(l=>({...l,thumbnail:""}))},r.readAsDataURL(t)},z=t=>{const a=Array.from(t).filter(l=>l.type.startsWith("image/"));B(l=>[...l,...a]),a.forEach(l=>{const x=new FileReader;x.onload=o=>S(c=>[...c,o.target.result]),x.readAsDataURL(l)})},ee=t=>{B(r=>r.filter((a,l)=>l!==t)),S(r=>r.filter((a,l)=>l!==t))},te=()=>{const t={};return i.name.trim()||(t.name="Required"),i.description.trim()||(t.description="Required"),(!i.price||+i.price<=0)&&(t.price="Enter a valid price"),(i.advance===""||+i.advance<0)&&(t.advance="Enter a valid amount"),i.category||(t.category="Please select a category"),!u&&!F&&(t.thumbnail="Please upload a thumbnail"),t},re=async t=>{t.preventDefault();const r=te();if(Object.keys(r).length){D(r),w({open:!0,msg:"Please fix the highlighted fields.",severity:"error"});return}try{L(!0);const a=localStorage.getItem("moduleId"),x=JSON.parse(localStorage.getItem("user")||"{}")._id,o=localStorage.getItem("token");if(!a||!x)throw new Error("Module or Vendor session missing");const c=new FormData;c.append("secondaryModule",a),c.append("providerId",x),c.append("packageName",i.name),c.append("description",i.description),c.append("packagePrice",i.price),c.append("advanceBookingAmount",i.advance),c.append("category",i.category),F&&c.append("thumbnail",F),Z.forEach(se=>c.append("images",se));const ae=u?`${h}/api/invitation-printing/${C}`:`${h}/api/invitation-printing/create`,N=await fetch(ae,{method:u?"PUT":"POST",headers:o?{Authorization:`Bearer ${o}`}:void 0,body:c}),ie=await N.json();if(!N.ok)throw new Error(ie.message||"Something went wrong");w({open:!0,msg:"Invitation package published! ðŸŽ‰",severity:"success"}),u||(P({name:"",description:"",price:"",advance:"",category:""}),I(null),v(null),B([]),S([]))}catch(a){w({open:!0,msg:a.message,severity:"error"})}finally{L(!1)}};return e.jsxs(ce,{theme:be,children:[e.jsx(pe,{}),e.jsxs(s,{sx:{width:"100%",bgcolor:"#FDF6EE",minHeight:"100%",py:{xs:3,sm:4},px:{xs:2,sm:3,md:4}},children:[e.jsxs(s,{sx:{mb:3.5},children:[e.jsxs(n,{variant:"h4",fontWeight:700,sx:{fontSize:{xs:"1.65rem",sm:"2rem"},lineHeight:1.2},children:["Add"," ",e.jsx(s,{component:"em",sx:{color:"primary.main",fontStyle:"italic"},children:"Invitation"})," ","Package"]}),e.jsx(n,{variant:"body2",color:"text.secondary",mt:.75,fontSize:"13.5px",children:"Design and showcase your printing & invitation masterpieces."})]}),e.jsxs(s,{sx:{bgcolor:"#1A0A00",px:3.5,py:2.25,borderRadius:"16px 16px 0 0",display:"flex",alignItems:"center",gap:2},children:[e.jsx(f,{sx:{bgcolor:"rgba(225, 91, 101, 0.3)",borderRadius:"10px",width:38,height:38,fontSize:"15px"},children:"âœ¦"}),e.jsxs(s,{children:[e.jsx(n,{sx:{color:"#F7EDE0",fontFamily:"'Playfair Display', serif",fontSize:"1.05rem"},children:"Package Details"}),e.jsx(n,{sx:{color:"rgba(255,255,255,0.3)",fontSize:"11.5px"},children:"All * fields are required"})]})]}),W&&e.jsx(he,{color:"primary"}),e.jsx(s,{component:"form",onSubmit:re,noValidate:!0,sx:{border:"1px solid rgba(225, 91, 101, 0.11)",borderTop:"none",borderRadius:"0 0 16px 16px",bgcolor:"#FDF6EE",p:3,boxShadow:"0 4px 24px rgba(225, 91, 101, 0.06)"},children:e.jsxs(m,{spacing:2.5,children:[e.jsxs(b,{elevation:0,sx:j,children:[e.jsx(y,{children:"Package Name"}),e.jsx(E,{label:"Package Name *",placeholder:"e.g. Premium Laser-Cut Wedding Invite",fullWidth:!0,value:i.name,onChange:t=>k("name",t.target.value),error:!!d.name,helperText:d.name})]}),e.jsxs(b,{elevation:0,sx:j,children:[e.jsx(y,{children:"Description"}),e.jsx(E,{label:"Description *",placeholder:"Paper quality, print type, card dimensions, inclusions...",fullWidth:!0,multiline:!0,rows:4,value:i.description,onChange:t=>k("description",t.target.value),error:!!d.description,helperText:d.description})]}),e.jsxs(b,{elevation:0,sx:j,children:[e.jsx(y,{children:"Pricing"}),e.jsxs(m,{direction:{xs:"column",sm:"row"},spacing:2.5,children:[e.jsx(E,{label:"Base Price *",placeholder:"0",fullWidth:!0,type:"number",value:i.price,onChange:t=>k("price",t.target.value),error:!!d.price,helperText:d.price,InputProps:{startAdornment:e.jsx(U,{position:"start",children:e.jsx(n,{color:"primary.main",fontWeight:700,children:"â‚¹"})})}}),e.jsx(E,{label:"Advance Amount *",placeholder:"0",fullWidth:!0,type:"number",value:i.advance,onChange:t=>k("advance",t.target.value),error:!!d.advance,helperText:d.advance,InputProps:{startAdornment:e.jsx(U,{position:"start",children:e.jsx(n,{color:"secondary.main",fontWeight:700,children:"â‚¹"})})}})]})]}),e.jsxs(b,{elevation:0,sx:{...j,bgcolor:"#fff"},children:[e.jsx(y,{children:"Select Category"}),e.jsx(n,{variant:"caption",color:"text.secondary",sx:{mb:2,display:"block"},children:"Choose the type of invitation service you provide."}),Q?e.jsx(s,{sx:{display:"flex",justifyContent:"center",p:4},children:e.jsx(ge,{size:24})}):O.length>0?e.jsx(A,{container:!0,spacing:2,children:O.map(t=>e.jsx(A,{item:!0,xs:12,sm:6,md:4,children:e.jsxs(s,{onClick:()=>k("category",t._id),sx:{cursor:"pointer",p:2,borderRadius:"12px",border:"1px solid",borderColor:i.category===t._id?"#E15B65":"rgba(0,0,0,0.06)",bgcolor:i.category===t._id?"rgba(225, 91, 101, 0.04)":"#fff",display:"flex",alignItems:"center",gap:2,transition:"all 0.2s ease","&:hover":{borderColor:"#E15B65",transform:"translateY(-2px)",boxShadow:"0 4px 12px rgba(0,0,0,0.05)"}},children:[e.jsx(f,{src:t.image?t.image.startsWith("http")?t.image:`${h}${t.image}`:"",sx:{width:40,height:40,borderRadius:"8px",bgcolor:"rgba(225, 91, 101, 0.1)",color:"#E15B65"},children:!t.image&&e.jsx(fe,{fontSize:"small"})}),e.jsxs(s,{sx:{flexGrow:1},children:[e.jsx(n,{variant:"subtitle2",sx:{fontWeight:600,color:i.category===t._id?"#E15B65":"inherit"},children:t.title}),t.description&&e.jsx(n,{variant:"caption",color:"text.secondary",sx:{display:"-webkit-box",WebkitLineClamp:1,WebkitBoxOrient:"vertical",overflow:"hidden"},children:t.description})]}),i.category===t._id&&e.jsx(f,{sx:{width:20,height:20,bgcolor:"#E15B65",color:"#fff"},children:e.jsx(s,{component:"span",sx:{fontSize:"12px"},children:"âœ“"})})]})},t._id))}):e.jsx(G,{severity:"info",sx:{borderRadius:"12px"},children:"No categories found for this module. Please contact administrator."}),d.category&&e.jsx(_,{error:!0,sx:{mt:1,ml:1},children:d.category})]}),e.jsxs(m,{spacing:3,children:[e.jsxs(b,{elevation:0,sx:j,children:[e.jsx(y,{children:"Package Thumbnail"}),e.jsx(n,{variant:"caption",color:"text.secondary",sx:{mb:2,display:"block"},children:"Main image displayed in catalogs and lists."}),e.jsxs(s,{component:"label",htmlFor:"thumb-img",sx:{width:"100%",border:"2px dashed",borderColor:d.thumbnail?"#dc2626":"rgba(225, 91, 101, 0.2)",borderRadius:"16px",p:2,textAlign:"center",cursor:"pointer",bgcolor:"#FFFBF7",transition:"all 0.3s ease",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:220,"&:hover":{borderColor:"#E15B65",bgcolor:"rgba(225, 91, 101, 0.04)",transform:"scale(1.01)"}},children:[e.jsx("input",{id:"thumb-img",type:"file",accept:"image/*",hidden:!0,onChange:t=>X(t.target.files[0])}),$?e.jsxs(s,{sx:{position:"relative",width:"100%",height:"100%",minHeight:180},children:[e.jsx(s,{component:"img",src:$,sx:{width:"100%",height:"100%",maxHeight:280,objectFit:"contain",borderRadius:"10px"}}),e.jsx(V,{size:"small",sx:{position:"absolute",top:8,right:8,bgcolor:"rgba(255,255,255,0.9)","&:hover":{bgcolor:"#fff"}},onClick:t=>{t.preventDefault(),v(null),I(null)},children:e.jsx(J,{fontSize:"small"})})]}):e.jsxs(m,{alignItems:"center",spacing:1.5,children:[e.jsx(f,{sx:{bgcolor:"rgba(225, 91, 101, 0.1)",color:"#E15B65",width:56,height:56},children:e.jsx(q,{})}),e.jsxs(s,{children:[e.jsx(n,{variant:"subtitle2",fontWeight:700,children:"Click to upload thumbnail"}),e.jsx(n,{variant:"caption",color:"text.secondary",children:"PNG, JPG or JPEG (Max 5MB)"})]})]})]}),d.thumbnail&&e.jsx(_,{error:!0,sx:{mt:1,ml:1},children:d.thumbnail})]}),e.jsxs(b,{elevation:0,sx:j,children:[e.jsxs(m,{direction:"row",justifyContent:"space-between",alignItems:"center",sx:{mb:2},children:[e.jsxs(s,{children:[e.jsx(y,{children:"Gallery"}),e.jsx(n,{variant:"caption",color:"text.secondary",children:"Additional photos showcasing details and variations."})]}),e.jsxs(T,{component:"label",variant:"outlined",size:"small",startIcon:e.jsx(Y,{}),sx:{borderRadius:"10px",textTransform:"none",fontWeight:700},children:["Add Photos",e.jsx("input",{type:"file",accept:"image/*",multiple:!0,hidden:!0,id:"gallery-input-btn",onChange:t=>z(t.target.files)})]})]}),e.jsxs(s,{component:g.length===0?"label":"div",htmlFor:g.length===0?"gallery-input-main":void 0,sx:{minHeight:220,p:3,borderRadius:"16px",bgcolor:"#FFFBF7",border:"1px solid",borderColor:"rgba(225, 91, 101, 0.12)",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",cursor:g.length===0?"pointer":"default",transition:"all 0.3s ease","&:hover":g.length===0?{borderColor:"#E15B65",bgcolor:"rgba(225, 91, 101, 0.04)",transform:"scale(1.002)"}:{}},children:[g.length===0&&e.jsx("input",{id:"gallery-input-main",type:"file",accept:"image/*",multiple:!0,hidden:!0,onChange:t=>z(t.target.files)}),g.length>0?e.jsxs(A,{container:!0,spacing:2.5,sx:{width:"100%"},children:[g.map((t,r)=>e.jsx(A,{item:!0,xs:6,sm:4,md:3,lg:2.4,children:e.jsxs(s,{sx:{position:"relative",pt:"100%",borderRadius:"16px",overflow:"hidden",boxShadow:"0 8px 16px rgba(0,0,0,0.06)",border:"1px solid rgba(0,0,0,0.04)","&:hover .delete-overlay":{opacity:1},transition:"transform 0.3s ease","&:hover":{transform:"translateY(-6px)"}},children:[e.jsx(s,{component:"img",src:t,sx:{position:"absolute",top:0,left:0,width:"100%",height:"100%",objectFit:"cover"}}),e.jsx(s,{className:"delete-overlay",sx:{position:"absolute",top:0,left:0,right:0,bottom:0,bgcolor:"rgba(0,0,0,0.4)",display:"flex",alignItems:"center",justifyContent:"center",opacity:{xs:1,md:0},transition:"opacity 0.2s",backdropFilter:"blur(2px)"},children:e.jsx(V,{size:"small",sx:{bgcolor:"rgba(255,255,255,0.95)",color:"#dc2626","&:hover":{bgcolor:"#fff",transform:"scale(1.1)"},boxShadow:"0 4px 12px rgba(0,0,0,0.2)",transition:"all 0.2s"},onClick:a=>{a.preventDefault(),a.stopPropagation(),ee(r)},children:e.jsx(J,{fontSize:"small"})})})]})},r)),g.length<10&&e.jsx(A,{item:!0,xs:6,sm:4,md:3,lg:2.4,children:e.jsxs(s,{component:"label",sx:{pt:"100%",position:"relative",borderRadius:"16px",border:"2px dashed rgba(225, 91, 101, 0.25)",display:"block",cursor:"pointer",transition:"all 0.3s","&:hover":{bgcolor:"rgba(225, 91, 101, 0.06)",borderColor:"#E15B65",transform:"scale(1.02)"}},children:[e.jsx("input",{type:"file",accept:"image/*",multiple:!0,hidden:!0,onChange:t=>z(t.target.files)}),e.jsxs(s,{sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",display:"flex",flexDirection:"column",alignItems:"center",gap:1.5},children:[e.jsx(f,{sx:{bgcolor:"rgba(225, 91, 101, 0.1)",color:"#E15B65",width:44,height:44},children:e.jsx(Y,{})}),e.jsx(n,{variant:"caption",sx:{fontWeight:800,color:"#E15B65",letterSpacing:.5},children:"ADD MORE"})]})]})})]}):e.jsxs(m,{alignItems:"center",spacing:2.5,sx:{py:4},children:[e.jsx(f,{sx:{bgcolor:"rgba(225, 91, 101, 0.08)",color:"#E15B65",width:72,height:72,border:"1px solid rgba(225, 91, 101, 0.1)"},children:e.jsx(q,{sx:{fontSize:36}})}),e.jsxs(s,{textAlign:"center",children:[e.jsx(n,{variant:"h6",sx:{fontWeight:800,color:"#1A0A00",mb:.5},children:"Click here to upload gallery"}),e.jsx(n,{variant:"body2",color:"text.secondary",sx:{opacity:.7},children:"Upload up to 10 photos of your invitation design variations."})]})]})]})]})]}),e.jsxs(m,{direction:"row",spacing:2,pt:2,children:[e.jsx(T,{type:"submit",variant:"contained",size:"large",fullWidth:!0,startIcon:e.jsx(me,{}),disabled:W,sx:{py:1.5,background:"linear-gradient(135deg, #E15B65 0%, #C2444E 100%)"},children:W?"Processing...":u?"Update Package":"Publish Invitation"}),!u&&e.jsx(T,{variant:"outlined",size:"large",fullWidth:!0,startIcon:e.jsx(ue,{}),onClick:()=>{P({name:"",description:"",price:"",advance:"",category:""}),v(null),S([])},children:"Reset"})]})]})})]}),e.jsx(xe,{open:R.open,autoHideDuration:3500,onClose:()=>w(t=>({...t,open:!1})),anchorOrigin:{vertical:"top",horizontal:"right"},children:e.jsx(G,{severity:R.severity,variant:"filled",onClose:()=>w(t=>({...t,open:!1})),sx:{borderRadius:"12px"},children:R.msg})})]})}export{we as default};
