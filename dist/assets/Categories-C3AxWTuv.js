import{u as B,r as a,j as e,B as n,am as L,T as v,t as $,b as U,h as P,Q as D,U as I,v as _}from"./index-CYOhujfk.js";import{A as F}from"./ArrowDropDown-B87ifF2O.js";import{S as H}from"./Search-Cy2wkmMw.js";import{T as M,a as w,b as r,c as N}from"./TableRow-76LlmTPY.js";import{T as z}from"./TableHead-D9aopKCL.js";const G=()=>{B();const[c,E]=a.useState(""),[h,S]=a.useState([]),[x,m]=a.useState([]),[u,g]=a.useState(null),[T,A]=a.useState(!0),[f,j]=a.useState(null),d=localStorage.getItem("moduleId"),p="https://api.bookmyevent.ae";a.useEffect(()=>{(async()=>{try{if(!d)throw new Error("Module ID not found in localStorage");const o=await fetch(`${p}/api/categories/modules/${d}`);if(!o.ok)throw new Error(`HTTP error! ${o.status}`);const i=await o.json();if(i.success&&Array.isArray(i.data)){const l=i.data.map(t=>({id:t.categoryId||t._id,name:t.title,image:t.image?`${p}${t.image}`:"",status:t.isActive}));S(l),m(l)}else g("No categories found for this module")}catch(o){console.error(o),g(o.message)}finally{A(!1)}})()},[d]),a.useEffect(()=>{const s=h.filter(o=>o.name.toLowerCase().includes(c.toLowerCase()));m(s)},[c,h]);const k=s=>j(s.currentTarget),b=()=>j(null),C=s=>{let o=`SI,Category Id,Category Name
`;x.forEach((y,R)=>{o+=`${R+1},${y.id},${y.name}
`});const i=new Blob([o],{type:s==="excel"?"application/vnd.ms-excel":"text/csv"}),l=window.URL.createObjectURL(i),t=document.createElement("a");t.href=l,t.download=`mehandi_categories.${s}`,t.click(),window.URL.revokeObjectURL(l),b()};return e.jsx(n,{sx:{p:4,bgcolor:"#f8f9fc",minHeight:"100vh"},children:e.jsxs(L,{elevation:3,sx:{p:4,borderRadius:4},children:[e.jsxs(n,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:4},children:[e.jsx(v,{variant:"h4",sx:{fontWeight:700,color:"#E15B65"},children:"Invitation Category List"}),e.jsxs(n,{sx:{display:"flex",gap:2},children:[e.jsx($,{size:"small",placeholder:"Search categories...",value:c,onChange:s=>E(s.target.value),InputProps:{startAdornment:e.jsx(U,{position:"start",children:e.jsx(H,{})})}}),e.jsx(P,{variant:"contained",endIcon:e.jsx(F,{}),onClick:k,sx:{bgcolor:"#E15B65","&:hover":{bgcolor:"#C2444E"}},children:"Export"}),e.jsxs(D,{anchorEl:f,open:!!f,onClose:b,children:[e.jsx(I,{onClick:()=>C("excel"),children:"Excel"}),e.jsx(I,{onClick:()=>C("csv"),children:"CSV"})]})]})]}),T?e.jsx(n,{sx:{textAlign:"center",py:5},children:e.jsx(_,{})}):u?e.jsx(v,{color:"error",children:u}):e.jsxs(M,{children:[e.jsx(z,{children:e.jsxs(w,{sx:{bgcolor:"#fce9ea"},children:[e.jsx(r,{children:"SI"}),e.jsx(r,{children:"Image"}),e.jsx(r,{children:"Category Name"}),e.jsx(r,{children:"Category ID"}),e.jsx(r,{children:"Status"})]})}),e.jsx(N,{children:x.map((s,o)=>e.jsxs(w,{hover:!0,sx:{"&:hover":{bgcolor:"#fff5f6"}},children:[e.jsx(r,{children:o+1}),e.jsx(r,{children:e.jsx(n,{component:"img",src:s.image,alt:s.name,sx:{width:80,height:60,objectFit:"cover",borderRadius:2}})}),e.jsx(r,{sx:{fontWeight:600},children:s.name}),e.jsx(r,{children:s.id}),e.jsx(r,{children:e.jsx(n,{sx:{px:2,py:.5,borderRadius:3,display:"inline-block",fontSize:12,bgcolor:s.status?"#e6f4ea":"#fdecea",color:s.status?"#2e7d32":"#d32f2f"},children:s.status?"Active":"Inactive"})})]},s.id))})]})]})})};export{G as default};
