import{ah as ve,w as Se,r as o,j as e,B as c,t as se,b as C,aj as Ce,T as p,x as ie,ae as L,s as x,S as O,F as ke,I as we,af as Ae,W as oe,a4 as Pe,aN as Ie,f as U,C as Ee,g as le,h as S,aq as Te,ak as _e}from"./index-BPHwo8FW.js";import{A as Be}from"./Add-CYAdmdYs.js";import{C as re}from"./Close-1N-owGr-.js";import{C as De}from"./CloudUpload-CotsZdPm.js";const d="#E91E63",b="https://api.bookmyevent.ae",ne="68e5fb0fa4b2718b6cbf64e9",We=[{id:"drone_video",label:"Drone Video"},{id:"pre_wedding",label:"Pre-Wedding Shoot"},{id:"candid_photography",label:"Candid Photography"},{id:"traditional_photography",label:"Traditional Photography"},{id:"video_editing",label:"Video Editing"},{id:"photo_album",label:"Photo Album"},{id:"led_wall",label:"LED Wall Display"},{id:"crane_shoot",label:"Crane/Jib Shoot"}],ce=h=>e.jsx(_e,{...h,sx:{"& .MuiSwitch-switchBase":{color:"#fff","&.Mui-checked":{color:d},"&.Mui-checked + .MuiSwitch-track":{backgroundColor:d,opacity:.8}},"& .MuiSwitch-track":{backgroundColor:"#ddd",opacity:.6},"&.Mui-checked .MuiSwitch-thumb":{color:d}}}),Me=({section:h,onChange:j,onDelete:u})=>e.jsxs(c,{sx:{position:"relative",border:"1px solid #e5e5e5",borderRadius:2,p:3,mb:3,bgcolor:"white"},children:[e.jsx(C,{onClick:u,sx:{position:"absolute",top:12,right:12,color:d},children:e.jsx(Te,{fontSize:"small"})}),e.jsx(x,{fullWidth:!0,label:e.jsxs("span",{children:["Section Title ",e.jsx("span",{style:{color:"red"},children:"*"})]}),value:h.title||"",onChange:m=>j("title",m.target.value),sx:{mb:2}}),e.jsx(x,{fullWidth:!0,label:e.jsxs("span",{children:["Items (comma separated) ",e.jsx("span",{style:{color:"red"},children:"*"})]}),placeholder:"e.g. 300 edited photos, Full day coverage",value:Array.isArray(h.items)?h.items.join(", "):"",onChange:m=>j("items",m.target.value),multiline:!0,rows:2,helperText:"Separate items with commas"})]}),Re=()=>{const{id:h}=ve(),j=Se(),u=!!h,[m,J]=o.useState(!0),[q,H]=o.useState(!1),[K,y]=o.useState(""),[V,g]=o.useState(""),[k,de]=o.useState([]),[he,Y]=o.useState(!0),[r,Q]=o.useState(null),[w,A]=o.useState(""),[P,I]=o.useState([]),[E,T]=o.useState(""),[_,B]=o.useState(""),[X,D]=o.useState(""),[Z,W]=o.useState(""),[ee,M]=o.useState(!1),[te,F]=o.useState(!0),[ae,N]=o.useState([]),[z,f]=o.useState([{id:Date.now(),title:"",items:[]}]),[v,$]=o.useState([]),[R,G]=o.useState([]),ge=()=>{A(""),I([]),T(""),B(""),D(""),W(""),M(!1),F(!0),N([]),f([{id:Date.now(),title:"",items:[]}]),$([]),G([]),g("")};o.useEffect(()=>{try{const t=localStorage.getItem("vendor")||localStorage.getItem("user")||localStorage.getItem("vendorData");if(t){const a=JSON.parse(t);Q(a)}else{const a=localStorage.getItem("vendorId")||localStorage.getItem("userId");a&&Q({_id:a,id:a})}}catch(t){console.error("Error loading vendor info:",t)}},[]),o.useEffect(()=>{(async()=>{try{Y(!0);const a=await S.get(`${b}/api/categories/modules/${ne}`);de(a.data.data||[])}catch{g("Failed to load categories")}finally{Y(!1)}})()},[]),o.useEffect(()=>{if(!u){J(!1);return}(async()=>{var a,s;try{const i=(await S.get(`${b}/api/photography-packages/${h}`)).data.data;A(i.packageTitle),I(i.categories.map(l=>l._id)),T(i.price),B(i.description),D(i.cancellationPolicy),W(i.advanceBookingAmount),M(i.travelToVenue),F(i.isActive),i.basicAddons&&Array.isArray(i.basicAddons)&&N(i.basicAddons),((a=i.includedServices)==null?void 0:a.length)>0&&f(i.includedServices.map(l=>({id:l._id,title:l.title,items:l.items}))),((s=i.gallery)==null?void 0:s.length)>0&&G(i.gallery.map(l=>`${b}${l}`))}catch{g("Failed to load package")}finally{J(!1)}})()},[h,u]);const pe=()=>{f(t=>[...t,{id:Date.now(),title:"",items:[]}])},ue=(t,a,s)=>{f(n=>n.map(i=>i.id===t?{...i,[a]:a==="items"?s.split(",").map(l=>l.trim()).filter(Boolean):s}:i))},xe=t=>{z.length>1&&f(a=>a.filter(s=>s.id!==t))},me=t=>{N(a=>a.includes(t)?a.filter(s=>s!==t):[...a,t])},fe=t=>{const a=Array.from(t.target.files);if(v.length+R.length+a.length>10)return alert("Maximum 10 images allowed");$(n=>[...n,...a])},be=t=>$(a=>a.filter((s,n)=>n!==t)),je=t=>G(a=>a.filter((s,n)=>n!==t)),ye=async()=>{var n,i;const t=(r==null?void 0:r._id)||(r==null?void 0:r.id);if(!t)return g("Vendor not authenticated");if(!w.trim())return g("Package title required");if(P.length===0)return g("Select at least one category");if(!E)return g("Price required");if(!_.trim())return g("Description required");const a=new FormData;a.append("module",ne),a.append("packageTitle",w.trim()),a.append("description",_.trim()),P.forEach(l=>a.append("categories",l)),a.append("price",E),a.append("cancellationPolicy",X),a.append("advanceBookingAmount",Z),a.append("travelToVenue",ee),a.append("isActive",te),a.append("providerId",t),a.append("basicAddons",JSON.stringify(ae));const s=z.filter(l=>l.title.trim()&&l.items.length>0).map(l=>({title:l.title.trim(),items:l.items}));a.append("includedServices",JSON.stringify(s)),v.forEach(l=>a.append("gallery",l));try{H(!0),g(""),y(""),u?(await S.put(`${b}/api/photography-packages/${h}`,a),y("Package updated successfully!")):(await S.post(`${b}/api/photography-packages`,a),y("Package created successfully!"),setTimeout(()=>{ge(),y("")},2e3))}catch(l){g(((i=(n=l.response)==null?void 0:n.data)==null?void 0:i.message)||"Error saving package")}finally{H(!1),window.scrollTo({top:0,behavior:"smooth"})}};return m||he?e.jsx(c,{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"80vh",children:e.jsx(se,{size:60})}):e.jsxs(c,{sx:{bgcolor:"#f9f9fc",minHeight:"100vh"},children:[e.jsxs(c,{sx:{bgcolor:"white",borderBottom:"1px solid #eee",p:2,px:4,position:"sticky",top:0,zIndex:10},children:[e.jsxs(c,{sx:{display:"flex",alignItems:"center",gap:2},children:[e.jsx(C,{onClick:()=>j(-1),children:e.jsx(Ce,{})}),e.jsxs(p,{variant:"h5",fontWeight:"bold",children:[u?"Edit":"Add"," Photography Package"]})]}),r&&e.jsxs(p,{variant:"body2",color:"text.secondary",sx:{ml:7},children:["Creating as: ",(r==null?void 0:r.firstName)||(r==null?void 0:r.email)||(r==null?void 0:r._id)]})]}),e.jsxs(c,{sx:{p:{xs:2,md:4}},children:[K&&e.jsx(ie,{severity:"success",sx:{mb:3},children:K}),V&&e.jsx(ie,{severity:"error",sx:{mb:3},children:V}),e.jsxs(L,{elevation:3,sx:{borderRadius:3,p:{xs:3,md:6}},children:[e.jsx(x,{fullWidth:!0,label:e.jsxs("span",{children:["Package Title ",e.jsx("span",{style:{color:"red"},children:"*"})]}),value:w,onChange:t=>A(t.target.value),sx:{mb:3}}),e.jsx(O,{direction:{xs:"column",md:"row"},spacing:3,sx:{mb:3},children:e.jsxs(ke,{fullWidth:!0,children:[e.jsx(we,{children:"Categories *"}),e.jsx(Ae,{multiple:!0,value:P,onChange:t=>I(t.target.value),renderValue:t=>e.jsx(c,{sx:{display:"flex",flexWrap:"wrap",gap:.5},children:t.map(a=>{const s=k.find(n=>n._id===a);return e.jsx(Pe,{label:(s==null?void 0:s.title)||"Unknown",size:"small"},a)})}),children:k.length===0?e.jsx(oe,{disabled:!0,children:"No categories available"}):k.map(t=>e.jsx(oe,{value:t._id,children:t.title},t._id))})]})}),e.jsxs(O,{direction:{xs:"column",md:"row"},spacing:3,sx:{mb:3},children:[e.jsx(x,{fullWidth:!0,label:e.jsxs("span",{children:["Price ",e.jsx("span",{style:{color:"red"},children:"*"})]}),type:"number",value:E,onChange:t=>T(t.target.value)}),e.jsx(x,{fullWidth:!0,label:"Advance Booking Amount (%)",value:Z,onChange:t=>W(t.target.value),placeholder:"e.g. 50%"})]}),e.jsx(x,{fullWidth:!0,label:e.jsxs("span",{children:["Description ",e.jsx("span",{style:{color:"red"},children:"*"})]}),multiline:!0,rows:4,value:_,onChange:t=>B(t.target.value),sx:{mb:4}}),e.jsxs(c,{sx:{mb:4},children:[e.jsx(p,{variant:"h6",sx:{color:d,mb:2},children:"Basic Add-ons"}),e.jsx(L,{sx:{border:"1px solid #e5e5e5",borderRadius:2,p:3},children:e.jsx(Ie,{children:e.jsx(c,{sx:{display:"grid",gridTemplateColumns:{xs:"1fr",sm:"1fr 1fr",md:"1fr 1fr 1fr 1fr"},gap:2},children:We.map(t=>e.jsx(U,{control:e.jsx(Ee,{checked:ae.includes(t.id),onChange:()=>me(t.id),sx:{color:d,"&.Mui-checked":{color:d}}}),label:t.label},t.id))})})})]}),e.jsxs(c,{sx:{mb:4},children:[e.jsxs(c,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3},children:[e.jsx(p,{variant:"h6",sx:{color:d},children:"Custom Service Sections"}),e.jsx(le,{variant:"contained",startIcon:e.jsx(Be,{}),sx:{bgcolor:d,"&:hover":{bgcolor:"#c2185b"}},onClick:pe,children:"Add Section"})]}),z.map(t=>e.jsx(Me,{section:t,onChange:(a,s)=>ue(t.id,a,s),onDelete:()=>xe(t.id)},t.id))]}),e.jsx(x,{fullWidth:!0,label:"Cancellation Policy",multiline:!0,rows:3,value:X,onChange:t=>D(t.target.value),sx:{mb:4},placeholder:"e.g. No refund within 48 hours of event"}),e.jsxs(O,{direction:"row",spacing:6,alignItems:"center",sx:{mb:4},children:[e.jsx(U,{control:e.jsx(ce,{checked:ee,onChange:()=>M(t=>!t)}),label:e.jsx(p,{fontWeight:"medium",children:"Travel to Venue"})}),e.jsx(U,{control:e.jsx(ce,{checked:te,onChange:()=>F(t=>!t)}),label:e.jsx(p,{fontWeight:"medium",children:"Package Active"})})]}),e.jsx(p,{variant:"h6",sx:{color:d,mb:2},children:"Gallery (Max 10)"}),e.jsxs(L,{onClick:()=>document.getElementById("gallery-input").click(),sx:{border:"2px dashed #ddd",borderRadius:2,p:4,textAlign:"center",cursor:"pointer",mb:4,"&:hover":{borderColor:d}},children:[e.jsx("input",{id:"gallery-input",type:"file",hidden:!0,multiple:!0,accept:"image/*",onChange:fe}),v.length>0||R.length>0?e.jsxs(c,{sx:{display:"flex",flexWrap:"wrap",gap:2,justifyContent:"center"},children:[R.map((t,a)=>e.jsxs(c,{sx:{position:"relative"},children:[e.jsx("img",{src:t,alt:"",style:{width:120,height:120,objectFit:"cover",borderRadius:8}}),e.jsx(C,{onClick:s=>{s.stopPropagation(),je(a)},sx:{position:"absolute",top:-8,right:-8,bgcolor:"white",boxShadow:2},size:"small",children:e.jsx(re,{fontSize:"small"})})]},`ex-${a}`)),v.map((t,a)=>e.jsxs(c,{sx:{position:"relative"},children:[e.jsx("img",{src:URL.createObjectURL(t),alt:"",style:{width:120,height:120,objectFit:"cover",borderRadius:8}}),e.jsx(C,{onClick:s=>{s.stopPropagation(),be(a)},sx:{position:"absolute",top:-8,right:-8,bgcolor:"white",boxShadow:2},size:"small",children:e.jsx(re,{fontSize:"small"})})]},`new-${a}`))]}):e.jsxs(e.Fragment,{children:[e.jsx(De,{sx:{fontSize:60,color:"#ccc"}}),e.jsx(p,{sx:{mt:2,color:d,fontWeight:"bold"},children:"Click to Upload Images"}),e.jsx(p,{variant:"body2",color:"text.secondary",children:"Supports: JPG, PNG, WEBP (Max 10MB each)"})]})]}),e.jsx(le,{fullWidth:!0,variant:"contained",size:"large",onClick:ye,disabled:q||!r,sx:{py:2,bgcolor:d,"&:hover":{bgcolor:"#c2185b"},"&:disabled":{bgcolor:"#ccc"}},children:q?e.jsx(se,{size:28,color:"inherit"}):u?"Update Package":"Create Package"})]})]})]})};export{Re as default};
