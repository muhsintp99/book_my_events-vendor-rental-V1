import{w as G,r as a,j as e,B as l,T as i,x as H,ad as A,S as y,s as _,ag as $,$ as x,t as J,a9 as L,bb as v,b as h,V as K,ar as Q,ab as X,ac as Y,G as j,p as C,W as S,P as Z,aH as ee,aG as se,g as P,h as te}from"./index-B8F777M9.js";import{C as N,A as ne}from"./Chat-KHkUAW0k.js";import{C as ie}from"./Close-apOor3_h.js";import{E as re}from"./Event-Djfzbrdb.js";import{C as ae}from"./Category-Cs1WE5BJ.js";import{T as le}from"./TableContainer-CrvItOzS.js";import{T as oe,a as ce,b as m,c as n,d as de}from"./TableRow-CmNbQPLO.js";import{D as xe}from"./DialogTitle-CubdxOa0.js";import{D as ue}from"./DialogActions-Dnl0I3vj.js";const Ce=()=>{var B,T;const I=G(),[d,M]=a.useState(""),[g,R]=a.useState("all"),[F,w]=a.useState([]),[p,E]=a.useState(!0),[D,f]=a.useState(null),[b,O]=a.useState(null),[U,q]=a.useState(!1),[t,k]=a.useState(null);a.useEffect(()=>{const s=localStorage.getItem("user");if(s){const r=JSON.parse(s);O(r.providerId||r._id)}},[]),a.useEffect(()=>{(async()=>{if(!b){f("Provider ID not found"),E(!1);return}try{const r=await te.get(`https://api.bookmyevent.ae/api/enquiries/provider/${b}`);w(r.data.data||[]),f(null)}catch{f("Failed to fetch enquiries"),w([])}finally{E(!1)}})()},[b]);const z=F.filter(s=>{var W;const r=(s.fullName||"").toLowerCase().includes(d.toLowerCase())||(s.email||"").toLowerCase().includes(d.toLowerCase())||(s.contact||"").includes(d)||(((W=s.moduleId)==null?void 0:W.title)||"").toLowerCase().includes(d.toLowerCase()),c=g==="all"||s.status===g;return r&&c}),V=s=>{k(s),q(!0)},u=()=>{q(!1),k(null)},o=({icon:s,label:r,value:c})=>e.jsxs(l,{display:"flex",alignItems:"center",gap:2,py:1.5,sx:{borderBottom:"1px solid",borderColor:"divider","&:last-child":{borderBottom:"none"}},children:[e.jsx(l,{sx:{display:"flex",alignItems:"center",justifyContent:"center",width:40,height:40,borderRadius:"50%",bgcolor:"primary.light",color:"primary.main",flexShrink:0},children:s}),e.jsxs(l,{flex:1,children:[e.jsx(i,{variant:"caption",color:"text.secondary",display:"block",children:r}),e.jsx(i,{variant:"body1",fontWeight:500,children:c||"N/A"})]})]});return e.jsxs(l,{p:2,children:[e.jsx(i,{variant:"h4",gutterBottom:!0,children:"Enquiries"}),D&&e.jsx(H,{severity:"error",sx:{mb:2},children:D}),e.jsxs(A,{sx:{mt:2},children:[e.jsxs(y,{direction:{xs:"column",sm:"row"},spacing:2,p:2,children:[e.jsx(_,{label:"Search enquiries",size:"small",value:d,onChange:s=>M(s.target.value),fullWidth:!0}),e.jsxs($,{size:"small",value:g,onChange:s=>R(s.target.value),sx:{minWidth:160},children:[e.jsx(x,{value:"all",children:"All"}),e.jsx(x,{value:"pending",children:"Pending"}),e.jsx(x,{value:"responded",children:"Responded"}),e.jsx(x,{value:"confirmed",children:"Confirmed"}),e.jsx(x,{value:"cancelled",children:"Cancelled"})]})]}),e.jsx(le,{children:e.jsxs(oe,{children:[e.jsx(ce,{children:e.jsxs(m,{children:[e.jsx(n,{children:"#"}),e.jsx(n,{children:"Customer"}),e.jsx(n,{children:"Module"}),e.jsx(n,{children:"Contact"}),e.jsx(n,{children:"Date"}),e.jsx(n,{children:"Status"}),e.jsx(n,{align:"center",children:"Actions"})]})}),e.jsxs(de,{children:[p&&e.jsx(m,{children:e.jsx(n,{colSpan:7,align:"center",children:e.jsx(J,{size:28})})}),!p&&z.map((s,r)=>{var c;return e.jsxs(m,{hover:!0,children:[e.jsx(n,{children:r+1}),e.jsxs(n,{children:[e.jsx(i,{fontWeight:600,children:s.fullName}),e.jsx(i,{variant:"caption",color:"text.secondary",children:s.email})]}),e.jsx(n,{children:(c=s.moduleId)==null?void 0:c.title}),e.jsx(n,{children:s.contact}),e.jsx(n,{children:new Date(s.bookingDate).toLocaleDateString()}),e.jsx(n,{children:e.jsx(L,{size:"small",label:s.status,color:s.status==="pending"?"warning":s.status==="confirmed"?"success":"default"})}),e.jsx(n,{align:"center",children:e.jsxs(y,{direction:"row",spacing:1,justifyContent:"center",children:[e.jsx(v,{title:"Open Chat",children:e.jsx(h,{size:"small",color:"primary",onClick:()=>I("/makeupartist/Enqurychat",{state:s}),children:e.jsx(N,{fontSize:"small"})})}),e.jsx(v,{title:"View Enquiry",children:e.jsx(h,{size:"small",color:"info",onClick:()=>V(s),children:e.jsx(K,{fontSize:"small"})})}),e.jsx(v,{title:"Delete Enquiry",children:e.jsx(h,{size:"small",color:"error",children:e.jsx(Q,{fontSize:"small"})})})]})})]},s._id)}),!p&&z.length===0&&e.jsx(m,{children:e.jsx(n,{colSpan:7,align:"center",children:"No enquiries found"})})]})]})})]}),e.jsxs(X,{open:U,onClose:u,maxWidth:"md",fullWidth:!0,PaperProps:{sx:{borderRadius:2}},children:[e.jsx(xe,{sx:{bgcolor:"primary.main",color:"white",py:2.5},children:e.jsxs(l,{display:"flex",justifyContent:"space-between",alignItems:"center",children:[e.jsx(i,{variant:"h6",fontWeight:600,children:"Enquiry Details"}),e.jsx(h,{onClick:u,size:"small",sx:{color:"white","&:hover":{bgcolor:"rgba(255, 255, 255, 0.1)"}},children:e.jsx(ie,{})})]})}),e.jsx(Y,{sx:{p:0},children:t&&e.jsxs(l,{children:[e.jsx(l,{sx:{bgcolor:"grey.50",p:3,borderBottom:"1px solid",borderColor:"divider"},children:e.jsxs(y,{direction:"row",spacing:2,alignItems:"center",justifyContent:"space-between",children:[e.jsxs(l,{children:[e.jsx(i,{variant:"caption",color:"text.secondary",children:"Enquiry ID"}),e.jsx(i,{variant:"body2",fontWeight:500,sx:{fontFamily:"monospace"},children:t._id})]}),e.jsx(L,{label:(B=t.status)==null?void 0:B.toUpperCase(),color:t.status==="pending"?"warning":t.status==="confirmed"?"success":t.status==="cancelled"?"error":"default",sx:{fontWeight:600}})]})}),e.jsx(l,{p:3,children:e.jsxs(j,{container:!0,spacing:3,children:[e.jsx(j,{item:!0,xs:12,md:6,children:e.jsx(C,{variant:"outlined",sx:{height:"100%"},children:e.jsxs(S,{children:[e.jsx(i,{variant:"subtitle1",fontWeight:600,gutterBottom:!0,sx:{mb:2},children:"Customer Information"}),e.jsx(o,{icon:e.jsx(Z,{fontSize:"small"}),label:"Full Name",value:t.fullName}),e.jsx(o,{icon:e.jsx(ee,{fontSize:"small"}),label:"Email Address",value:t.email}),e.jsx(o,{icon:e.jsx(se,{fontSize:"small"}),label:"Contact Number",value:t.contact})]})})}),e.jsx(j,{item:!0,xs:12,md:6,children:e.jsx(C,{variant:"outlined",sx:{height:"100%"},children:e.jsxs(S,{children:[e.jsx(i,{variant:"subtitle1",fontWeight:600,gutterBottom:!0,sx:{mb:2},children:"Booking Information"}),e.jsx(o,{icon:e.jsx(ae,{fontSize:"small"}),label:"Module/Service",value:(T=t.moduleId)==null?void 0:T.title}),e.jsx(o,{icon:e.jsx(re,{fontSize:"small"}),label:"Booking Date",value:t.bookingDate?new Date(t.bookingDate).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"}):null}),e.jsx(o,{icon:e.jsx(ne,{fontSize:"small"}),label:"Created At",value:t.createdAt?new Date(t.createdAt).toLocaleString("en-US",{dateStyle:"medium",timeStyle:"short"}):null})]})})}),t.message&&e.jsx(j,{item:!0,xs:12,children:e.jsx(C,{variant:"outlined",children:e.jsxs(S,{children:[e.jsx(i,{variant:"subtitle1",fontWeight:600,gutterBottom:!0,children:"Message"}),e.jsx(A,{variant:"outlined",sx:{p:2.5,bgcolor:"grey.50",mt:1.5,border:"none"},children:e.jsx(i,{variant:"body2",sx:{lineHeight:1.7,whiteSpace:"pre-wrap"},children:t.message})})]})})})]})})]})}),e.jsxs(ue,{sx:{px:3,py:2,bgcolor:"grey.50"},children:[e.jsx(P,{onClick:u,variant:"outlined",children:"Close"}),e.jsx(P,{variant:"contained",startIcon:e.jsx(N,{}),onClick:()=>{u(),I("/makeupartist/Enqurychat",{state:t})},children:"Open Chat"})]})]})]})};export{Ce as default};
