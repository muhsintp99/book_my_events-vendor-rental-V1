import{v as g,w as x,r as n,j as e,B as d,t as m,x as v,T as c,h}from"./index-DkD_OfQp.js";const I="https://api.bookmyevent.ae";function P(){const[p]=g();x();const t=p.get("orderId"),o=JSON.parse(localStorage.getItem("user")||"{}"),y=o==null?void 0:o._id,f=localStorage.getItem("moduleId"),[i,s]=n.useState("verifying"),[l,a]=n.useState("Verifying payment...");return n.useRef(y),n.useRef(f),n.useEffect(()=>{if(!t){s("error"),a("Invalid payment reference.");return}(async()=>{var u;try{const r=await h.post(`${I}/api/payment/verify-subscription-payment`,{orderId:t});if(r.data.success&&((u=r.data.subscription)==null?void 0:u.status)==="active"){s("success"),a("ðŸŽ‰ Subscription activated successfully!"),setTimeout(()=>{window.location.replace("/login")},2e3);return}if(r.data.status==="pending"){s("verifying"),a("Payment is being processed. Please wait...");return}s("error"),a(r.data.message||"Payment failed")}catch{s("error"),a("Unable to verify payment. Please contact support.")}})()},[t]),e.jsxs(d,{sx:{minHeight:"100vh",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",gap:3,p:3,bgcolor:"#f9fafc"},children:[i==="verifying"&&e.jsx(m,{size:60,sx:{color:"#c62828"}}),i==="success"&&e.jsx(d,{sx:{fontSize:80},children:"âœ…"}),i==="error"&&e.jsx(v,{severity:"error",sx:{maxWidth:600},children:l}),e.jsx(c,{variant:"h5",fontWeight:600,textAlign:"center",children:l}),i==="verifying"&&e.jsx(c,{variant:"body2",color:"text.secondary",textAlign:"center",children:"Please do not close this page. This usually takes 5-10 seconds..."}),t&&e.jsxs(c,{variant:"caption",color:"text.secondary",sx:{mt:2,opacity:.6},children:["Order ID: ",t]})]})}export{P as default};
