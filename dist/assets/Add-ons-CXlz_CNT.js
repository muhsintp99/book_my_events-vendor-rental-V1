import{c as w,j as e,r as o,h as S,a8 as xe,H as p,B as n,q,T as a,a5 as J,S as g,bc as pe,x as X,G as d,p as y,N as j,s as I,a as P,aL as he,b as re,g as se,t as K,ap as ue,D as ge,a4 as c,a9 as me,bd as fe}from"./index-DkD_OfQp.js";import{L as B}from"./LocalOffer-gqh8rI-k.js";import{E as Q}from"./Edit-MuZwNZ-d.js";import{C as L}from"./CurrencyRupee-BbKeRB-4.js";import{I as be}from"./Image-CxNtUiWn.js";import{C as je}from"./CloudUpload-g3989BZJ.js";const T=w(e.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m5 11h-4v4h-2v-4H7v-2h4V7h2v4h4z"})),Z=w(e.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m5 11H7v-2h10z"})),ye=w(e.jsx("path",{d:"M17 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V7zm-5 16c-1.66 0-3-1.34-3-3s1.34-3 3-3 3 1.34 3 3-1.34 3-3 3m3-10H5V5h10z"})),ve=w(e.jsx("path",{d:"M5 4v3h5.5v12h3V7H19V4z"})),Ce=p(me)(({theme:s})=>({background:"linear-gradient(135deg, #ffffff 0%, #f8faff 100%)",borderRadius:32,border:"1px solid",borderColor:c(s.palette.primary.main,.08),boxShadow:"0 20px 40px rgba(0,0,0,0.04)",overflow:"hidden",position:"relative","&::before":{content:'""',position:"absolute",top:0,left:0,right:0,height:6,background:"linear-gradient(90deg, #FF9A9E 0%, #FAD0C4 100%)"}})),Se=p(fe.div)(({theme:s})=>({background:"rgba(255, 255, 255, 0.7)",backdropFilter:"blur(10px)",borderRadius:24,border:"1px solid rgba(255, 255, 255, 0.3)",boxShadow:"0 10px 30px rgba(0,0,0,0.05)",padding:s.spacing(3),height:"100%",transition:"all 0.4s cubic-bezier(0.4, 0, 0.2, 1)",cursor:"default",position:"relative",overflow:"hidden",display:"flex",flexDirection:"column","&:hover":{transform:"translateY(-8px)",boxShadow:"0 20px 40px rgba(255, 154, 158, 0.15)",borderColor:c("#FF9A9E",.2)}})),Ie=p(n)(({theme:s})=>({width:64,height:64,borderRadius:20,background:"linear-gradient(135deg, #fff 0%, #f0f4f8 100%)",display:"flex",alignItems:"center",justifyContent:"center",boxShadow:"inset 0 2px 4px rgba(0,0,0,0.05), 0 10px 20px rgba(0,0,0,0.05)",marginBottom:s.spacing(2),transition:"transform 0.3s ease","& img":{width:"70%",height:"70%",objectFit:"contain"}})),ee=p(re)(({theme:s,variant:l})=>({backgroundColor:l==="delete"?c(s.palette.error.main,.05):c(s.palette.primary.main,.05),color:l==="delete"?s.palette.error.main:s.palette.primary.main,margin:s.spacing(0,.5),"&:hover":{backgroundColor:l==="delete"?s.palette.error.main:s.palette.primary.main,color:"#fff",transform:"scale(1.1)"},transition:"all 0.2s ease"})),we=p(n)(({theme:s})=>({border:"2px dashed #e0e0e0",borderRadius:16,padding:s.spacing(4),textAlign:"center",backgroundColor:"#fafafa",transition:"all 0.3s ease",cursor:"pointer","&:hover":{borderColor:"#FF9A9E",backgroundColor:"#fff9f9"}})),Ae=p(y)(({theme:s})=>({borderRadius:12,border:"1px solid #f0f0f0",transition:"all 0.2s ease","&:hover":{borderColor:"#FF9A9E",boxShadow:"0 4px 12px rgba(255, 154, 158, 0.1)"}})),O=p(se)(({theme:s})=>({borderRadius:16,textTransform:"none",fontWeight:700,padding:s.spacing(1.8,4),fontSize:"1rem",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",letterSpacing:"0.5px",boxShadow:"0 8px 16px rgba(0,0,0,0.05)","&:hover":{transform:"translateY(-2px)",boxShadow:"0 12px 24px rgba(0,0,0,0.1)"},"&:active":{transform:"translateY(0)"}})),ke=p(O,{shouldForwardProp:s=>s!=="$isEditing"})(({theme:s,$isEditing:l})=>({background:l?"linear-gradient(135deg, #667eea 0%, #764ba2 100%)":"linear-gradient(135deg, #1e3c72 0%, #2a5298 100%)",color:"#fff",border:"none",minWidth:260,fontSize:"1.05rem",padding:s.spacing(2,6),boxShadow:"0 10px 20px rgba(30, 60, 114, 0.2)","&:hover":{background:l?"linear-gradient(135deg, #5a6fd6 0%, #6a4491 100%)":"linear-gradient(135deg, #2a5298 0%, #1e3c72 100%)",boxShadow:"0 15px 30px rgba(30, 60, 114, 0.3)",transform:"translateY(-3px)"},"&:disabled":{background:"#e0e0e0",color:"#9e9e9e"}})),Pe=()=>{const[s,l]=o.useState([{id:1,name:"",price:""}]),[v,A]=o.useState(""),[H,k]=o.useState(""),[M,z]=o.useState(null),[N,F]=o.useState(null),[te,R]=o.useState(!1),[C,W]=o.useState([]),[m,f]=o.useState(!1),[U,x]=o.useState(null),[b,ie]=o.useState(null),[h,$]=o.useState(null);o.useEffect(()=>{const r=localStorage.getItem("user");if(console.log("User Data from LocalStorage:",r),r)try{const i=JSON.parse(r),t=i._id||i.id||i.providerId||i.vendorId;console.log("Determined Provider ID:",t),t&&t!=="null"&&t!=="undefined"?ie(t):(console.warn("No valid ID found in user object"),x("Could not identify vendor session. Login again."))}catch(i){console.error("Error parsing session data:",i),x("Session corrupted. Please login again.")}else console.warn("No user data found in localStorage"),x("You must be logged in to manage add-ons.")},[]),o.useEffect(()=>{b&&D()},[b]);const D=async()=>{try{f(!0);const r=await S.get(`https://api.bookmyevent.ae/api/cake-addons/provider/${b}`);console.log("API Response for Addons:",r.data),r.data.success?W(r.data.data||[]):W([])}catch(r){console.error("Fetch error:",r),x("Failed to fetch existing addons"),W([])}finally{f(!1)}},ne=()=>{l([...s,{id:Date.now(),name:"",price:""}])},ae=r=>{s.length>1&&l(s.filter(i=>i.id!==r))},G=(r,i,t)=>{l(s.map(u=>u.id===r?{...u,[i]:t}:u))},oe=r=>{var t;const i=(t=r.target.files)==null?void 0:t[0];i&&(F(i),z(URL.createObjectURL(i)))},le=async()=>{var r,i;if(!v){x("Title is required");return}if(!b){x("Provider ID not found. Please login again.");return}try{f(!0),x(null);const t=new FormData;t.append("title",v),t.append("description",H),t.append("provider",b);const u=s.map(_=>({name:_.name,price:parseFloat(_.price)||0}));t.append("priceList",JSON.stringify(u)),N&&t.append("icon",N);let E;h?E=await S.put(`https://api.bookmyevent.ae/api/cake-addons/${h}`,t):E=await S.post("https://api.bookmyevent.ae/api/cake-addons",t),E.data.success&&(R(!0),Y(),D(),setTimeout(()=>R(!1),3e3))}catch(t){console.error("Save error:",t),x(((i=(r=t.response)==null?void 0:r.data)==null?void 0:i.message)||"Failed to save addon")}finally{f(!1)}},de=r=>{$(r._id),A(r.title),k(r.description||""),z(r.icon),F(null),l(r.priceList.map((i,t)=>({id:t,name:i.name,price:i.price.toString()}))),window.scrollTo({top:0,behavior:"smooth"})},ce=async r=>{if(window.confirm("Are you sure you want to delete this addon group?"))try{f(!0),(await S.delete(`https://api.bookmyevent.ae/api/cake-addons/${r}`)).data.success&&D()}catch(i){console.error("Delete error:",i),x("Failed to delete addon")}finally{f(!1)}},Y=()=>{$(null),A(""),k(""),z(null),F(null),l([{id:1,name:"",price:""}])},V=()=>s.reduce((r,i)=>{const t=parseFloat(i.price)||0;return r+t},0).toFixed(2);return e.jsx(xe,{maxWidth:"lg",sx:{pt:2,pb:3},children:e.jsxs(Ce,{sx:{p:{xs:3,md:5}},children:[e.jsxs(n,{sx:{mb:2},children:[e.jsxs(n,{sx:{display:"flex",alignItems:"center",gap:2,mb:1},children:[e.jsx(q,{sx:{bgcolor:"primary.main",width:48,height:48},children:e.jsx(B,{fontSize:"medium"})}),e.jsxs(n,{children:[e.jsx(a,{variant:"h4",fontWeight:800,gutterBottom:!0,children:"Cake Add-ons Manager"}),e.jsx(a,{variant:"body1",color:"text.secondary",children:"Create beautiful add-ons with pricing, descriptions, and images"})]})]}),e.jsx(J,{label:`${s.length} add-on${s.length!==1?"s":""}`,color:"primary",variant:"outlined",sx:{mt:1}})]}),e.jsxs(g,{spacing:2,sx:{mb:3},children:[e.jsx(pe,{in:te,children:e.jsx(X,{severity:"success",sx:{borderRadius:2},onClose:()=>R(!1),children:"Add-ons saved successfully!"})}),U&&e.jsx(X,{severity:"error",sx:{borderRadius:2},onClose:()=>x(null),children:U})]}),e.jsxs(d,{container:!0,spacing:2.5,children:[e.jsxs(d,{size:{xs:12,md:8},children:[e.jsx(y,{sx:{mb:4,borderRadius:3},children:e.jsxs(j,{children:[e.jsxs(n,{sx:{display:"flex",alignItems:"center",mb:3},children:[e.jsx(ve,{color:"primary",sx:{mr:2}}),e.jsx(a,{variant:"h6",fontWeight:600,children:"Basic Information"})]}),e.jsxs(g,{spacing:3,children:[e.jsx(I,{fullWidth:!0,label:"Add-ons Title",placeholder:"Premium Frosting & Decoration Options",value:v,onChange:r=>A(r.target.value),InputProps:{startAdornment:e.jsx(P,{position:"start",children:e.jsx(Q,{fontSize:"small"})})},sx:{"& .MuiOutlinedInput-root":{borderRadius:2}}}),e.jsx(I,{fullWidth:!0,multiline:!0,rows:3,label:"Description",placeholder:"Describe what makes these add-ons special...",value:H,onChange:r=>k(r.target.value),InputProps:{startAdornment:e.jsx(P,{position:"start",children:e.jsx(he,{fontSize:"small"})})},sx:{"& .MuiOutlinedInput-root":{borderRadius:2}}})]})]})}),e.jsx(y,{sx:{mb:4,borderRadius:3},children:e.jsxs(j,{children:[e.jsxs(n,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3},children:[e.jsxs(n,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(L,{color:"primary",sx:{mr:2}}),e.jsx(a,{variant:"h6",fontWeight:600,children:"Add-ons Pricing"})]}),e.jsx(J,{label:`Total: ₹${V()}`,color:"primary",icon:e.jsx(L,{}),variant:"filled"})]}),e.jsx(g,{spacing:2,children:s.map((r,i)=>e.jsx(Ae,{children:e.jsx(j,{children:e.jsxs(d,{container:!0,spacing:2,alignItems:"center",children:[e.jsx(d,{size:{xs:12,sm:5},children:e.jsx(I,{fullWidth:!0,label:"Add-on Name",placeholder:"Chocolate Ganache Drizzle",value:r.name,onChange:t=>G(r.id,"name",t.target.value),size:"small",sx:{"& .MuiOutlinedInput-root":{borderRadius:1}}})}),e.jsx(d,{size:{xs:8,sm:5},children:e.jsx(I,{fullWidth:!0,label:"Price",placeholder:"9.99",value:r.price,onChange:t=>G(r.id,"price",t.target.value),size:"small",InputProps:{startAdornment:e.jsx(P,{position:"start",children:e.jsx(L,{fontSize:"small"})})},sx:{"& .MuiOutlinedInput-root":{borderRadius:1}}})}),e.jsx(d,{size:{xs:4,sm:2},children:e.jsx(n,{sx:{display:"flex",justifyContent:"flex-end"},children:e.jsx(re,{color:"error",onClick:()=>ae(r.id),disabled:s.length===1,size:"small",children:e.jsx(Z,{})})})})]})})},r.id))}),e.jsx(O,{startIcon:e.jsx(T,{}),onClick:ne,variant:"outlined",color:"primary",fullWidth:!0,sx:{mt:3},disabled:m,children:"Add New Add-on Row"})]})})]}),e.jsxs(d,{size:{xs:12,md:4},children:[e.jsx(y,{xs:12,sx:{mb:4,borderRadius:3},children:e.jsxs(j,{children:[e.jsxs(n,{sx:{display:"flex",alignItems:"center",mb:3},children:[e.jsx(be,{color:"primary",sx:{mr:2}}),e.jsx(a,{variant:"h6",fontWeight:600,children:"Add-on Icon"})]}),e.jsxs(we,{onClick:()=>{var r;return(r=document.getElementById("icon-upload"))==null?void 0:r.click()},children:[e.jsx("input",{id:"icon-upload",hidden:!0,type:"file",accept:"image/svg+xml,image/png",onChange:oe}),M?e.jsxs(g,{spacing:2,alignItems:"center",children:[e.jsx(q,{src:M,sx:{width:80,height:80,bgcolor:"grey.100"}}),e.jsx(se,{variant:"outlined",startIcon:e.jsx(je,{}),size:"small",children:"Change Icon"})]}):e.jsxs(g,{spacing:1.5,alignItems:"center",children:[e.jsx(T,{sx:{fontSize:56,color:"text.secondary"}}),e.jsx(a,{variant:"body1",children:"Upload an add-on icon"}),e.jsx(a,{variant:"body2",color:"text.secondary",children:"SVG or PNG (icon style)"})]})]})]})}),e.jsx(y,{sx:{borderRadius:3,border:"2px solid",borderColor:"primary.light"},children:e.jsxs(j,{children:[e.jsx(a,{variant:"h6",fontWeight:600,gutterBottom:!0,children:"Preview"}),e.jsxs(n,{sx:{mb:3},children:[e.jsx(a,{variant:"subtitle2",color:"text.secondary",gutterBottom:!0,children:"Title"}),e.jsx(a,{variant:"body1",children:v||"Your add-ons title will appear here"})]}),e.jsxs(n,{sx:{mb:3},children:[e.jsx(a,{variant:"subtitle2",color:"text.secondary",gutterBottom:!0,children:"Add-ons List"}),e.jsx(g,{spacing:1,children:s.map((r,i)=>e.jsxs(n,{sx:{display:"flex",justifyContent:"space-between",p:1,borderRadius:1,bgcolor:"grey.50"},children:[e.jsx(a,{variant:"body2",children:r.name||"Add-on name"}),e.jsx(a,{variant:"body2",fontWeight:600,children:r.price?`₹${r.price}`:"₹0.00"})]},i))})]}),e.jsx(n,{sx:{pt:2,borderTop:1,borderColor:"divider"},children:e.jsxs(n,{sx:{display:"flex",justifyContent:"space-between",mb:2},children:[e.jsx(a,{variant:"body1",fontWeight:600,children:"Total"}),e.jsxs(a,{variant:"body1",fontWeight:700,color:"primary",children:["₹",V()]})]})})]})})]})]}),e.jsxs(n,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mt:4,pt:3,borderTop:1,borderColor:"divider"},children:[e.jsx(a,{variant:"body2",color:"text.secondary",children:"All changes are auto-saved locally"}),e.jsxs(n,{sx:{display:"flex",gap:2},children:[e.jsx(O,{variant:"outlined",color:h?"error":"inherit",onClick:Y,disabled:m,startIcon:h?e.jsx(Z,{}):e.jsx(T,{}),children:h?"Cancel Update":"Reset Form"}),e.jsx(ke,{variant:"contained",$isEditing:!!h,startIcon:m?e.jsx(K,{size:24,color:"inherit"}):e.jsx(ye,{}),onClick:le,disabled:m,fullWidth:!1,sx:{minWidth:200},children:m?"Processing...":h?"Update Add-ons":"Save Add-ons"})]})]}),e.jsxs(n,{sx:{mt:8},children:[e.jsxs(n,{sx:{display:"flex",alignItems:"center",mb:4},children:[e.jsx(n,{sx:{width:40,height:4,bgcolor:"primary.main",borderRadius:2,mr:2}}),e.jsx(a,{variant:"h4",fontWeight:800,children:"Existing Add-on Library"})]}),e.jsx(d,{container:!0,spacing:4,children:m?e.jsx(d,{size:12,children:e.jsxs(n,{sx:{display:"flex",flexDirection:"column",alignItems:"center",py:10,gap:2},children:[e.jsx(K,{size:56,thickness:4,color:"primary"}),e.jsx(a,{variant:"h6",color:"text.secondary",fontWeight:600,children:"Loading your premium library..."})]})}):C&&Array.isArray(C)&&C.length>0?C.map((r,i)=>e.jsx(d,{size:{xs:12,sm:6,md:4},children:e.jsxs(Se,{children:[e.jsxs(n,{sx:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",mb:2},children:[e.jsx(Ie,{children:r.icon?e.jsx(n,{component:"img",src:r.icon,alt:r.title,sx:{width:"80%",height:"80%",objectFit:"contain"}}):e.jsx(B,{sx:{color:"primary.light",fontSize:32}})}),e.jsxs(n,{sx:{display:"flex",gap:1},children:[e.jsx(ee,{size:"small",onClick:()=>de(r),children:e.jsx(Q,{fontSize:"small"})}),e.jsx(ee,{size:"small",variant:"delete",onClick:()=>ce(r._id),children:e.jsx(ue,{fontSize:"small"})})]})]}),e.jsx(a,{variant:"h5",fontWeight:800,sx:{mb:1,color:"#1a2027",letterSpacing:"-0.025em"},children:r.title}),e.jsx(a,{variant:"body2",color:"text.secondary",sx:{mb:3,lineHeight:1.7,minHeight:"5.1em",maxHeight:"5.1em",overflow:"hidden",display:"-webkit-box",WebkitLineClamp:3,WebkitBoxOrient:"vertical",fontSize:"0.9rem"},children:r.description||"Professional addon collection for bespoke event cakes."}),e.jsxs(n,{sx:{mt:"auto"},children:[e.jsx(ge,{sx:{mb:2,borderColor:c("#000",.04)}}),e.jsx(g,{spacing:1.2,children:r.priceList&&r.priceList.map((t,u)=>e.jsxs(n,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",p:1.5,borderRadius:2,bgcolor:c("#FF9A9E",.04),border:"1px solid",borderColor:c("#FF9A9E",.1),transition:"all 0.2s ease","&:hover":{transform:"translateX(5px)",bgcolor:c("#FF9A9E",.08)}},children:[e.jsx(a,{variant:"body2",fontWeight:700,sx:{color:"#2d3748"},children:t.name}),e.jsxs(a,{variant:"body2",fontWeight:800,color:"primary.main",children:["₹",t.price]})]},u))})]})]})},r._id||`addon-${i}`)):e.jsx(d,{size:12,children:e.jsxs(n,{sx:{py:12,textAlign:"center",bgcolor:c("#f8fafc",.8),borderRadius:12,border:"2px dashed",borderColor:c("#cbd5e0",1),display:"flex",flexDirection:"column",alignItems:"center"},children:[e.jsx(n,{sx:{width:80,height:80,borderRadius:"50%",bgcolor:c("#FF9A9E",.1),display:"flex",alignItems:"center",justifyContent:"center",mb:2},children:e.jsx(B,{sx:{fontSize:40,color:"#FF9A9E"}})}),e.jsx(a,{variant:"h5",color:"text.primary",fontWeight:800,gutterBottom:!0,children:"No Add-ons found"}),e.jsx(a,{variant:"body1",color:"text.secondary",sx:{maxWidth:460},children:"Your premium cake library is empty. Please add some premium add-ons using the form above."})]})})})]})]})})};export{Pe as default};
