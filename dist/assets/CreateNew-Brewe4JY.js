import{u as lr,i as dr,aj as cr,w as ur,ai as hr,r as s,h as O,j as e,B as n,b as Ke,ak as gr,T as i,t as Ba,p as N,W as ee,s as x,am as pr,S as U,F as f,I as E,ag as w,$ as l,at as le,f as y,an as F,C as de,G as Ue,al as xr,g as ce,ao as fr,x as mr}from"./index-CEV33QsJ.js";import{D as br}from"./DirectionsCar-pIEKgYwQ.js";import{C as Ut}from"./CloudUpload-DHrE0br_.js";const Gt=pr(n)(({theme:h})=>({border:"2px dashed #e0e0e0",borderRadius:h.shape.borderRadius,padding:h.spacing(3),textAlign:"center",backgroundColor:h.palette.grey[50],cursor:"pointer",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:"150px","&:hover":{borderColor:h.palette.primary.main},'& input[type="file"]':{display:"none"}})),Fr=()=>{const h=lr(),T=dr(h.breakpoints.down("md")),te=cr(),Ge=ur(),{id:ue}=hr(),Ze=s.useRef(null),k=s.useRef(null),qe=s.useRef(null),[Ce,Je]=s.useState(""),[Se,Zt]=s.useState(""),[Ye,qt]=s.useState(""),[Xe,Jt]=s.useState(""),[Qe,Yt]=s.useState(""),[et,Xt]=s.useState(""),[we,tt]=s.useState("normal"),[he,at]=s.useState(""),[rt,Qt]=s.useState("no"),[Fa,za]=s.useState("no"),[ea,Ma]=s.useState(""),[ke,ta]=s.useState(""),[st,aa]=s.useState(""),[nt,ra]=s.useState(""),[it,sa]=s.useState(""),[ot,na]=s.useState(""),[lt,ia]=s.useState(""),[dt,oa]=s.useState(""),[ct,la]=s.useState(""),[v,da]=s.useState({leatherSeats:!1,adjustableSeats:!1,armrest:!1,musicSystem:!1,bluetooth:!1,usbAux:!1,airbags:!1,abs:!1,rearCamera:!1,parkingSensors:!1,powerWindows:!1,centralLock:!1,keylessEntry:!1,wifi:!1,chargingPoints:!1}),[W,ca]=s.useState({curtains:!1,readingLights:!1,musicSystem:!1,microphone:!1,fireExtinguisher:!1,firstAidKit:!1,luggageCarrier:!1,wifi:!1,chargingPoints:!1}),P="https://api.bookmyevent.ae/api",ut="AIzaSyAfLUm1kPmeMkHh1Hr5nbgNpQJOsNa7B78",ae=localStorage.getItem("moduleId");s.useMemo(()=>{var t;return(t=te.state)==null?void 0:t.vehicle},[te.state]);const ua=s.useMemo(()=>{var t,a;return(a=(t=te.state)==null?void 0:t.vehicle)==null?void 0:a._id},[te.state]),ge=s.useMemo(()=>{var t,a;return ue||((a=(t=te.state)==null?void 0:t.vehicle)==null?void 0:a._id)||""},[ue,ua]),Ra=s.useMemo(()=>ge?"edit":"create",[ge]),[pe,ht]=s.useState(Ra),[Ae,gt]=s.useState(""),[ha,pt]=s.useState(""),[X,xt]=s.useState(null),[G,Ee]=s.useState([]),[Pe,ft]=s.useState(""),[Ie,mt]=s.useState(""),[La,ga]=s.useState(""),[Te,bt]=s.useState(""),[xe,jt]=s.useState(""),[We,yt]=s.useState(""),[fe,me]=s.useState("yes"),[be,vt]=s.useState(""),[pa,Ct]=s.useState(""),[_,xa]=s.useState("hourly"),[St,fa]=s.useState(""),[wt,ma]=s.useState(""),[kt,ba]=s.useState(""),[Be,At]=s.useState(""),[z,je]=s.useState({driverIncluded:!1,sunroof:!1,decorationAvailable:!1}),[re,Et]=s.useState(""),[M,Z]=s.useState([{heading:"",points:[""]}]),[Pt,Fe]=s.useState([]),[ze,It]=s.useState(""),[Da,m]=s.useState(!1),[_a,C]=s.useState(""),[ja,S]=s.useState("success"),[Tt,Wt]=s.useState([]),[Bt,ya]=s.useState([]),[$a,Va]=s.useState([]),[Ft,Oa]=s.useState({}),[jr,yr]=s.useState(""),[vr,Cr]=s.useState(""),[Sr,wr]=s.useState(""),[kr,Ar]=s.useState(""),[Er,Pr]=s.useState(""),[zt,Na]=s.useState(""),[Ir,Ha]=s.useState({}),[va,Mt]=s.useState([]),[$,Rt]=s.useState([]),[Ka,Q]=s.useState([]),[I,Me]=s.useState(""),[Re,ye]=s.useState(""),Lt=!!I,[se,Dt]=s.useState([]),[_t,Ca]=s.useState(!1),[Le,B]=s.useState(!1),[De,$t]=s.useState(""),[ve,Vt]=s.useState([]),[_e,ne]=s.useState(""),[R,ie]=s.useState(""),[L,oe]=s.useState(""),[$e,Ot]=s.useState(""),[H,Sa]=s.useState(!1),[b,wa]=s.useState(null),K=s.useMemo(()=>{var a;if(!I||!$.length)return!1;const t=$.find(o=>o._id===I);return console.log("Category check (Bus):",t==null?void 0:t.title),(a=t==null?void 0:t.title)==null?void 0:a.toLowerCase().includes("bus")},[I,$]),Ve=s.useMemo(()=>{var a,o;if(!I||!$.length)return!1;const t=$.find(r=>r._id===I);return console.log("Category check (Car):",t==null?void 0:t.title),((a=t==null?void 0:t.title)==null?void 0:a.toLowerCase().includes("car"))||((o=t==null?void 0:t.title)==null?void 0:o.toLowerCase().includes("vehicle"))},[I,$]),Ua=t=>{const a=Array.from(t.target.files);Mt(o=>[...o,...a])},Ga=t=>{t.preventDefault();const a=Array.from(t.dataTransfer.files);Mt(o=>[...o,...a])};s.useEffect(()=>{if(window.google&&window.google.maps){Sa(!0);return}const t=document.createElement("script");return t.src=`https://maps.googleapis.com/maps/api/js?key=${ut}&libraries=places`,t.async=!0,t.defer=!0,t.onload=()=>{Sa(!0)},document.head.appendChild(t),()=>{document.head.contains(t)&&document.head.removeChild(t)}},[ut]),s.useEffect(()=>{H&&window.google&&window.google.maps&&Za()},[H]);const Za=s.useCallback(()=>{if(!window.google||!Ze.current||!H)return;const t=R&&L?parseFloat(R):20.5937,a=R&&L?parseFloat(L):78.9629,o={lat:t,lng:a},r=new window.google.maps.Map(Ze.current,{zoom:12,center:o});r.addListener("click",d=>{const p=d.latLng.lat(),c=d.latLng.lng();ie(p.toString()),oe(c.toString()),k.current&&k.current.setMap(null),k.current=new window.google.maps.Marker({position:{lat:p,lng:c},map:r}),new window.google.maps.Geocoder().geocode({location:{lat:p,lng:c}},(D,V)=>{V==="OK"&&D[0]?(ne(D[0].formatted_address),C("Location set and address auto-filled!"),S("success"),m(!0)):(C("Location set, but could not determine address."),S("info"),m(!0))})}),wa(r)},[H,R,L]);s.useEffect(()=>{if(!H||!b||!qe.current||!window.google)return;const t=new window.google.maps.places.Autocomplete(qe.current,{fields:["place_id","geometry","name","formatted_address"]}),a=t.addListener("place_changed",()=>{const o=t.getPlace();if(!o.geometry||!o.geometry.location)return;const r=o.geometry.location;o.geometry.viewport?b.fitBounds(o.geometry.viewport):(b.setCenter(r),b.setZoom(17)),k.current&&k.current.setMap(null),k.current=new window.google.maps.Marker({position:r,map:b}),ie(r.lat().toString()),oe(r.lng().toString()),ne(o.formatted_address||o.name),C("Location selected!"),S("success"),m(!0)});return()=>{window.google&&window.google.maps.event&&window.google.maps.event.removeListener(a)}},[H,b]),s.useEffect(()=>{if(!b||!R||!L)return;const t={lat:parseFloat(R),lng:parseFloat(L)};b.setCenter(t),b.setZoom(12),k.current?k.current.setPosition(t):k.current=new window.google.maps.Marker({position:t,map:b})},[R,L,b]),s.useEffect(()=>{if(!xe||!H||!window.google||!window.google.maps)return;new window.google.maps.Geocoder().geocode({address:xe},(a,o)=>{if(o==="OK"&&a[0]){const r=a[0].geometry.location,d=r.lat().toString(),p=r.lng().toString();ie(d),oe(p),ne(a[0].formatted_address),b&&(b.setCenter({lat:r.lat(),lng:r.lng()}),b.setZoom(12),k.current&&k.current.setMap(null),k.current=new window.google.maps.Marker({position:{lat:r.lat(),lng:r.lng()},map:b})),C(`Location set for ${xe}!`),S("success"),m(!0)}else C(`Could not find location for ${xe}`),S("warning"),m(!0)})},[xe,H,b]);const Oe=s.useCallback(t=>{var d,p,c,A,D,V,q,J,Y,u,j,He,Ea,Pa,Ia,Ta,Wa;if(console.log("Setting vehicle data:",t),t.brand&&t.brand._id&&!Tt.some(g=>g._id===t.brand._id)&&Wt(g=>[...g,{_id:t.brand._id,title:t.brand.title||t.brand.name||"Unknown Brand"}]),Na(((d=t.advanceBookingAmount)==null?void 0:d.toString())||""),(c=(p=t.category)==null?void 0:p.parentCategory)!=null&&c._id){const g=t.category.parentCategory._id;Me(g),ye(t.category._id),O.get(`${P}/categories/parents/${g}/subcategories`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}}).then(or=>Q(or.data.data||[])).catch(()=>Q([]))}t.termsAndConditions&&Array.isArray(t.termsAndConditions)&&t.termsAndConditions.length>0?Z(t.termsAndConditions.map(g=>({heading:g.heading||"",points:Array.isArray(g.points)&&g.points.length>0?g.points:[""]}))):Z([{heading:"",points:[""]}]);let a="";Array.isArray(t.category)&&t.category.length>0?(a=t.category[0]._id,Bt.some(g=>g._id===a)||ya(g=>[...g,{_id:a,title:t.category[0].title||"Unknown Category"}])):t.category&&typeof t.category=="object"&&t.category._id?(a=t.category._id,Bt.some(g=>g._id===a)||ya(g=>[...g,{_id:a,title:t.category.title||"Unknown Category"}])):typeof t.category=="string"&&(a=t.category),t.zone&&t.zone._id&&!se.some(g=>g._id===t.zone._id)&&Dt(g=>[...g,{_id:t.zone._id,name:t.zone.name||"Unknown Zone"}]),gt(t.name||""),pt(t.description||""),ft(((A=t.brand)==null?void 0:A._id)||""),ga(a),console.log("Category ID being set:",a);const o=((D=t.zone)==null?void 0:D._id)||"";bt(o);const r=se.find(g=>g._id===o)||t.zone&&{name:t.zone.name};jt(r?r.name:""),mt(t.model||""),yt(((V=t.seatingCapacity)==null?void 0:V.toString())||""),me(t.airCondition?"yes":"no"),vt(t.licensePlateNumber||""),Fe(t.searchTags||[]),ne(t.venueAddress||""),ie(((q=t.latitude)==null?void 0:q.toString())||""),oe(((J=t.longitude)==null?void 0:J.toString())||""),Ot(t.operatingHours||""),console.log("Operating hours being set:",t.operatingHours),t.pricing&&(xa(t.pricing.type||"hourly"),fa(((Y=t.pricing.hourly)==null?void 0:Y.toString())||""),ma(((u=t.pricing.perDay)==null?void 0:u.toString())||""),ba(((j=t.pricing.distanceWise)==null?void 0:j.toString())||"")),At(((He=t.discount)==null?void 0:He.toString())||""),je({driverIncluded:((Ea=t.features)==null?void 0:Ea.driverIncluded)??!1,sunroof:((Pa=t.features)==null?void 0:Pa.sunroof)??!1,decorationAvailable:((Ia=t.features)==null?void 0:Ia.decorationAvailable)??!1}),Et(((Wa=(Ta=t.features)==null?void 0:Ta.decorationPrice)==null?void 0:Wa.toString())||"")},[Tt,Bt,se]);s.useEffect(()=>()=>{G.forEach(t=>URL.revokeObjectURL(t))},[G]),s.useEffect(()=>{(async()=>{var a,o,r,d,p;try{if(!ae)throw new Error("Module ID is not defined. Please log in or set moduleId in localStorage.");const c=localStorage.getItem("token"),[A,D,V]=await Promise.all([O.get(`${P}/brands/module/${ae}`,{headers:{Authorization:`Bearer ${c}`}}),O.get(`${P}/categories/parents/${ae}`,{headers:{Authorization:`Bearer ${c}`}}),O.get(`${P}/zones`,{headers:{Authorization:`Bearer ${c}`,Accept:"application/json"}})]);Rt(((a=D.data)==null?void 0:a.data)||[]);const q=Array.isArray(A.data)?A.data:A.data.data||[];Wt(q);const J=((o=D.data)==null?void 0:o.data)||[];Rt(J);const Y=V.data.data||V.data||[],u=Array.isArray(Y)?Y.filter(j=>j.isActive).map(j=>({_id:j._id,name:j.name})):[];Dt(u),console.log("Module ID:",ae),console.log("Brands:",q),console.log("Parent Categories:",J),console.log("Zones:",u),Ca(!0)}catch(c){console.error("Error fetching brands/categories/zones:",((r=c.response)==null?void 0:r.data)||c),Wt([]),Rt([]),Dt([]),Ca(!0),C(((p=(d=c.response)==null?void 0:d.data)==null?void 0:p.message)||"Failed to fetch brands, categories, or zones"),S("error"),m(!0)}})()},[ae,P]),s.useEffect(()=>{if($.length>0&&!I&&pe==="create"){const t=$[0];Me(t._id),O.get(`${P}/categories/parents/${t._id}/subcategories`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}}).then(a=>{const o=a.data.data||[];Q(o),o.length>0&&ye(o[0]._id)}).catch(a=>{console.error("Failed to fetch subcategories:",a),Q([])})}},[$,I,pe,P]),s.useEffect(()=>{(async()=>{var a;try{const d=(((a=(await O.get(`${P}/vehicle-attributes`)).data)==null?void 0:a.data)||[]).filter(c=>c.status),p={};d.forEach(c=>{p[c.title.toLowerCase()]=c.values||[]}),Va(d),Ha(p),console.log("âœ… Vehicle Attributes Loaded:",d)}catch(o){console.error("âŒ Failed to load vehicle attributes",o)}})()},[P]),s.useEffect(()=>{var a;if(!_t)return;const t=(a=te.state)==null?void 0:a.vehicle;t?(Oe(t),$t(t.thumbnail||""),Vt(t.images||[]),ht("edit")):ue&&(async()=>{var r,d,p;B(!0);try{const c=await O.get(`${P}/vehicles/${ue}`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}}),A=c.data.data||c.data;console.log("Vehicle data fetched for edit:",A),Oe(A),$t(A.thumbnail||""),Vt(A.images||[]),ht("edit")}catch(c){C(((d=(r=c.response)==null?void 0:r.data)==null?void 0:d.message)||"Failed to fetch vehicle data"),S("error"),m(!0),console.error("Error fetching vehicle:",((p=c.response)==null?void 0:p.data)||c)}finally{B(!1)}})()},[_t,ue,Oe]);const qa=async t=>{const a=t.target.value;if(Me(a),ye(""),Q([]),!!a)try{const o=await O.get(`${P}/categories/parents/${a}/subcategories`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});Q(o.data.data||[])}catch(o){console.error("Failed to fetch sub categories",o),Q([])}},Ja=s.useCallback(t=>{const a=t.target.files[0];a&&xt(a)},[]),ka=s.useCallback(t=>{t.preventDefault()},[]),Ya=s.useCallback(t=>{t.preventDefault();const a=t.dataTransfer.files[0];a&&xt(a)},[]),Xa=s.useCallback(t=>{const a=Array.from(t.target.files);Ee(o=>[...o,...a])},[]),Qa=s.useCallback(t=>{t.preventDefault();const a=Array.from(t.dataTransfer.files);Ee(o=>[...o,...a])},[]),er=s.useCallback(t=>{It(t.target.value)},[]),tr=(t,a)=>{Oa(o=>({...o,[t]:a}))},ar=s.useCallback(t=>{t.key==="Enter"&&ze.trim()&&(Fe(a=>[...a,ze.trim()]),It(""),t.preventDefault())},[ze]),rr=s.useCallback(t=>{Fe(a=>a.filter(o=>o!==t))},[]),Nt=s.useCallback(t=>/^[A-Z0-9]{6,8}$/.test(t)?(Ct(""),!0):(Ct("License plate must be 6-8 alphanumeric characters"),!1),[]),Ht=s.useCallback(()=>{gt(""),pt(""),ne(""),ft(""),mt(""),ga(""),bt(""),jt(""),Me(""),ye(""),xt(null),Ee([]),$t(""),Vt([]),yt(""),me("yes"),vt(""),Ct(""),Je(""),Zt(""),qt(""),Jt(""),Yt(""),Xt(""),at(""),Qt("no"),Ma(""),je({driverIncluded:!1,sunroof:!1,decorationAvailable:!1}),da({leatherSeats:!1,adjustableSeats:!1,armrest:!1,musicSystem:!1,bluetooth:!1,usbAux:!1,airbags:!1,abs:!1,rearCamera:!1,parkingSensors:!1,powerWindows:!1,centralLock:!1,keylessEntry:!1,wifi:!1,chargingPoints:!1}),ca({curtains:!1,readingLights:!1,musicSystem:!1,microphone:!1,fireExtinguisher:!1,firstAidKit:!1,luggageCarrier:!1,wifi:!1,chargingPoints:!1}),ta(""),aa(""),ra(""),sa(""),na(""),ia(""),oa(""),la(""),tt("normal"),xa("hourly"),fa(""),ma(""),ba(""),At(""),Et(""),Fe([]),It(""),ie(""),oe(""),Ot(""),ht("create"),k.current&&(k.current.setMap(null),k.current=null),b&&wa(null)},[b]),sr=s.useCallback(async t=>{var p,c,A,D,V,q,J,Y;t.preventDefault();const a=pe==="edit";if(B(!0),!Ae||!Pe||!Ie||!I||!Re||!Te||!We||!be||!_||!_e||!R||!L){C("Please fill all required fields."),S("error"),m(!0),B(!1);return}if(z.decorationAvailable&&(!re||parseFloat(re)<=0)){C("Please provide a valid decoration price when decoration is available."),S("error"),m(!0),B(!1);return}if(_==="hourly"&&!St||_==="perDay"&&!wt||_==="distanceWise"&&!kt){C(`Please provide a price for ${_} trip type.`),S("error"),m(!0),B(!1);return}if(!X&&!De&&!a){C("Please upload a thumbnail image."),S("error"),m(!0),B(!1);return}if(G.length===0&&ve.length===0&&!a){C("Please upload at least one vehicle image."),S("error"),m(!0),B(!1);return}if(!Nt(be)){C("Invalid license plate number."),S("error"),m(!0),B(!1);return}if(!M.length||!M[0].heading){C("Please add at least one Terms & Conditions section."),S("error"),m(!0),B(!1);return}const o=localStorage.getItem("token");if(!o){C("No authentication token found. Please log in."),S("error"),m(!0),B(!1);return}const r=new FormData;r.append("transmissionType",Ce),r.append("enginePower",Se?parseInt(Se):""),r.append("name",Ae),r.append("description",ha),r.append("brand",Pe),r.append("category",I),r.append("subCategories[]",Re),r.append("zone",Te),r.append("model",Ie),r.append("seatingCapacity",parseInt(We)),r.append("airCondition",fe==="yes"),r.append("features[driverIncluded]",z.driverIncluded),r.append("features[sunroof]",z.sunroof),r.append("features[decorationAvailable]",z.decorationAvailable),z.decorationAvailable&&re&&r.append("decorationPrice",parseFloat(re)),Ve&&(r.append("vehicleType",et),r.append("engineCapacity",Ye),r.append("torque",Xe),r.append("mileage",Qe),r.append("fuelType",he),r.append("interiorLighting",we),r.append("carFeatures[leatherSeats]",v.leatherSeats),r.append("carFeatures[adjustableSeats]",v.adjustableSeats),r.append("carFeatures[armrest]",v.armrest),r.append("carFeatures[musicSystem]",v.musicSystem),r.append("carFeatures[bluetooth]",v.bluetooth),r.append("carFeatures[usbAux]",v.usbAux),r.append("carFeatures[airbags]",v.airbags),r.append("carFeatures[abs]",v.abs),r.append("carFeatures[rearCamera]",v.rearCamera),r.append("carFeatures[parkingSensors]",v.parkingSensors),r.append("carFeatures[powerWindows]",v.powerWindows),r.append("carFeatures[centralLock]",v.centralLock),r.append("carFeatures[keylessEntry]",v.keylessEntry),r.append("carFeatures[wifi]",v.wifi),r.append("carFeatures[chargingPoints]",v.chargingPoints),r.append("basicPackagePrice",ke),r.append("hoursIncluded",st),r.append("kmIncluded",nt),r.append("additionalPricePerKm",it),r.append("afterKilometer",ot),r.append("discountType",lt),r.append("advanceType",dt),r.append("advanceAmount",ct)),K&&(r.append("pushbackSeats",rt),r.append("airConditionZone",ea),r.append("fuelType",he),r.append("busFeatures[curtains]",W.curtains),r.append("busFeatures[readingLights]",W.readingLights),r.append("busFeatures[musicSystem]",W.musicSystem),r.append("busFeatures[microphone]",W.microphone),r.append("busFeatures[fireExtinguisher]",W.fireExtinguisher),r.append("busFeatures[firstAidKit]",W.firstAidKit),r.append("busFeatures[luggageCarrier]",W.luggageCarrier),r.append("busFeatures[wifi]",W.wifi),r.append("busFeatures[chargingPoints]",W.chargingPoints)),r.append("attributes",JSON.stringify(Ft)),r.append("licensePlateNumber",be),r.append("termsAndConditions",JSON.stringify(M)),r.append("venueAddress",_e),r.append("latitude",parseFloat(R)),r.append("longitude",parseFloat(L)),$e&&r.append("operatingHours",$e),r.append("pricing[type]",_),r.append("pricing[hourly]",_==="hourly"&&parseFloat(St)||0),r.append("pricing[perDay]",_==="perDay"&&parseFloat(wt)||0),r.append("pricing[distanceWise]",_==="distanceWise"&&parseFloat(kt)||0),Be&&r.append("discount",parseFloat(Be)),zt&&r.append("advanceBookingAmount",parseFloat(zt)),Pt.forEach(u=>r.append("searchTags[]",u)),X&&r.append("thumbnail",X),G.forEach(u=>r.append("images",u));const d={};for(let[u,j]of r.entries())d[u]=j instanceof File?j.name:j;console.log("FormData:",d);try{let u,j;if(a){if(!ge)throw new Error("Invalid vehicle ID for update");u=await O.put(`${P}/vehicles/${ge}`,r,{headers:{Authorization:`Bearer ${o}`,"Content-Type":"multipart/form-data"}}),j=u.data.data||u.data}else u=await O.post(`${P}/vehicles`,r,{headers:{Authorization:`Bearer ${o}`,"Content-Type":"multipart/form-data"}}),j=u.data.data||u.data;console.log("API Response:",u.data),C(a?"Vehicle updated successfully!":"Vehicle added successfully!"),S("success"),m(!0),Ht(),a&&Ge("/vehicle-setup/lists",{state:{vehicle:j}})}catch(u){console.error("API Error:",{status:(p=u.response)==null?void 0:p.status,statusText:(c=u.response)==null?void 0:c.statusText,data:(A=u.response)==null?void 0:A.data,headers:(D=u.response)==null?void 0:D.headers,message:u.message});let j=((q=(V=u.response)==null?void 0:V.data)==null?void 0:q.message)||"Failed to save vehicle";(Y=(J=u.response)==null?void 0:J.data)!=null&&Y.errors&&(j=u.response.data.errors.map(He=>He.msg).join(", ")),C(j),S("error"),m(!0)}finally{B(!1)}},[pe,ge,Ae,Pe,Ie,La,Te,We,fe,z,re,be,_,St,wt,kt,Be,Pt,X,G,De,ve,Nt,Ht,Ge,P,ae,_t,ua,Oe,_e,R,L,$e,I,Re,Ft,zt,M,Ve,K,Ce,Se,Ye,Xe,Qe,et,we,he,rt,ea,v,W,ke,st,nt,it,ot,lt,dt,ct]),Aa=s.useCallback((t,a)=>{a!=="clickaway"&&m(!1)},[]),Ne=pe==="edit",nr=s.useCallback(t=>{const a=t.target.value;bt(a);const o=se.find(r=>r._id===a);jt(o?o.name:"")},[se]),ir=t=>a=>{da(o=>({...o,[t]:a.target.checked}))},Kt=t=>a=>{ca(o=>({...o,[t]:a.target.checked}))};return e.jsxs(n,{sx:{p:T?2:3,backgroundColor:h.palette.grey[100],minHeight:"100vh",width:"100%"},children:[e.jsxs(n,{sx:{maxWidth:"lg",margin:"auto",backgroundColor:"white",borderRadius:h.shape.borderRadius,boxShadow:h.shadows[1],p:T?2:3,overflowX:"hidden"},children:[e.jsx(n,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3},children:e.jsxs(n,{sx:{display:"flex",alignItems:"center",gap:2},children:[Ne&&e.jsx(Ke,{onClick:()=>Ge("/vehicle-setup/lists"),color:"primary",children:e.jsx(gr,{})}),e.jsx(br,{sx:{fontSize:24,mr:1}}),e.jsx(i,{variant:"h5",component:"h1",children:Ne?"Edit Vehicle":"Add New Vehicle"})]})}),e.jsx(i,{variant:"subtitle1",color:"text.secondary",sx:{mb:4},children:"Insert the basic information of the vehicle"}),Le&&e.jsx(n,{sx:{display:"flex",justifyContent:"center",mb:2},children:e.jsx(Ba,{})}),e.jsxs(n,{component:"form",onSubmit:sr,children:[e.jsxs(n,{sx:{display:"flex",flexDirection:T?"column":"row",gap:3,mb:4},children:[e.jsx(N,{sx:{flex:T?"auto":2,p:2,boxShadow:"none",border:`1px solid ${h.palette.grey[200]}`},children:e.jsxs(ee,{sx:{"&:last-child":{pb:2}},children:[e.jsx(i,{variant:"h6",gutterBottom:!0,children:"General Information"}),e.jsx(i,{variant:"body2",color:"text.secondary",sx:{mb:2},children:"Insert the basic information of the vehicle"}),e.jsx(x,{fullWidth:!0,label:"Vehicle Name*",variant:"outlined",value:Ae,onChange:t=>gt(t.target.value),placeholder:"Type vehicle name",sx:{mb:2},required:!0}),e.jsx(x,{fullWidth:!0,label:"Short Description",variant:"outlined",multiline:!0,rows:4,value:ha,onChange:t=>pt(t.target.value),placeholder:"Type short description",sx:{mb:2}})]})}),e.jsx(N,{sx:{flex:T?"auto":1,p:2,boxShadow:"none",border:`1px solid ${h.palette.grey[200]}`},children:e.jsxs(ee,{sx:{"&:last-child":{pb:2}},children:[e.jsx(i,{variant:"h6",gutterBottom:!0,children:"Vehicle Thumbnail*"}),e.jsx(i,{variant:"body2",color:"text.secondary",sx:{mb:2},children:"JPG, JPEG, PNG Less Than 1MB (Ratio 2:1)"}),e.jsxs(Gt,{onDragOver:ka,onDrop:Ya,onClick:()=>document.getElementById("thumbnail-upload").click(),children:[X?e.jsxs(n,{children:[e.jsx("img",{src:URL.createObjectURL(X),alt:"Thumbnail preview",style:{maxWidth:"100%",maxHeight:100,objectFit:"contain",marginBottom:h.spacing(1)}}),e.jsx(i,{variant:"body2",color:"text.secondary",children:X.name})]}):De?e.jsxs(n,{children:[e.jsx("img",{src:De,alt:"Existing thumbnail",style:{maxWidth:"100%",maxHeight:100,objectFit:"contain",marginBottom:h.spacing(1),borderColor:"#E15B65"}}),e.jsx(i,{variant:"body2",color:"text.secondary",children:"Existing thumbnail. Upload to replace."})]}):e.jsxs(n,{children:[e.jsx(Ut,{sx:{fontSize:40,color:"#E15B65",mb:1}}),e.jsx(i,{variant:"body2",color:"#E15B65",sx:{mb:.5,fontWeight:"medium"},children:"Click to upload"}),e.jsx(i,{variant:"body2",color:"#E15B65",children:"Or drag and drop"})]}),e.jsx("input",{type:"file",id:"thumbnail-upload",hidden:!0,accept:"image/jpeg,image/png,image/jpg",onChange:Ja})]})]})})]}),e.jsx(n,{sx:{mb:4},children:e.jsx(N,{sx:{p:2,boxShadow:"none",border:`1px solid ${h.palette.grey[200]}`},children:e.jsxs(ee,{sx:{"&:last-child":{pb:2}},children:[e.jsxs(i,{variant:"h6",gutterBottom:!0,children:["Images",e.jsx("span",{style:{color:"#E15B65"},children:"*"})]}),e.jsx(i,{variant:"body2",color:"text.secondary",sx:{mb:3},children:"Upload high quality images (JPG, JPEG, PNG â€¢ Max 1MB â€¢ Ratio 2:1)"}),e.jsxs(Gt,{onDragOver:ka,onDrop:Qa,onClick:()=>document.getElementById("images-upload").click(),sx:{backgroundColor:"#fafafa",border:"2px dashed #E15B65",borderRadius:2,p:3,transition:"0.3s","&:hover":{backgroundColor:"#fff1f2"}},children:[ve.length>0||G.length>0?e.jsxs(n,{sx:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(90px, 1fr))",gap:2,width:"100%"},children:[ve.map((t,a)=>e.jsxs(n,{sx:{position:"relative",borderRadius:1.5,overflow:"hidden",border:"1px solid #e5e7eb"},children:[e.jsx("img",{src:t,alt:`Existing ${a}`,style:{width:"100%",height:90,objectFit:"cover"}}),e.jsx(n,{sx:{position:"absolute",top:6,left:6,backgroundColor:"#000",color:"#fff",fontSize:10,px:.8,py:.2,borderRadius:1,opacity:.75},children:"Existing"})]},`existing-${a}`)),G.map((t,a)=>e.jsxs(n,{sx:{position:"relative",borderRadius:1.5,overflow:"hidden",border:"1px solid #e5e7eb"},children:[e.jsx("img",{src:URL.createObjectURL(t),alt:`New ${a}`,style:{width:"100%",height:90,objectFit:"cover"}}),e.jsx(Ke,{size:"small",onClick:()=>Ee(o=>o.filter((r,d)=>d!==a)),sx:{position:"absolute",top:4,right:4,backgroundColor:"#fff",boxShadow:1,"&:hover":{backgroundColor:"#fee2e2"}},children:"âœ•"})]},`new-${a}`))]}):e.jsxs(n,{sx:{textAlign:"center"},children:[e.jsx(Ut,{sx:{fontSize:46,color:"#E15B65",mb:1}}),e.jsx(i,{fontWeight:600,color:"#E15B65",children:"Click to upload images"}),e.jsx(i,{variant:"body2",color:"text.secondary",children:"or drag & drop files here"})]}),e.jsxs(i,{variant:"caption",color:"text.secondary",sx:{mt:2,display:"block",textAlign:"center"},children:[ve.length+G.length," image(s) selected"]}),e.jsx("input",{type:"file",id:"images-upload",hidden:!0,accept:"image/jpeg,image/png,image/jpg",multiple:!0,onChange:Xa})]})]})})}),e.jsx(n,{sx:{mb:4},children:e.jsx(N,{sx:{p:2,boxShadow:"none",border:`1px solid ${h.palette.grey[200]}`},children:e.jsxs(ee,{sx:{"&:last-child":{pb:2}},children:[e.jsx(i,{variant:"h6",gutterBottom:!0,children:"Vehicle Information"}),e.jsx(i,{variant:"body2",color:"text.secondary",sx:{mb:3},children:"Insert the vehicle's general information"}),e.jsxs(n,{sx:{display:"grid",gridTemplateColumns:T?"1fr":"repeat(3, 1fr)",gap:h.spacing(3),mb:4},children:[e.jsxs(U,{spacing:2,children:[e.jsx(i,{variant:"subtitle2",sx:{fontWeight:700,mb:1},children:"Basic Info"}),e.jsxs(f,{fullWidth:!0,variant:"outlined",required:!0,children:[e.jsx(E,{id:"brand-label",children:"Select Brand / Manufacturer"}),e.jsxs(w,{labelId:"brand-label",id:"brand-select",value:Pe,label:"Select Brand / Manufacturer",onChange:t=>ft(t.target.value),children:[e.jsx(l,{value:"",children:"Select vehicle brand"}),Tt.map(t=>e.jsx(l,{value:t._id,children:t.title},t._id))]})]}),e.jsx(x,{fullWidth:!0,label:"Enter Model Name",variant:"outlined",value:Ie,onChange:t=>mt(t.target.value),placeholder:"e.g. Camry, Bus X",required:!0}),!K&&e.jsx(x,{fullWidth:!0,label:"Year of Manufacture",variant:"outlined",placeholder:"e.g. 2023"})]}),e.jsxs(U,{spacing:2,children:[e.jsx(i,{variant:"subtitle2",sx:{fontWeight:700,mb:1},children:"Capacity & Comfort"}),e.jsx(x,{fullWidth:!0,label:"Seating Capacity",variant:"outlined",value:We,onChange:t=>yt(t.target.value),placeholder:"Number of seats",type:"number",inputProps:{min:1},required:!0}),K&&e.jsxs(f,{fullWidth:!0,variant:"outlined",children:[e.jsx(E,{children:"Select Legroom Type"}),e.jsxs(w,{value:"",label:"Select Legroom Type",onChange:t=>{},children:[e.jsx(l,{value:"",children:"Select Legroom"}),e.jsx(l,{value:"standard",children:"Standard"}),e.jsx(l,{value:"extra",children:"Extra"}),e.jsx(l,{value:"premium",children:"Premium"})]})]}),K&&e.jsxs(n,{sx:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:2},children:[e.jsxs(n,{children:[e.jsx(i,{variant:"body2",color:"text.secondary",sx:{mb:1},children:"Pushback seats"}),e.jsxs(le,{row:!0,value:rt,onChange:t=>Qt(t.target.value),children:[e.jsx(y,{value:"yes",control:e.jsx(F,{size:"small"}),label:e.jsx(i,{variant:"body2",children:"Yes"})}),e.jsx(y,{value:"no",control:e.jsx(F,{size:"small"}),label:e.jsx(i,{variant:"body2",children:"No"})})]})]}),e.jsxs(n,{children:[e.jsx(i,{variant:"body2",color:"text.secondary",sx:{mb:1},children:"Recliner Seats"}),e.jsxs(le,{row:!0,value:Fa,onChange:t=>za(t.target.value),children:[e.jsx(y,{value:"yes",control:e.jsx(F,{size:"small"}),label:e.jsx(i,{variant:"body2",children:"Yes"})}),e.jsx(y,{value:"no",control:e.jsx(F,{size:"small"}),label:e.jsx(i,{variant:"body2",children:"No"})})]})]})]}),!K&&e.jsxs(f,{component:"fieldset",fullWidth:!0,sx:{mt:1},children:[e.jsx(i,{variant:"body2",color:"text.secondary",sx:{mb:1},children:"Air Conditioning"}),e.jsxs(le,{row:!0,value:fe,onChange:t=>me(t.target.value),children:[e.jsx(y,{value:"yes",control:e.jsx(F,{size:"small"}),label:e.jsx(i,{variant:"body2",children:"Yes"})}),e.jsx(y,{value:"no",control:e.jsx(F,{size:"small"}),label:e.jsx(i,{variant:"body2",children:"No"})})]})]})]}),e.jsxs(U,{spacing:2,children:[e.jsx(i,{variant:"subtitle2",sx:{fontWeight:700,mb:1},children:"Zone & Location"}),e.jsxs(f,{fullWidth:!0,variant:"outlined",required:!0,children:[e.jsx(E,{id:"zone-label",children:"Zone*"}),e.jsxs(w,{labelId:"zone-label",value:Te,label:"Zone",onChange:nr,children:[e.jsx(l,{value:"",children:"Select zone"}),se.map(t=>e.jsx(l,{value:t._id,children:t.name},t._id))]})]}),e.jsxs(f,{fullWidth:!0,required:!0,children:[e.jsx(E,{children:"Parent Category"}),e.jsxs(w,{value:I,label:"Parent Category",onChange:qa,children:[e.jsx(l,{value:"",children:"Select Parent Category"}),$.map(t=>e.jsx(l,{value:t._id,children:t.title},t._id))]})]}),e.jsxs(f,{fullWidth:!0,required:!0,disabled:!I,children:[e.jsx(E,{children:"Sub Category"}),e.jsxs(w,{value:Re,label:"Sub Category",onChange:t=>ye(t.target.value),children:[e.jsx(l,{value:"",children:"Select Sub Category"}),Ka.map(t=>e.jsx(l,{value:t._id,children:t.title},t._id))]})]})]})]}),e.jsxs(n,{children:[e.jsx(i,{variant:"subtitle1",sx:{fontWeight:700,mb:3},children:"Engine & Performance"}),K?e.jsxs(U,{spacing:3,children:[e.jsxs(n,{sx:{display:"grid",gridTemplateColumns:T?"1fr":"repeat(3, 1fr)",gap:h.spacing(3)},children:[e.jsxs(f,{fullWidth:!0,size:"small",children:[e.jsx(E,{children:"Select Fuel Type"}),e.jsxs(w,{value:he,label:"Select Fuel Type",onChange:t=>at(t.target.value),children:[e.jsx(l,{value:"",children:"Select Fuel"}),e.jsx(l,{value:"petrol",children:"Petrol"}),e.jsx(l,{value:"diesel",children:"Diesel"}),e.jsx(l,{value:"electric",children:"Electric"}),e.jsx(l,{value:"hybrid",children:"Hybrid"}),e.jsx(l,{value:"cng",children:"CNG"})]})]}),e.jsxs(f,{fullWidth:!0,size:"small",children:[e.jsx(E,{children:"Transmission"}),e.jsxs(w,{value:Ce,label:"Transmission",onChange:t=>Je(t.target.value),children:[e.jsx(l,{value:"",children:"Select Transmission"}),e.jsx(l,{value:"manual",children:"Manual"}),e.jsx(l,{value:"automatic",children:"Automatic"}),e.jsx(l,{value:"semi-automatic",children:"Semi-Automatic"})]})]}),e.jsxs(f,{fullWidth:!0,size:"small",children:[e.jsx(E,{children:"Climate Control"}),e.jsxs(w,{value:fe,label:"Climate Control",onChange:t=>me(t.target.value),children:[e.jsx(l,{value:"yes",children:"AC"}),e.jsx(l,{value:"no",children:"Non-AC"})]})]})]}),e.jsxs(f,{component:"fieldset",fullWidth:!0,children:[e.jsx(i,{variant:"body2",color:"text.secondary",sx:{mb:1},children:"Air Conditioning"}),e.jsxs(le,{row:!0,value:fe,onChange:t=>me(t.target.value),children:[e.jsx(y,{value:"yes",control:e.jsx(F,{size:"small"}),label:e.jsx(i,{variant:"body2",children:"Yes"})}),e.jsx(y,{value:"no",control:e.jsx(F,{size:"small"}),label:e.jsx(i,{variant:"body2",children:"No"})})]})]})]}):e.jsxs(n,{sx:{display:"grid",gridTemplateColumns:T?"1fr":"repeat(3, 1fr)",gap:h.spacing(3)},children:[e.jsxs(f,{fullWidth:!0,children:[e.jsx(E,{children:"Select Fuel Type"}),e.jsxs(w,{value:he,label:"Select Fuel Type",onChange:t=>at(t.target.value),children:[e.jsx(l,{value:"",children:"Select Fuel"}),e.jsx(l,{value:"petrol",children:"Petrol"}),e.jsx(l,{value:"diesel",children:"Diesel"}),e.jsx(l,{value:"electric",children:"Electric"}),e.jsx(l,{value:"hybrid",children:"Hybrid"}),e.jsx(l,{value:"cng",children:"CNG"})]})]}),e.jsxs(f,{fullWidth:!0,required:!0,children:[e.jsx(E,{children:"Transmission"}),e.jsxs(w,{value:Ce,label:"Transmission",onChange:t=>Je(t.target.value),children:[e.jsx(l,{value:"",children:"Select Transmission"}),e.jsx(l,{value:"manual",children:"Manual"}),e.jsx(l,{value:"automatic",children:"Automatic"}),e.jsx(l,{value:"semi-automatic",children:"Semi-Automatic"})]})]}),e.jsxs(f,{fullWidth:!0,children:[e.jsx(E,{children:"Vehicle Class"}),e.jsxs(w,{value:et,label:"Vehicle Class",onChange:t=>Xt(t.target.value),children:[e.jsx(l,{value:"standard",children:"Standard"}),e.jsx(l,{value:"luxury",children:"Luxury"}),e.jsx(l,{value:"vintage",children:"Vintage"})]})]}),e.jsx(x,{fullWidth:!0,label:"Engine Capacity (CC)",variant:"outlined",type:"number",value:Ye,onChange:t=>qt(t.target.value),placeholder:"e.g. 2000",inputProps:{min:0}}),e.jsx(x,{fullWidth:!0,label:"Engine Power (HP)",variant:"outlined",type:"number",value:Se,onChange:t=>Zt(t.target.value),placeholder:"e.g. 180",inputProps:{min:0}}),e.jsx(x,{fullWidth:!0,label:"Torque",variant:"outlined",value:Xe,onChange:t=>Jt(t.target.value),placeholder:"e.g. 250 Nm"}),e.jsx(x,{fullWidth:!0,label:"Mileage",variant:"outlined",value:Qe,onChange:t=>Yt(t.target.value),placeholder:"e.g. 15 km/l"})]})]}),e.jsx(n,{sx:{mt:3},children:e.jsx(x,{fullWidth:!0,label:"Vihicles Address*",variant:"outlined",value:_e,onChange:t=>ne(t.target.value),placeholder:"Enter venue address",required:!0})}),e.jsxs(n,{sx:{mt:3},children:[e.jsx(i,{variant:"h6",gutterBottom:!0,children:"Location and Operating Hours"}),e.jsx(x,{fullWidth:!0,label:"Search Location",inputRef:qe,variant:"outlined",placeholder:"Enter a location",sx:{mb:2}}),e.jsxs(n,{sx:{display:"flex",gap:2,mb:2},children:[e.jsx(x,{sx:{flex:1},label:"Latitude*",variant:"outlined",value:R,onChange:t=>ie(t.target.value),placeholder:"e.g., 25.2048",required:!0}),e.jsx(x,{sx:{flex:1},label:"Longitude*",variant:"outlined",value:L,onChange:t=>oe(t.target.value),placeholder:"e.g., 55.2708",required:!0})]}),H&&ut?e.jsxs(e.Fragment,{children:[e.jsx(i,{variant:"body2",color:"text.secondary",sx:{mb:1},children:"Click on the map below to select a location"}),e.jsx(n,{ref:Ze,sx:{height:300,width:"100%",borderRadius:h.shape.borderRadius,border:`1px solid ${h.palette.grey[300]}`,mb:2}})]}):e.jsx(n,{sx:{height:300,display:"flex",alignItems:"center",justifyContent:"center",border:`1px solid ${h.palette.grey[300]}`,borderRadius:h.shape.borderRadius,mb:2},children:e.jsx(i,{variant:"body2",color:"text.secondary",children:"Map loading..."})}),e.jsx(x,{fullWidth:!0,label:"Operating Hours",variant:"outlined",value:$e,onChange:t=>Ot(t.target.value),placeholder:"e.g., 9:00 AM - 6:00 PM",multiline:!0,rows:2})]})]})})}),e.jsx(n,{sx:{mb:4},children:e.jsx(N,{sx:{p:2,boxShadow:"none",border:`1px solid ${h.palette.grey[200]}`},children:e.jsxs(ee,{children:[e.jsx(i,{variant:"h6",gutterBottom:!0,children:"Vehicle Attributes"}),e.jsx(i,{variant:"body2",color:"text.secondary",sx:{mb:2},children:"Select additional attributes for the vehicle"}),e.jsx(n,{sx:{display:"grid",gridTemplateColumns:T?"1fr":"repeat(3, 1fr)",gap:3},children:$a.map(t=>e.jsxs(f,{fullWidth:!0,children:[e.jsx(E,{children:t.title}),e.jsxs(w,{value:Ft[t._id]||"",label:t.title,onChange:a=>tr(t._id,a.target.value),children:[e.jsxs(l,{value:"",children:["Select ",t.title]}),t.values.map(a=>e.jsx(l,{value:a,children:a},a))]})]},t._id))})]})})}),e.jsx(n,{sx:{mb:4},children:e.jsxs(ee,{sx:{"&:last-child":{pb:2}},children:[e.jsx(i,{variant:"h6",gutterBottom:!0,children:"Vehicle Identity"}),e.jsx(i,{variant:"body2",color:"text.secondary",sx:{mb:2},children:"Insert the vehicle number and driver availability"}),e.jsxs(n,{sx:{display:"grid",gridTemplateColumns:T?"1fr":"2fr 1fr",gap:3,alignItems:"center"},children:[e.jsx(x,{fullWidth:!0,label:"Vehicle Number*",variant:"outlined",value:be,onChange:t=>{vt(t.target.value),Nt(t.target.value)},placeholder:"Enter vehicle number",required:!0,error:!!pa,helperText:pa}),e.jsxs(n,{children:[e.jsx(i,{variant:"body2",fontWeight:600,sx:{mb:1},children:"Driver Included"}),e.jsxs(n,{sx:{display:"flex",gap:3},children:[e.jsx(y,{control:e.jsx(de,{checked:z.driverIncluded===!0,onChange:()=>je(t=>({...t,driverIncluded:!0}))}),label:"Yes"}),e.jsx(y,{control:e.jsx(de,{checked:z.driverIncluded===!1,onChange:()=>je(t=>({...t,driverIncluded:!1}))}),label:"No"})]})]})]})]})}),Lt&&Ve&&e.jsxs(N,{sx:{mt:6,mb:6,borderRadius:3,border:"1px solid #e5e7eb",backgroundColor:"#fafafa"},children:[e.jsxs(n,{sx:{px:4,py:3,borderBottom:"1px solid #e5e7eb",background:"linear-gradient(135deg, #f9fafb, #ffffff)"},children:[e.jsx(i,{variant:"h6",fontWeight:700,children:"ðŸš— Vehicle Features"}),e.jsx(i,{variant:"body2",color:"text.secondary",children:"Select features available in this vehicle"})]}),e.jsx(n,{sx:{px:4,py:4},children:e.jsx(U,{spacing:4,children:[{title:"Interior Comfort",items:[["Leather Seats","leatherSeats"],["Adjustable Seats","adjustableSeats"],["Armrest","armrest"]]},{title:"Entertainment",items:[["Music System","musicSystem"],["Bluetooth","bluetooth"],["USB / AUX","usbAux"]]},{title:"Safety & Compliance",items:[["Airbags","airbags"],["ABS","abs"],["Rear Camera","rearCamera"],["Parking Sensors","parkingSensors"]]},{title:"Convenience",items:[["Power Windows","powerWindows"],["Central Lock","centralLock"],["Keyless Entry","keylessEntry"]]},{title:"Extra Addons",items:[["Wifi","wifi"],["Charging Points","chargingPoints"]]}].map(t=>e.jsxs(n,{sx:{p:3,backgroundColor:t.title==="Extra Addons"?"#e7f0f5":"#ffffff",borderRadius:2,border:"1px solid #e5e7eb"},children:[e.jsx(i,{fontWeight:600,mb:2,children:t.title}),e.jsx(n,{sx:{display:"grid",gridTemplateColumns:T?"1fr":"repeat(3, 1fr)",gap:1.5},children:t.items.map(([a,o])=>e.jsx(y,{control:e.jsx(de,{checked:v[o],onChange:ir(o)}),label:a},o))}),t.title==="Extra Addons"&&e.jsxs(n,{sx:{mt:3},children:[e.jsx(i,{fontWeight:600,mb:1,children:"Interior Lighting"}),e.jsxs(le,{row:!0,value:we,onChange:a=>tt(a.target.value),children:[e.jsx(y,{value:"normal",control:e.jsx(F,{}),label:"Normal"}),e.jsx(y,{value:"premium",control:e.jsx(F,{}),label:"Premium"})]})]})]},t.title))})})]}),Lt&&K&&e.jsxs(N,{sx:{mt:6,mb:6,borderRadius:3,border:"1px solid #e5e7eb",backgroundColor:"#fafafa"},children:[e.jsxs(n,{sx:{px:4,py:3,borderBottom:"1px solid #e5e7eb",background:"linear-gradient(135deg, #f9fafb, #ffffff)"},children:[e.jsx(i,{variant:"h6",fontWeight:700,children:"ðŸšŒ Bus Features"}),e.jsx(i,{variant:"body2",color:"text.secondary",children:"Select features available in this bus"})]}),e.jsx(n,{sx:{px:4,py:4},children:e.jsx(U,{spacing:4,children:[{title:"Interior Features",items:[["Curtains","curtains"],["Reading Lights","readingLights"]]},{title:"Entertainment & Communication",items:[["Music System","musicSystem"],["Microphone","microphone"]]},{title:"Safety & Compliance",items:[["Fire Extinguisher","fireExtinguisher"],["First Aid Kit","firstAidKit"]]},{title:"Storage",items:[["Luggage Carrier","luggageCarrier"]]},{title:"Extra Addons",items:[["Wifi","wifi"],["Charging Points","chargingPoints"]]}].map(t=>e.jsxs(n,{sx:{p:3,backgroundColor:t.title==="Extra Addons"?"#e5edf6":"#ffffff",borderRadius:2,border:"1px solid #e5e7eb"},children:[e.jsx(i,{fontWeight:600,mb:2,children:t.title}),t.title==="Extra Addons"?e.jsxs(e.Fragment,{children:[e.jsxs(n,{sx:{display:"grid",gridTemplateColumns:T?"1fr":"1fr 1fr",gap:2,mb:3},children:[e.jsx(y,{control:e.jsx(de,{checked:W.wifi,onChange:Kt("wifi")}),label:"Wifi"}),e.jsx(y,{control:e.jsx(de,{checked:W.chargingPoints,onChange:Kt("chargingPoints")}),label:"Charging Points"})]}),e.jsxs(n,{children:[e.jsx(i,{sx:{fontSize:"0.875rem",fontWeight:600,mb:1},children:"Interior Lighting"}),e.jsxs(le,{row:!0,value:we,onChange:a=>tt(a.target.value),children:[e.jsx(y,{value:"normal",control:e.jsx(F,{}),label:"Normal"}),e.jsx(y,{value:"premium",control:e.jsx(F,{}),label:"Premium"})]})]})]}):e.jsx(n,{sx:{display:"grid",gridTemplateColumns:T?"1fr":"repeat(3, 1fr)",gap:1.5},children:t.items.map(([a,o])=>e.jsx(y,{control:e.jsx(de,{checked:W[o],onChange:Kt(o)}),label:a},o))})]},t.title))})})]}),Lt&&(Ve||K)&&e.jsx(n,{sx:{mb:4},children:e.jsxs(N,{sx:{mt:6,mb:6,borderRadius:3,border:"none",boxShadow:"0 4px 20px rgba(0,0,0,0.08)",overflow:"hidden"},children:[e.jsxs(n,{sx:{px:4,py:3,background:"linear-gradient(135deg, #f5efef 0%, #efdfe1 100%)",color:"white"},children:[e.jsx(i,{variant:"h5",sx:{fontWeight:700,mb:.5},children:"Package Pricing"}),e.jsx(i,{variant:"body2",sx:{opacity:.95},children:"Set base price, discount & advance booking options"})]}),e.jsx(n,{sx:{p:4,backgroundColor:"#fafbfc"},children:e.jsxs(Ue,{container:!0,spacing:3,children:[e.jsx(Ue,{item:!0,xs:12,md:8,children:e.jsxs(n,{sx:{p:3,borderRadius:2,backgroundColor:"#ffffff",border:"2px solid #e5e7eb",height:"100%",transition:"all 0.3s ease","&:hover":{boxShadow:"0 8px 24px rgba(225, 91, 101, 0.15)",borderColor:"#E15B65"}},children:[e.jsxs(n,{sx:{display:"flex",alignItems:"center",mb:3},children:[e.jsx(n,{sx:{width:40,height:40,borderRadius:"50%",backgroundColor:"#E15B65",display:"flex",alignItems:"center",justifyContent:"center",mr:2},children:e.jsx(i,{sx:{color:"white",fontSize:20,fontWeight:700},children:"â‚¹"})}),e.jsx(i,{variant:"subtitle1",fontWeight:700,sx:{color:"#1f2937"},children:"Package Details"})]}),e.jsxs(U,{spacing:2.5,children:[e.jsxs(n,{children:[e.jsx(i,{variant:"caption",sx:{color:"#6b7280",mb:1,display:"block",fontWeight:600},children:"Base Package Price"}),e.jsx(x,{fullWidth:!0,type:"number",value:ke,onChange:t=>ta(t.target.value),placeholder:"0",InputProps:{startAdornment:e.jsx(i,{sx:{mr:1,color:"#E15B65",fontWeight:600,fontSize:18},children:"â‚¹"})},size:"small",sx:{"& .MuiOutlinedInput-root":{"&:hover fieldset":{borderColor:"#E15B65"},"&.Mui-focused fieldset":{borderColor:"#E15B65"}}}})]}),e.jsxs(n,{sx:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:2},children:[e.jsxs(n,{children:[e.jsx(i,{variant:"caption",sx:{color:"#6b7280",mb:1,display:"block",fontWeight:600},children:"Hours Included"}),e.jsx(f,{fullWidth:!0,size:"small",children:e.jsxs(w,{value:st,onChange:t=>aa(t.target.value),displayEmpty:!0,sx:{"&:hover .MuiOutlinedInput-notchedOutline":{borderColor:"#E15B65"},"&.Mui-focused .MuiOutlinedInput-notchedOutline":{borderColor:"#E15B65"}},children:[e.jsx(l,{value:"",children:"Select"}),e.jsx(l,{value:"4",children:"4 Hrs"}),e.jsx(l,{value:"6",children:"6 Hrs"}),e.jsx(l,{value:"8",children:"8 Hrs"}),e.jsx(l,{value:"10",children:"10 Hrs"}),e.jsx(l,{value:"12",children:"12 Hrs"})]})})]}),e.jsxs(n,{children:[e.jsx(i,{variant:"caption",sx:{color:"#6b7280",mb:1,display:"block",fontWeight:600},children:"KM Included"}),e.jsx(f,{fullWidth:!0,size:"small",children:e.jsxs(w,{value:nt,onChange:t=>ra(t.target.value),displayEmpty:!0,sx:{"&:hover .MuiOutlinedInput-notchedOutline":{borderColor:"#E15B65"},"&.Mui-focused .MuiOutlinedInput-notchedOutline":{borderColor:"#E15B65"}},children:[e.jsx(l,{value:"",children:"Select"}),e.jsx(l,{value:"50",children:"50 KM"}),e.jsx(l,{value:"100",children:"100 KM"}),e.jsx(l,{value:"150",children:"150 KM"})]})})]})]}),e.jsxs(n,{sx:{p:2,borderRadius:1.5,backgroundColor:"#fef3f2",border:"1px dashed #E15B65"},children:[e.jsx(i,{variant:"caption",sx:{color:"#6b7280",mb:1,display:"block",fontWeight:600},children:"Extra Charges"}),e.jsxs(n,{sx:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:1.5},children:[e.jsx(x,{fullWidth:!0,label:"Price/KM",type:"number",value:it,onChange:t=>sa(t.target.value),InputProps:{startAdornment:e.jsx(i,{sx:{mr:.5,color:"text.secondary",fontSize:14},children:"â‚¹"})},size:"small"}),e.jsxs(f,{fullWidth:!0,size:"small",children:[e.jsx(E,{children:"After KM"}),e.jsxs(w,{value:ot,label:"After KM",onChange:t=>na(t.target.value),children:[e.jsx(l,{value:"",children:"Select"}),e.jsx(l,{value:"1",children:"Per KM"})]})]})]})]})]})]})}),e.jsx(Ue,{item:!0,xs:12,md:4,children:e.jsxs(n,{sx:{p:3,borderRadius:2,backgroundColor:"#ffffff",border:"2px solid #e5e7eb",height:"100%",transition:"all 0.3s ease","&:hover":{boxShadow:"0 8px 24px rgba(225, 91, 101, 0.15)",borderColor:"#E15B65"}},children:[e.jsxs(n,{sx:{display:"flex",alignItems:"center",mb:3},children:[e.jsx(n,{sx:{width:40,height:40,borderRadius:"50%",backgroundColor:"#10b981",display:"flex",alignItems:"center",justifyContent:"center",mr:2},children:e.jsx(i,{sx:{color:"white",fontSize:20,fontWeight:700},children:"%"})}),e.jsx(i,{variant:"subtitle1",fontWeight:700,sx:{color:"#1f2937"},children:"Offers & Advance"})]}),e.jsxs(U,{spacing:3,children:[e.jsxs(n,{sx:{p:2.5,borderRadius:2,backgroundColor:"#f0fdf4",border:"1px solid #bbf7d0"},children:[e.jsx(i,{variant:"body2",fontWeight:600,sx:{color:"#15803d",mb:2},children:"Apply Discount"}),e.jsxs(n,{sx:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:2},children:[e.jsxs(f,{fullWidth:!0,size:"small",children:[e.jsx(E,{children:"Type"}),e.jsxs(w,{value:lt,label:"Type",onChange:t=>ia(t.target.value),children:[e.jsx(l,{value:"percentage",children:"Percentage (%)"}),e.jsx(l,{value:"flat",children:"Flat Rate (â‚¹)"})]})]}),e.jsx(x,{fullWidth:!0,label:"Value",type:"number",value:Be,onChange:t=>At(t.target.value),size:"small"})]})]}),e.jsxs(n,{sx:{p:2.5,borderRadius:2,backgroundColor:"#eff6ff",border:"1px solid #bfdbfe"},children:[e.jsx(i,{variant:"body2",fontWeight:600,sx:{color:"#1e40af",mb:2},children:"Advance Booking"}),e.jsxs(n,{sx:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:2},children:[e.jsxs(f,{fullWidth:!0,size:"small",children:[e.jsx(E,{children:"Type"}),e.jsxs(w,{value:dt,label:"Type",onChange:t=>oa(t.target.value),children:[e.jsx(l,{value:"percentage",children:"Percentage (%)"}),e.jsx(l,{value:"flat",children:"Flat (â‚¹)"})]})]}),e.jsx(x,{fullWidth:!0,label:"Amount",type:"number",value:ct,onChange:t=>la(t.target.value),InputProps:{startAdornment:e.jsx(i,{sx:{mr:.5,color:"text.secondary",fontSize:14},children:"â‚¹"})},size:"small"})]})]})]})]})}),e.jsx(Ue,{item:!0,xs:12,md:4,children:e.jsxs(n,{sx:{p:3,ml:{xs:0,md:30},display:"flex",borderRadius:2,backgroundColor:"#ffffff",border:"2px solid #e5e7eb",height:"100%",display:"flex",flexDirection:"column",transition:"all 0.3s ease","&:hover":{boxShadow:"0 8px 24px rgba(225, 91, 101, 0.15)",borderColor:"#E15B65"}},children:[e.jsxs(n,{sx:{display:"flex",alignItems:"center",mb:3},children:[e.jsx(n,{sx:{width:40,height:40,borderRadius:"50%",backgroundColor:"#f59e0b",display:"flex",alignItems:"center",justifyContent:"center",mr:2},children:e.jsx(i,{sx:{color:"white",fontSize:20,fontWeight:700},children:"Î£"})}),e.jsx(i,{variant:"subtitle1",fontWeight:700,sx:{color:"#1f2937"},children:"Summary"})]}),e.jsxs(n,{sx:{flexGrow:1,display:"flex",flexDirection:"column",justifyContent:"center"},children:[e.jsxs(n,{sx:{p:5,borderRadius:3,background:"linear-gradient(135deg, #E15B65 0%, #c94450 100%)",color:"white",textAlign:"center",boxShadow:"0 10px 30px rgba(225, 91, 101, 0.35)",position:"relative",overflow:"hidden","&::before":{content:'""',position:"absolute",top:-30,right:-30,width:120,height:120,borderRadius:"50%",backgroundColor:"rgba(255, 255, 255, 0.08)"},"&::after":{content:'""',position:"absolute",bottom:-40,left:-40,width:100,height:100,borderRadius:"50%",backgroundColor:"rgba(255, 255, 255, 0.06)"}},children:[e.jsx(i,{variant:"body2",fontWeight:600,sx:{opacity:1,mb:2,position:"relative",zIndex:1,letterSpacing:1,textTransform:"uppercase",fontSize:"0.75rem",color:"rgba(255, 255, 255, 0.95)"},children:"Grand Total"}),e.jsx(n,{sx:{position:"relative",zIndex:1},children:e.jsxs(i,{variant:"h2",fontWeight:700,sx:{mb:1.5,textShadow:"0 2px 10px rgba(0,0,0,0.1)",fontSize:{xs:"2.5rem",md:"3rem"}},children:["â‚¹ ",ke||"0"]})}),e.jsx(n,{sx:{mt:2.5,pt:2.5,borderTop:"2px solid rgba(255, 255, 255, 0.2)",position:"relative",zIndex:1},children:e.jsx(i,{variant:"body2",sx:{opacity:.95,fontWeight:500,fontSize:"0.85rem",lineHeight:1.5},children:"Base Price + Taxes & Fees"})})]}),e.jsxs(n,{sx:{mt:3,p:2.5,borderRadius:2,backgroundColor:"#fffbeb",border:"1px solid #fde68a",display:"flex",alignItems:"flex-start",gap:1.5},children:[e.jsx(i,{sx:{fontSize:"1.2rem"},children:"ðŸ’¡"}),e.jsx(i,{variant:"body2",sx:{color:"#92400e",lineHeight:1.7,fontSize:"0.813rem",fontWeight:500},children:"Final amount calculated based on base price and applied discounts"})]})]})]})})]})})]})}),e.jsxs(n,{sx:{mt:3,p:2,border:"1px solid",borderColor:"grey.300",borderRadius:2,backgroundColor:"#fafafa"},children:[e.jsx(i,{variant:"subtitle1",gutterBottom:!0,children:"Vehicle Features"}),e.jsxs(n,{sx:{display:"grid",gridTemplateColumns:z.decorationAvailable?{xs:"1fr",md:"1fr 1fr"}:"max-content",gap:3,alignItems:"center"},children:[e.jsxs(n,{sx:{display:"flex",alignItems:"center",gap:3,px:3,py:2,border:"1px solid",borderColor:"grey.300",borderRadius:2,backgroundColor:"white",width:"fit-content",minWidth:260},children:[e.jsx(i,{fontSize:14,fontWeight:500,children:"Decoration Available"}),e.jsx(xr,{checked:z.decorationAvailable,onChange:t=>je(a=>({...a,decorationAvailable:t.target.checked})),sx:{"& .MuiSwitch-switchBase.Mui-checked":{color:"#E15B65"},"& .MuiSwitch-switchBase.Mui-checked + .MuiSwitch-track":{backgroundColor:"#E15B65"}}})]}),z.decorationAvailable&&e.jsx(n,{sx:{px:3,py:2,border:"1px solid",borderColor:"grey.300",borderRadius:2,backgroundColor:"white",minWidth:260},children:e.jsx(x,{fullWidth:!0,label:"Decoration Price (â‚¹)",type:"number",value:re,onChange:t=>Et(t.target.value),inputProps:{min:0},placeholder:"e.g. 5000"})})]})]}),e.jsxs(n,{sx:{mt:4,p:3,border:"1px solid",borderColor:"grey.300",borderRadius:2,backgroundColor:"#fafafa"},children:[e.jsx(i,{variant:"subtitle1",fontWeight:600,gutterBottom:!0,children:"Upload Vehicle Documents"}),e.jsx(i,{variant:"body2",color:"text.secondary",sx:{mb:2},children:"Upload RC, Insurance, Permit or any supporting vehicle documents"}),e.jsxs(Gt,{onDragOver:t=>t.preventDefault(),onDrop:Ga,onClick:()=>document.getElementById("vehicle-documents-upload").click(),sx:{minHeight:160},children:[va.length>0?e.jsx(U,{spacing:1,sx:{width:"100%"},children:va.map((t,a)=>e.jsxs(n,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",px:2,py:1,border:"1px solid #e5e7eb",borderRadius:1,backgroundColor:"#ffffff"},children:[e.jsxs(i,{variant:"body2",noWrap:!0,children:["ðŸ“„ ",t.name]}),e.jsx(Ke,{size:"small",onClick:()=>Mt(o=>o.filter((r,d)=>d!==a)),children:"âœ•"})]},a))}):e.jsxs(e.Fragment,{children:[e.jsx(Ut,{sx:{fontSize:42,color:"#E15B65",mb:1}}),e.jsx(i,{fontWeight:600,color:"#E15B65",children:"Click to upload documents"}),e.jsx(i,{variant:"body2",color:"text.secondary",children:"Or drag & drop files here (PDF, JPG, PNG)"})]}),e.jsx("input",{id:"vehicle-documents-upload",type:"file",hidden:!0,multiple:!0,accept:".pdf,image/png,image/jpeg,image/jpg",onChange:Ua})]})]}),e.jsx(n,{sx:{mb:4},children:e.jsxs(N,{sx:{p:3,borderRadius:3,background:"linear-gradient(135deg, #ffffff, #fafafa)",border:"1px solid #eee"},children:[e.jsx(i,{variant:"h6",fontWeight:600,sx:{mb:.5},children:"Terms & Conditions"}),e.jsx(i,{variant:"body2",color:"text.secondary",sx:{mb:3},children:"Define rules & policies shown to customers during booking"}),M.map((t,a)=>e.jsxs(n,{sx:{mb:3,p:2,borderRadius:2,border:"1px solid #e5e7eb",backgroundColor:"#fff"},children:[e.jsxs(n,{sx:{display:"flex",alignItems:"center",mb:2},children:[e.jsx(x,{fullWidth:!0,label:"Section Heading",placeholder:"e.g. Booking & Confirmation",value:t.heading,onChange:o=>{const r=[...M];r[a].heading=o.target.value,Z(r)}}),M.length>1&&e.jsx(ce,{onClick:()=>Z(o=>o.filter((r,d)=>d!==a)),sx:{ml:1,color:"error.main"},children:"âœ•"})]}),t.points.map((o,r)=>e.jsxs(n,{sx:{display:"flex",alignItems:"center",mb:1},children:[e.jsx(x,{fullWidth:!0,label:`Point ${r+1}`,placeholder:"Enter policy detail",value:o,onChange:d=>{const p=[...M];p[a].points[r]=d.target.value,Z(p)}}),t.points.length>1&&e.jsx(ce,{onClick:()=>{const d=[...M];d[a].points.splice(r,1),Z(d)},sx:{ml:1,color:"error.main"},children:"âœ•"})]},r)),e.jsx(ce,{size:"small",onClick:()=>{const o=[...M];o[a].points.push(""),Z(o)},sx:{mt:1,color:"#E15B65"},children:"+ Add Point"})]},a)),e.jsx(ce,{variant:"outlined",onClick:()=>Z([...M,{heading:"",points:[""]}]),sx:{mt:2,borderRadius:2,borderColor:"#E15B65",color:"#E15B65"},children:"+ Add Section"})]})}),e.jsx(n,{sx:{mb:4},children:e.jsx(N,{sx:{p:2,boxShadow:"none",border:`1px solid ${h.palette.grey[200]}`},children:e.jsxs(ee,{sx:{"&:last-child":{pb:2}},children:[e.jsx(i,{variant:"h6",gutterBottom:!0,children:"Search Tags"}),e.jsx(i,{variant:"body2",color:"text.secondary",sx:{mb:2},children:"Insert tags for appearing in user search results"}),e.jsx(x,{fullWidth:!0,label:"Type and press Enter",variant:"outlined",value:ze,onChange:er,onKeyPress:ar,placeholder:"Type and press Enter",sx:{mb:2}}),e.jsx(n,{sx:{display:"flex",flexWrap:"wrap",gap:1},children:Pt.map((t,a)=>e.jsxs(n,{sx:{display:"flex",alignItems:"center",backgroundColor:h.palette.grey[200],borderRadius:h.shape.borderRadius,px:1,py:.5},children:[e.jsx(i,{variant:"body2",children:t}),e.jsx(Ke,{size:"small",onClick:()=>rr(t),children:e.jsx(i,{sx:{fontSize:14},children:"Ã—"})})]},a))})]})})}),e.jsxs(n,{sx:{mt:4,display:"flex",justifyContent:"flex-end",gap:2},children:[e.jsx(ce,{variant:"outlined",color:"#E15B65",size:"large",onClick:Ht,sx:{color:"#E15B65"},children:Ne?"Cancel":"Reset"}),e.jsx(ce,{variant:"contained",type:"submit",size:"large",disabled:Le,startIcon:Le?e.jsx(Ba,{size:20,color:"inherit"}):null,sx:{color:"white",bgcolor:"#E15B65"},children:Le?"Submitting...":Ne?"Update":"Submit"})]})]})]}),e.jsx(fr,{open:Da,autoHideDuration:6e3,onClose:Aa,anchorOrigin:{vertical:"top",horizontal:"center"},sx:{"& .MuiSnackbarContent-root":{minWidth:"600px",maxWidth:"600px",width:"auto"}},children:e.jsx(mr,{onClose:Aa,severity:ja,sx:{width:"100%",backgroundColor:ja==="success"?"#1976d2":"#d32f2f",color:"white","& .MuiAlert-message":{whiteSpace:"pre-line",wordBreak:"break-word",fontSize:"1rem",lineHeight:1.5}},children:_a})})]})};export{Fr as default};
