import{r as o,h as T,j as e,B as b,T as i,a8 as k,S as w,s as v,g as B,t as L,a4 as g}from"./index-1IPimUki.js";import{T as A}from"./TableContainer-CGHXGt47.js";import{T as N,a as l,b as s,c as D}from"./TableRow-BO5nN1rQ.js";import{T as I}from"./TableHead-D2RHFueV.js";const E=()=>{try{const t=localStorage.getItem("user");if(!t)return null;const n=JSON.parse(t);return(n==null?void 0:n._id)||null}catch{return null}},O=t=>t?typeof t=="string"?t:Array.isArray(t)?t.map(n=>typeof n=="object"?n.label||n.time:n).join(", "):typeof t=="object"&&(t.label||t.time)||"N/A":"N/A",F=()=>{const[t,n]=o.useState(""),[f,y]=o.useState([]),[C,x]=o.useState(!0),c=E(),d=o.useCallback(async()=>{var r;if(c)try{x(!0);const S=(((r=(await T.get(`https://api.bookmyevent.ae/api/bookings/provider/${c}`)).data)==null?void 0:r.data)||[]).filter(p=>{const j=String(p.paymentStatus||"").toLowerCase(),m=String(p.moduleType||"").toLowerCase();return(j==="paid"||j==="completed")&&(m==="ornament"||m==="ornaments")});y(S)}catch(a){console.error("Error fetching completed bookings:",a)}finally{x(!1)}},[c]);o.useEffect(()=>{d()},[d]);const u=f.filter(r=>r._id.toLowerCase().includes(t.toLowerCase())||(r.fullName||"").toLowerCase().includes(t.toLowerCase()));return e.jsxs(b,{p:2,children:[e.jsx(i,{variant:"h4",gutterBottom:!0,fontWeight:600,children:"Completed Ornaments Bookings"}),e.jsxs(k,{sx:{mt:2,width:"100%",borderRadius:"12px",overflow:"hidden"},children:[e.jsxs(w,{direction:{xs:"column",sm:"row"},spacing:2,justifyContent:"space-between",alignItems:{xs:"stretch",sm:"center"},p:2,children:[e.jsx(v,{label:"Search by ID, customer name",size:"small",value:t,onChange:r=>n(r.target.value),sx:{maxWidth:{sm:350}}}),e.jsx(B,{variant:"contained",sx:{bgcolor:"#E15B65",color:"white",borderRadius:"30px",px:3},onClick:d,children:"Refresh"})]}),e.jsx(A,{sx:{width:"100%",overflowX:"auto"},children:e.jsxs(N,{stickyHeader:!0,children:[e.jsx(I,{children:e.jsxs(l,{children:[e.jsx(s,{children:e.jsx("strong",{children:"S#"})}),e.jsx(s,{children:e.jsx("strong",{children:"Booking ID"})}),e.jsx(s,{children:e.jsx("strong",{children:"Booking Date"})}),e.jsx(s,{children:e.jsx("strong",{children:"Schedule At"})}),e.jsx(s,{children:e.jsx("strong",{children:"Customer"})}),e.jsx(s,{children:e.jsx("strong",{children:"Type"})}),e.jsx(s,{children:e.jsx("strong",{children:"Amount"})}),e.jsx(s,{children:e.jsx("strong",{children:"Status"})})]})}),e.jsx(D,{children:C?e.jsx(l,{children:e.jsx(s,{colSpan:8,align:"center",sx:{py:3},children:e.jsx(L,{size:30})})}):u.length>0?u.map((r,a)=>{var h;return e.jsxs(l,{hover:!0,children:[e.jsx(s,{children:a+1}),e.jsxs(s,{children:["#",r._id.slice(-6).toUpperCase()]}),e.jsx(s,{children:new Date(r.bookingDate).toLocaleDateString()}),e.jsx(s,{children:O(r.timeSlot)}),e.jsxs(s,{children:[e.jsx(i,{variant:"body2",fontWeight:600,children:r.fullName}),e.jsx(i,{variant:"caption",color:"textSecondary",children:r.emailAddress})]}),e.jsx(s,{children:e.jsx(g,{label:r.moduleType,size:"small",variant:"outlined"})}),e.jsx(s,{children:e.jsxs(i,{fontWeight:700,color:"success.main",children:["â‚¹",(h=r.finalPrice)==null?void 0:h.toLocaleString()]})}),e.jsx(s,{children:e.jsx(g,{label:r.paymentStatus,size:"small",color:"success"})})]},r._id)}):e.jsx(l,{children:e.jsx(s,{colSpan:8,align:"center",sx:{py:3},children:"No completed bookings found"})})})]})})]})]})};export{F as default};
