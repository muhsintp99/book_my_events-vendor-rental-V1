import{g as L,r as a,j as e,B as n,Y as $,T as v,a as B,Z as P,b as U,a5 as D,M as w,c as M}from"./index-CWJg_lwt.js";import{A as _}from"./ArrowDropDown-wXOiHc8y.js";import{S as F}from"./Search-WfmjaGyn.js";import{T as H,a as I,b as t,c as N}from"./TableRow-BZY7QWVl.js";import{T as z}from"./TableHead-DOO0st10.js";const q=()=>{L();const[l,S]=a.useState(""),[h,E]=a.useState([]),[x,f]=a.useState([]),[m,g]=a.useState(null),[T,A]=a.useState(!0),[u,j]=a.useState(null),d=localStorage.getItem("moduleId"),p="https://api.bookmyevent.ae";a.useEffect(()=>{(async()=>{try{if(!d)throw new Error("Module ID not found in localStorage");const o=await fetch(`${p}/api/categories/modules/${d}`);if(!o.ok)throw new Error(`HTTP error! ${o.status}`);const c=await o.json();if(c.success&&Array.isArray(c.data)){const i=c.data.map(r=>({id:r.categoryId||r._id,name:r.title,image:r.image?`${p}${r.image}`:"",status:r.isActive}));E(i),f(i)}else g("No categories found for this module")}catch(o){console.error(o),g(o.message)}finally{A(!1)}})()},[d]),a.useEffect(()=>{const s=h.filter(o=>o.name.toLowerCase().includes(l.toLowerCase()));f(s)},[l,h]);const k=s=>j(s.currentTarget),b=()=>j(null),C=s=>{let o=`SI,Category Id,Category Name
`;x.forEach((y,R)=>{o+=`${R+1},${y.id},${y.name}
`});const c=new Blob([o],{type:s==="excel"?"application/vnd.ms-excel":"text/csv"}),i=window.URL.createObjectURL(c),r=document.createElement("a");r.href=i,r.download=`emcee_categories.${s}`,r.click(),window.URL.revokeObjectURL(i),b()};return e.jsx(n,{sx:{p:4,bgcolor:"#f8f9fc",minHeight:"100vh"},children:e.jsxs($,{elevation:3,sx:{p:4,borderRadius:4},children:[e.jsxs(n,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:4},children:[e.jsx(v,{variant:"h4",sx:{fontWeight:700,color:"#dd666eff"},children:"Emcee Category List"}),e.jsxs(n,{sx:{display:"flex",gap:2},children:[e.jsx(B,{size:"small",placeholder:"Search categories...",value:l,onChange:s=>S(s.target.value),InputProps:{startAdornment:e.jsx(P,{position:"start",children:e.jsx(F,{})})}}),e.jsx(U,{variant:"contained",endIcon:e.jsx(_,{}),onClick:k,sx:{bgcolor:"#dd666eff","&:hover":{bgcolor:"#ad2430ff"}},children:"Export"}),e.jsxs(D,{anchorEl:u,open:!!u,onClose:b,children:[e.jsx(w,{onClick:()=>C("excel"),children:"Excel"}),e.jsx(w,{onClick:()=>C("csv"),children:"CSV"})]})]})]}),T?e.jsx(n,{sx:{textAlign:"center",py:5},children:e.jsx(M,{})}):m?e.jsx(v,{color:"error",children:m}):e.jsxs(H,{children:[e.jsx(z,{children:e.jsxs(I,{sx:{bgcolor:"#fce9ea"},children:[e.jsx(t,{children:"SI"}),e.jsx(t,{children:"Image"}),e.jsx(t,{children:"Category Name"}),e.jsx(t,{children:"Category ID"}),e.jsx(t,{children:"Status"})]})}),e.jsx(N,{children:x.map((s,o)=>e.jsxs(I,{hover:!0,sx:{"&:hover":{bgcolor:"#fff5f6"}},children:[e.jsx(t,{children:o+1}),e.jsx(t,{children:e.jsx(n,{component:"img",src:s.image,alt:s.name,sx:{width:80,height:60,objectFit:"cover",borderRadius:2}})}),e.jsx(t,{sx:{fontWeight:600},children:s.name}),e.jsx(t,{children:s.id}),e.jsx(t,{children:e.jsx(n,{sx:{px:2,py:.5,borderRadius:3,display:"inline-block",fontSize:12,bgcolor:s.status?"#e6f4ea":"#fdecea",color:s.status?"#2e7d32":"#d32f2f"},children:s.status?"Active":"Inactive"})})]},s.id))})]})]})})};export{q as default};
