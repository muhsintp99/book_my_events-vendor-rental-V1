import{d as K,r,j as e,B as o,U as Q,s as v,T as a,b as l,C as A,q as W,a as Z,Z as X,c as ee,G as u,V as se,o as P,a1 as te,z as ae,v as re,H as R,a4 as _,J as L,a2 as ie,K as z,N as ne}from"./index-DF1Xuk6o.js";import{A as oe}from"./Add-D7XIlWA7.js";import{S as ce}from"./Search-CB68Tsz3.js";import{S as F}from"./Security-CvY_2Sai.js";import{C as le}from"./CardMedia-B4yJMRuy.js";import{C as de}from"./Close-CWkVHLel.js";const D="https://api.bookmyevent.ae/api/mehandi";function je(){const p=K(),[g,b]=r.useState([]),[V,C]=r.useState(!0),[m,c]=r.useState({open:!1,message:"",severity:"success"}),[j,H]=r.useState(""),[O,f]=r.useState(!1),[M,y]=r.useState(!1),[t,U]=r.useState(null),[B,N]=r.useState(null),d=localStorage.getItem("token"),k=JSON.parse(localStorage.getItem("user")||"{}"),w=k==null?void 0:k._id,T=s=>s?`https://api.bookmyevent.ae/${s.startsWith("/")?s.slice(1):s}`:null,S=s=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",maximumFractionDigits:0}).format(s||0),$=r.useCallback(async()=>{if(!w||!d){c({open:!0,message:"Please login again",severity:"error"}),C(!1);return}C(!0);try{const s=await fetch(`${D}/vendor/${w}`,{headers:{Authorization:`Bearer ${d}`,"Content-Type":"application/json"}});if(!s.ok)throw new Error("Failed to load packages");const i=await s.json();i.success&&b(i.data||[])}catch(s){c({open:!0,message:s.message,severity:"error"})}finally{C(!1)}},[w,d]);r.useEffect(()=>{$()},[$]);const Y=s=>{U(s),f(!0)},q=async(s,i)=>{try{(await(await fetch(`${D}/${s}/toggle-active`,{method:"PATCH",headers:{Authorization:`Bearer ${d}`}})).json()).success&&(b(J=>J.map(I=>I._id===s?{...I,isActive:!i}:I)),c({open:!0,message:"Status updated",severity:"success"}))}catch{c({open:!0,message:"Failed to update status",severity:"error"})}},G=async()=>{try{(await(await fetch(`${D}/${B}`,{method:"DELETE",headers:{Authorization:`Bearer ${d}`}})).json()).success&&(b(x=>x.filter(h=>h._id!==B)),c({open:!0,message:"Package deleted",severity:"success"}))}catch{c({open:!0,message:"Delete failed",severity:"error"})}finally{y(!1),N(null)}},E=r.useMemo(()=>g.filter(s=>{var x,h;if(!j)return!0;const i=j.toLowerCase();return((x=s.packageName)==null?void 0:x.toLowerCase().includes(i))||((h=s.description)==null?void 0:h.toLowerCase().includes(i))}),[g,j]),n="#0f172a";return e.jsxs(o,{sx:{bgcolor:"#f5f7fa",minHeight:"100vh",pb:4},children:[e.jsx(o,{sx:{background:`linear-gradient(135deg, ${n} 0%, #1e293b 100%)`,color:"white",py:4,px:3,borderRadius:"0 0 24px 24px",boxShadow:"0 4px 20px rgba(15, 23, 42, 0.3)"},children:e.jsx(Q,{maxWidth:"xl",children:e.jsxs(v,{direction:"row",justifyContent:"space-between",alignItems:"center",children:[e.jsxs(o,{children:[e.jsx(a,{variant:"h4",sx:{fontWeight:700,mb:.5},children:"Bouncers & Security Packages"}),e.jsxs(a,{variant:"body2",sx:{opacity:.9},children:[g.length," total packages â€¢ ",g.filter(s=>s.isActive).length," active"]})]}),e.jsx(l,{variant:"contained",size:"large",startIcon:e.jsx(oe,{}),onClick:()=>p("/bouncers/addpackage"),sx:{bgcolor:"white",color:n,fontWeight:600,px:3,"&:hover":{bgcolor:"#f5f5f5",transform:"translateY(-2px)"},transition:"all 0.3s",boxShadow:"0 4px 12px rgba(0,0,0,0.15)"},children:"Add New Package"})]})})}),e.jsxs(o,{sx:{width:"100%",px:2,mt:4},children:[e.jsx(A,{sx:{mb:3,borderRadius:3,boxShadow:"0 2px 12px rgba(0,0,0,0.08)"},children:e.jsx(W,{children:e.jsx(Z,{fullWidth:!0,placeholder:"Search by package name or description...",value:j,onChange:s=>H(s.target.value),InputProps:{startAdornment:e.jsx(X,{position:"start",children:e.jsx(ce,{sx:{color:n,fontSize:28}})}),sx:{borderRadius:2}}})})}),V?e.jsx(o,{sx:{display:"flex",justifyContent:"center",py:8},children:e.jsx(ee,{size:60,sx:{color:n}})}):E.length===0?e.jsxs(A,{sx:{textAlign:"center",py:8},children:[e.jsx(F,{sx:{fontSize:80,color:"#ddd",mb:2}}),e.jsx(a,{variant:"h5",color:"text.secondary",children:"No packages found"}),e.jsx(l,{variant:"contained",sx:{mt:3,bgcolor:n},onClick:()=>p("/bouncers/addpackage"),children:"Create Your First Package"})]}):e.jsx(u,{container:!0,spacing:3,children:E.map(s=>e.jsx(u,{item:!0,xs:12,sm:6,md:4,lg:3,children:e.jsxs(A,{sx:{height:"100%",borderRadius:3,transition:"0.3s","&:hover":{transform:"translateY(-8px)"}},children:[e.jsx(o,{sx:{position:"relative",pt:"75%",bgcolor:"#f5f5f5"},children:s.image?e.jsx(le,{component:"img",image:T(s.image),alt:s.packageName,sx:{position:"absolute",top:0,width:"100%",height:"100%",objectFit:"cover"}}):e.jsx(o,{sx:{position:"absolute",top:0,width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(F,{sx:{fontSize:60,color:"#ccc"}})})}),e.jsxs(W,{sx:{p:2.5},children:[e.jsx(a,{variant:"h6",sx:{fontWeight:700,mb:1},noWrap:!0,children:s.packageName}),e.jsx(a,{variant:"h5",sx:{fontWeight:700,color:n,mb:2},children:S(s.packagePrice)}),e.jsxs(v,{direction:"row",spacing:1,children:[e.jsx(l,{fullWidth:!0,variant:"outlined",startIcon:e.jsx(se,{}),onClick:()=>Y(s),children:"View"}),e.jsx(P,{color:"primary",onClick:()=>p(`/bouncers/edit/${s._id}`),children:e.jsx(te,{})}),e.jsx(P,{color:"error",onClick:()=>{N(s._id),y(!0)},children:e.jsx(ae,{})})]}),e.jsxs(o,{sx:{mt:2,pt:2,borderTop:"1px solid #f0f0f0",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx(a,{variant:"body2",fontWeight:500,children:"Status"}),e.jsx(re,{checked:s.isActive,onChange:()=>q(s._id,s.isActive)})]})]})]})},s._id))})]}),e.jsxs(R,{open:O,onClose:()=>f(!1),maxWidth:"md",fullWidth:!0,children:[e.jsx(_,{sx:{bgcolor:n,color:"white"},children:e.jsxs(v,{direction:"row",justifyContent:"space-between",alignItems:"center",children:[e.jsx(a,{variant:"h6",children:t==null?void 0:t.packageName}),e.jsx(P,{onClick:()=>f(!1),sx:{color:"white"},children:e.jsx(de,{})})]})}),e.jsx(L,{dividers:!0,children:t&&e.jsxs(u,{container:!0,spacing:3,children:[e.jsx(u,{item:!0,xs:12,md:5,children:t.image&&e.jsx("img",{src:T(t.image),alt:t.packageName,style:{width:"100%",borderRadius:"12px"}})}),e.jsxs(u,{item:!0,xs:12,md:7,children:[e.jsx(a,{variant:"h6",gutterBottom:!0,children:"Description"}),e.jsx(a,{variant:"body1",color:"text.secondary",paragraph:!0,children:t.description}),e.jsx(ie,{sx:{my:2}}),e.jsxs(v,{spacing:1,children:[e.jsx(a,{variant:"h6",children:"Pricing"}),e.jsxs(a,{variant:"body1",children:["Full Price: ",e.jsx("b",{children:S(t.packagePrice)})]}),e.jsxs(a,{variant:"body1",children:["Advance: ",e.jsx("b",{children:S(t.advanceBookingAmount)})]})]})]})]})}),e.jsxs(z,{sx:{p:2},children:[e.jsx(l,{onClick:()=>f(!1),children:"Close"}),e.jsx(l,{variant:"contained",sx:{bgcolor:n},onClick:()=>p(`/bouncers/edit/${t==null?void 0:t._id}`),children:"Edit Package"})]})]}),e.jsxs(R,{open:M,onClose:()=>y(!1),children:[e.jsx(_,{children:"Delete Package?"}),e.jsx(L,{children:"This action cannot be undone."}),e.jsxs(z,{children:[e.jsx(l,{onClick:()=>y(!1),children:"Cancel"}),e.jsx(l,{color:"error",variant:"contained",onClick:G,children:"Delete"})]})]}),e.jsx(ne,{open:m.open,autoHideDuration:6e3,onClose:()=>c({...m,open:!1}),children:e.jsx(a,{sx:{bgcolor:m.severity==="success"?"success.main":"error.main",color:"white",p:2,borderRadius:1},children:m.message})})]})}export{je as default};
