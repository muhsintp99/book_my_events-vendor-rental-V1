import{r as i,g as he,j as e,B as r,v as pe,o as me,N as ge,T as k,q as m,f as g,a7 as fe,b as f,a8 as K,D as je,s as be}from"./index-DWEeEeRK.js";import{T as Q,a as j}from"./Tabs-BgeCw1WK.js";import{C as ve}from"./CloudUpload-DlplZ8Cb.js";import{C as ye,V as X}from"./VideoLibrary-Cy6P6H8v.js";import{T as Ce}from"./TableContainer-BmndTrzm.js";import{T as Te,a as Se,b as Z,c as o,d as we}from"./TableRow-DGcu9Us0.js";import{D as ke}from"./Delete-CaFVfS7v.js";import{C as M}from"./Close-CAFDxGLP.js";const x="https://api.bookmyevent.ae",b=he.create({baseURL:x}),I="#e53935";function Ae(){const v=JSON.parse(localStorage.getItem("user")||"{}"),n=v==null?void 0:v._id,u=localStorage.getItem("moduleId"),[L,ee]=i.useState(!1),[te,P]=i.useState(!1),[h,se]=i.useState(0),[y,R]=i.useState(""),[W,$]=i.useState(""),[U,V]=i.useState(""),[p,A]=i.useState(null),[D,E]=i.useState([]),[ie,F]=i.useState([]),[C,B]=i.useState(""),[d,ae]=i.useState(0),[O,re]=i.useState([]),[oe,T]=i.useState(!1),[_,le]=i.useState([]),[G,q]=i.useState(0),[ne,S]=i.useState(!1),[c,de]=i.useState("");i.useEffect(()=>{!n||!u||b.get(`/api/subscription/status/${n}?moduleId=${u}`).then(t=>{var a;const s=(a=t.data)==null?void 0:a.subscription;ee((s==null?void 0:s.status)==="active"&&(s==null?void 0:s.isCurrent))})},[n,u]);const w=async()=>{const t=await b.get(`/api/portfolio/provider/${n}`);re(t.data.data||[])};i.useEffect(()=>{w()},[]);const ce=async()=>{if(!L)return alert("Upgrade plan required");if(!y.trim())return alert("Title required");const t=new FormData;if(t.append("providerId",n),t.append("module",u),t.append("workTitle",y),t.append("description",W),t.append("tags",U),h===0){if(!p)return alert("Thumbnail required");t.append("thumbnail",p),D.forEach(s=>t.append("images",s))}else ie.forEach(s=>t.append("videos",s)),C&&t.append("videoLinks",JSON.stringify([C]));P(!0),await b.post("/api/portfolio",t),P(!1),R(""),$(""),V(""),A(null),E([]),F([]),B(""),w()},xe=async t=>{window.confirm("Delete portfolio?")&&(await b.delete(`/api/portfolio/${t}`),w())},ue=d===0?O.filter(t=>{var s;return(s=t.media)==null?void 0:s.some(a=>a.type==="image")}):O.filter(t=>{var s;return(s=t.media)==null?void 0:s.some(a=>a.type==="video"||a.type==="videoLink")});return e.jsxs(r,{sx:{p:3,maxWidth:1800,mx:"auto"},children:[!L&&e.jsx(pe,{severity:"warning",sx:{mb:3},children:"Upgrade to premium to add portfolio works"}),e.jsx(me,{sx:{mb:5,borderRadius:3,width:"100%"},children:e.jsxs(ge,{children:[e.jsx(k,{variant:"h5",fontWeight:700,mb:2,children:"Add Portfolio Work"}),e.jsxs(Q,{value:h,onChange:(t,s)=>se(s),sx:{mb:3},children:[e.jsx(j,{label:"Images"}),e.jsx(j,{label:"Videos"})]}),e.jsx(m,{fullWidth:!0,label:"Title",value:y,onChange:t=>R(t.target.value),sx:{mb:3}}),e.jsx(m,{fullWidth:!0,multiline:!0,rows:3,label:"Description",value:W,onChange:t=>$(t.target.value),sx:{mb:3}}),e.jsx(m,{fullWidth:!0,label:"Tags (comma separated)",value:U,onChange:t=>V(t.target.value),sx:{mb:4}}),h===0&&e.jsxs(e.Fragment,{children:[e.jsxs(g,{component:"label",variant:"contained",sx:{bgcolor:I,mb:2},children:[e.jsx(ve,{sx:{mr:1}})," Upload Thumbnail",e.jsx("input",{hidden:!0,type:"file",accept:"image/*",onChange:t=>A(t.target.files[0])})]}),p&&e.jsx(r,{sx:{mb:3},children:e.jsx("img",{src:URL.createObjectURL(p),style:{width:180,height:180,objectFit:"cover",borderRadius:12}})}),e.jsxs(g,{component:"label",variant:"outlined",sx:{mb:2},children:[e.jsx(ye,{sx:{mr:1}})," Upload Gallery Images",e.jsx("input",{hidden:!0,multiple:!0,type:"file",accept:"image/*",onChange:t=>E([...t.target.files])})]}),e.jsx(r,{sx:{display:"flex",gap:2,flexWrap:"wrap",mb:4},children:D.map((t,s)=>e.jsx("img",{src:URL.createObjectURL(t),style:{width:100,height:100,borderRadius:10}},s))})]}),h===1&&e.jsxs(e.Fragment,{children:[e.jsxs(g,{component:"label",variant:"contained",sx:{bgcolor:I,mb:2},children:[e.jsx(X,{sx:{mr:1}})," Upload Videos",e.jsx("input",{hidden:!0,multiple:!0,type:"file",accept:"video/*",onChange:t=>F([...t.target.files])})]}),e.jsx(m,{fullWidth:!0,label:"Video Link (YouTube / Vimeo)",value:C,onChange:t=>B(t.target.value),sx:{mb:3}})]}),e.jsx(g,{fullWidth:!0,variant:"contained",sx:{bgcolor:I,py:1.4},onClick:ce,children:"Add Portfolio"})]})}),e.jsxs(Q,{value:d,onChange:(t,s)=>ae(s),sx:{mb:2},children:[e.jsx(j,{label:"Images"}),e.jsx(j,{label:"Videos"})]}),e.jsx(Ce,{component:fe,sx:{borderRadius:3,width:"100%"},children:e.jsxs(Te,{children:[e.jsx(Se,{sx:{bgcolor:"#fdeaea"},children:e.jsxs(Z,{children:[e.jsx(o,{children:"Work"}),e.jsx(o,{children:"Preview"}),e.jsx(o,{align:"center",children:"Count"}),e.jsx(o,{align:"right",children:"Action"})]})}),e.jsx(we,{children:ue.map(t=>{var N,H,J;const s=t.media.find(l=>l.type==="image"),a=t.media.find(l=>l.type==="video"||l.type==="videoLink");return e.jsxs(Z,{hover:!0,children:[e.jsxs(o,{children:[e.jsx(k,{fontWeight:600,children:t.workTitle}),e.jsx(k,{variant:"caption",children:t.description})]}),e.jsxs(o,{children:[d===0&&s&&e.jsx("img",{src:`${x}/${s.thumbnail}`,style:{width:70,height:70,borderRadius:10,cursor:"pointer"},onClick:()=>{le(s.gallery||[]),q(0),T(!0)}}),d===1&&a&&e.jsx(f,{color:"primary",onClick:()=>{var Y,z;const l=(Y=a.videos)!=null&&Y[0]?`${x}/${a.videos[0]}`:(z=a.videoLinks)==null?void 0:z[0];de(l),S(!0)},children:e.jsx(X,{})})]}),e.jsx(o,{align:"center",children:d===0?((N=s==null?void 0:s.gallery)==null?void 0:N.length)||0:(((H=a==null?void 0:a.videos)==null?void 0:H.length)||0)+(((J=a==null?void 0:a.videoLinks)==null?void 0:J.length)||0)}),e.jsx(o,{align:"right",children:e.jsx(f,{color:"error",onClick:()=>xe(t._id),children:e.jsx(ke,{})})})]},t._id)})})]})}),e.jsx(K,{open:oe,onClose:()=>T(!1),fullScreen:!0,children:e.jsxs(r,{sx:{bgcolor:"#000",height:"100vh",p:2},children:[e.jsx(f,{onClick:()=>T(!1),sx:{color:"#fff"},children:e.jsx(M,{})}),e.jsx(r,{sx:{textAlign:"center",mt:2},children:e.jsx("img",{src:`${x}/${_[G]}`,style:{maxHeight:"70vh",maxWidth:"100%"}})}),e.jsx(je,{sx:{my:2,bgcolor:"#333"}}),e.jsx(r,{sx:{display:"flex",justifyContent:"center",gap:1},children:_.map((t,s)=>e.jsx("img",{src:`${x}/${t}`,onClick:()=>q(s),style:{width:60,height:60,border:G===s?"2px solid #fff":"1px solid #444",cursor:"pointer"}},s))})]})}),e.jsx(K,{open:ne,onClose:()=>S(!1),fullScreen:!0,children:e.jsxs(r,{sx:{bgcolor:"#000",height:"100vh",p:2},children:[e.jsx(f,{onClick:()=>S(!1),sx:{color:"#fff"},children:e.jsx(M,{})}),e.jsx(r,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:"80%"},children:c!=null&&c.includes("http")?e.jsx("iframe",{src:c,width:"80%",height:"80%",frameBorder:"0",allowFullScreen:!0}):e.jsx("video",{src:c,controls:!0,style:{maxWidth:"80%"}})})]})}),te&&e.jsx(be,{})]})}export{Ae as default};
